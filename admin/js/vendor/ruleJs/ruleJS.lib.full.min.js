(function(){var r,n=[],t=[],e=0,a=+new Date+"",u=75,o=40,i=" \t\v\f \ufeff\n\r\u2028\u2029 ᠎             　",l=/\b__p \+= '';/g,f=/\b(__p \+=) '' \+/g,s=/(__e\(.*?\)|\b__t\)) \+\n'';/g,c=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,m=/\w*$/,h=/^\s*function[ \n\r\t]+\w/,p=/<%=([\s\S]+?)%>/g,d=RegExp("^["+i+"]*0+(?=.$)"),g=/($^)/,v=/\bthis\b/,M=/['\n\r\t\u2028\u2029\\]/g,F=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],N=0,y="[object Arguments]",E="[object Array]",_="[object Boolean]",b="[object Date]",A="[object Function]",I="[object Number]",w="[object Object]",S="[object RegExp]",T="[object String]",D={};D[A]=!1,D[y]=D[E]=D[_]=D[b]=D[I]=D[w]=D[S]=D[T]=!0;var U={leading:!1,maxWait:0,trailing:!1},O={configurable:!1,enumerable:!1,value:null,writable:!1},L={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},C={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=L[typeof window]&&window||this,x=L[typeof exports]&&exports&&!exports.nodeType&&exports,Y=L[typeof module]&&module&&!module.nodeType&&module,k=Y&&Y.exports===x&&x,j=L[typeof global]&&global;function P(r,n,t){for(var e=(t||0)-1,a=r?r.length:0;++e<a;)if(r[e]===n)return e;return-1}function V(r,n){var t=typeof n;if(r=r.cache,"boolean"==t||null==n)return r[n]?0:-1;"number"!=t&&"string"!=t&&(t="object");var e="number"==t?n:a+n;return r=(r=r[t])&&r[e],"object"==t?r&&P(r,n)>-1?0:-1:r?0:-1}function G(r){var n=this.cache,t=typeof r;if("boolean"==t||null==r)n[r]=!0;else{"number"!=t&&"string"!=t&&(t="object");var e="number"==t?r:a+r,u=n[t]||(n[t]={});"object"==t?(u[e]||(u[e]=[])).push(r):u[e]=!0}}function q(r){return r.charCodeAt(0)}function B(r,n){for(var t=r.criteria,e=n.criteria,a=-1,u=t.length;++a<u;){var o=t[a],i=e[a];if(o!==i){if(o>i||void 0===o)return 1;if(o<i||void 0===i)return-1}}return r.index-n.index}function X(r){var n=-1,t=r.length,e=r[0],a=r[t/2|0],u=r[t-1];if(e&&"object"==typeof e&&a&&"object"==typeof a&&u&&"object"==typeof u)return!1;var o=z();o.false=o.null=o.true=o[void 0]=!1;var i=z();for(i.array=r,i.cache=o,i.push=G;++n<t;)i.push(r[n]);return i}function W(r){return"\\"+C[r]}function H(){return n.pop()||[]}function z(){return t.pop()||{array:null,cache:null,criteria:null,false:!1,index:0,null:!1,number:null,object:null,push:null,string:null,true:!1,undefined:!1,value:null}}function $(r){r.length=0,n.length<o&&n.push(r)}function Z(r){var n=r.cache;n&&Z(n),r.array=r.cache=r.criteria=r.object=r.number=r.string=r.value=null,t.length<o&&t.push(r)}function K(r,n,t){n||(n=0),void 0===t&&(t=r?r.length:0);for(var e=-1,a=t-n||0,u=Array(a<0?0:a);++e<a;)u[e]=r[n+e];return u}!j||j.global!==j&&j.window!==j||(R=j);var Q=function n(t){var o=(t=t?Q.defaults(R.Object(),t,Q.pick(R,F)):R).Array,C=t.Boolean,x=t.Date,Y=t.Function,k=t.Math,j=t.Number,G=t.Object,J=t.RegExp,rr=t.String,nr=t.TypeError,tr=[],er=G.prototype,ar=t._,ur=er.toString,or=J("^"+rr(ur).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),ir=k.ceil,lr=t.clearTimeout,fr=k.floor,sr=Y.prototype.toString,cr=Wr(cr=G.getPrototypeOf)&&cr,mr=er.hasOwnProperty,hr=tr.push,pr=t.setTimeout,dr=tr.splice,gr=tr.unshift,vr=function(){try{var r={},n=Wr(n=G.defineProperty)&&n,t=n(r,r,r)&&n}catch(r){}return t}(),Mr=Wr(Mr=G.create)&&Mr,Fr=Wr(Fr=o.isArray)&&Fr,Nr=t.isFinite,yr=t.isNaN,Er=Wr(Er=G.keys)&&Er,_r=k.max,br=k.min,Ar=t.parseInt,Ir=k.random,wr={};function Sr(r){return r&&"object"==typeof r&&!Kr(r)&&mr.call(r,"__wrapped__")?r:new Tr(r)}function Tr(r,n){this.__chain__=!!n,this.__wrapped__=r}wr[E]=o,wr[_]=C,wr[b]=x,wr[A]=Y,wr[w]=G,wr[I]=j,wr[S]=J,wr[T]=rr,Tr.prototype=Sr.prototype;var Dr=Sr.support={};function Ur(r){var n=r[0],t=r[2],e=r[4];function a(){if(t){var r=K(t);hr.apply(r,arguments)}if(this instanceof a){var u=Lr(n.prototype),o=n.apply(u,r||arguments);return mn(o)?o:u}return n.apply(e,r||arguments)}return Hr(a,r),a}function Or(r,n,t,e,a){if(t){var u=t(r);if(void 0!==u)return u}if(!mn(r))return r;var o=ur.call(r);if(!D[o])return r;var i=wr[o];switch(o){case _:case b:return new i(+r);case I:case T:return new i(r);case S:return(u=i(r.source,m.exec(r))).lastIndex=r.lastIndex,u}var l=Kr(r);if(n){var f=!e;e||(e=H()),a||(a=H());for(var s=e.length;s--;)if(e[s]==r)return a[s];u=l?i(r.length):{}}else u=l?K(r):en({},r);return l&&(mr.call(r,"index")&&(u.index=r.index),mr.call(r,"input")&&(u.input=r.input)),n?(e.push(r),a.push(u),(l?En:on)(r,function(r,o){u[o]=Or(r,n,t,e,a)}),f&&($(e),$(a)),u):u}function Lr(r,n){return mn(r)?Mr(r):{}}function Cr(r,n,t){if("function"!=typeof r)return qn;if(void 0===n||!("prototype"in r))return r;var e=r.__bindData__;if(void 0===e&&(Dr.funcNames&&(e=!r.name),!(e=e||!Dr.funcDecomp))){var a=sr.call(r);Dr.funcNames||(e=!h.test(a)),e||(e=v.test(a),Hr(r,e))}if(!1===e||!0!==e&&1&e[1])return r;switch(t){case 1:return function(t){return r.call(n,t)};case 2:return function(t,e){return r.call(n,t,e)};case 3:return function(t,e,a){return r.call(n,t,e,a)};case 4:return function(t,e,a,u){return r.call(n,t,e,a,u)}}return Vn(r,n)}function Rr(r){var n=r[0],t=r[1],e=r[2],a=r[3],u=r[4],o=r[5],i=1&t,l=2&t,f=4&t,s=8&t,c=n;function m(){var r=i?u:this;if(e){var h=K(e);hr.apply(h,arguments)}if((a||f)&&(h||(h=K(arguments)),a&&hr.apply(h,a),f&&h.length<o))return t|=16,Rr([n,s?t:-4&t,h,null,u,o]);if(h||(h=arguments),l&&(n=r[c]),this instanceof m){r=Lr(n.prototype);var p=n.apply(r,h);return mn(p)?p:r}return n.apply(r,h)}return Hr(m,r),m}function xr(r,n){var t=-1,e=Xr(),a=r?r.length:0,o=a>=u&&e===P,i=[];if(o){var l=X(n);l?(e=V,n=l):o=!1}for(;++t<a;){var f=r[t];e(n,f)<0&&i.push(f)}return o&&Z(n),i}function Yr(r,n,t,e){for(var a=(e||0)-1,u=r?r.length:0,o=[];++a<u;){var i=r[a];if(i&&"object"==typeof i&&"number"==typeof i.length&&(Kr(i)||Zr(i))){n||(i=Yr(i,n,t));var l=-1,f=i.length,s=o.length;for(o.length+=f;++l<f;)o[s++]=i[l]}else t||o.push(i)}return o}function kr(r,n,t,e,a,u){if(t){var o=t(r,n);if(void 0!==o)return!!o}if(r===n)return 0!==r||1/r==1/n;var i=typeof n;if(!(r!=r||r&&L[typeof r]||n&&L[i]))return!1;if(null==r||null==n)return r===n;var l=ur.call(r),f=ur.call(n);if(l==y&&(l=w),f==y&&(f=w),l!=f)return!1;switch(l){case _:case b:return+r==+n;case I:return r!=+r?n!=+n:0==r?1/r==1/n:r==+n;case S:case T:return r==rr(n)}var s=l==E;if(!s){var c=mr.call(r,"__wrapped__"),m=mr.call(n,"__wrapped__");if(c||m)return kr(c?r.__wrapped__:r,m?n.__wrapped__:n,t,e,a,u);if(l!=w)return!1;var h=r.constructor,p=n.constructor;if(h!=p&&!(cn(h)&&h instanceof h&&cn(p)&&p instanceof p)&&"constructor"in r&&"constructor"in n)return!1}var d=!a;a||(a=H()),u||(u=H());for(var g=a.length;g--;)if(a[g]==r)return u[g]==n;var v=0;if(o=!0,a.push(r),u.push(n),s){if(g=r.length,v=n.length,(o=v==g)||e)for(;v--;){var M=g,F=n[v];if(e)for(;M--&&!(o=kr(r[M],F,t,e,a,u)););else if(!(o=kr(r[v],F,t,e,a,u)))break}}else un(n,function(n,i,l){if(mr.call(l,i))return v++,o=mr.call(r,i)&&kr(r[i],n,t,e,a,u)}),o&&!e&&un(r,function(r,n,t){if(mr.call(t,n))return o=--v>-1});return a.pop(),u.pop(),d&&($(a),$(u)),o}function jr(r,n,t,e,a){(Kr(n)?En:on)(n,function(n,u){var o,i,l=n,f=r[u];if(n&&((i=Kr(n))||pn(n))){for(var s,c=e.length;c--;)if(o=e[c]==n){f=a[c];break}o||(t&&(s=void 0!==(l=t(f,n)))&&(f=l),s||(f=i?Kr(f)?f:[]:pn(f)?f:{}),e.push(n),a.push(f),s||jr(f,n,t,e,a))}else t&&void 0===(l=t(f,n))&&(l=n),void 0!==l&&(f=l);r[u]=f})}function Pr(r,n){return r+fr(Ir()*(n-r+1))}function Vr(r,n,t){var e=-1,a=Xr(),o=r?r.length:0,i=[],l=!n&&o>=u&&a===P,f=t||l?H():i;for(l&&(a=V,f=X(f));++e<o;){var s=r[e],c=t?t(s,e,r):s;(n?!e||f[f.length-1]!==c:a(f,c)<0)&&((t||l)&&f.push(c),i.push(s))}return l?($(f.array),Z(f)):t&&$(f),i}function Gr(r){return function(n,t,e){var a={};t=Sr.createCallback(t,e,3);var u=-1,o=n?n.length:0;if("number"==typeof o)for(;++u<o;){var i=n[u];r(a,i,t(i,u,n),n)}else on(n,function(n,e,u){r(a,n,t(n,e,u),u)});return a}}function qr(r,n,t,e,a,u){var o=1&n,i=4&n,l=16&n,f=32&n;if(!(2&n||cn(r)))throw new nr;l&&!t.length&&(n&=-17,l=t=!1),f&&!e.length&&(n&=-33,f=e=!1);var s=r&&r.__bindData__;return s&&!0!==s?((s=K(s))[2]&&(s[2]=K(s[2])),s[3]&&(s[3]=K(s[3])),!o||1&s[1]||(s[4]=a),!o&&1&s[1]&&(n|=8),!i||4&s[1]||(s[5]=u),l&&hr.apply(s[2]||(s[2]=[]),t),f&&gr.apply(s[3]||(s[3]=[]),e),s[1]|=n,qr.apply(null,s)):(1==n||17===n?Ur:Rr)([r,n,t,e,a,u])}function Br(r){return Jr[r]}function Xr(){var r=(r=Sr.indexOf)===Rn?P:r;return r}function Wr(r){return"function"==typeof r&&or.test(r)}Dr.funcDecomp=!Wr(t.WinRTError)&&v.test(n),Dr.funcNames="string"==typeof Y.name,Sr.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:p,variable:"",imports:{_:Sr}},Mr||(Lr=function(){function r(){}return function(n){if(mn(n)){r.prototype=n;var e=new r;r.prototype=null}return e||t.Object()}}());var Hr=vr?function(r,n){O.value=n,vr(r,"__bindData__",O)}:Xn;function zr(r){var n,t;return!(!r||ur.call(r)!=w||cn(n=r.constructor)&&!(n instanceof n))&&(un(r,function(r,n){t=n}),void 0===t||mr.call(r,t))}function $r(r){return rn[r]}function Zr(r){return r&&"object"==typeof r&&"number"==typeof r.length&&ur.call(r)==y||!1}var Kr=Fr||function(r){return r&&"object"==typeof r&&"number"==typeof r.length&&ur.call(r)==E||!1},Qr=Er?function(r){return mn(r)?Er(r):[]}:function(r){var n,t=r,e=[];if(!t)return e;if(!L[typeof r])return e;for(n in t)mr.call(t,n)&&e.push(n);return e},Jr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rn=sn(Jr),nn=J("("+Qr(rn).join("|")+")","g"),tn=J("["+Qr(Jr).join("")+"]","g"),en=function(r,n,t){var e,a=r,u=a;if(!a)return u;var o=arguments,i=0,l="number"==typeof t?2:o.length;if(l>3&&"function"==typeof o[l-2])var f=Cr(o[--l-1],o[l--],2);else l>2&&"function"==typeof o[l-1]&&(f=o[--l]);for(;++i<l;)if((a=o[i])&&L[typeof a])for(var s=-1,c=L[typeof a]&&Qr(a),m=c?c.length:0;++s<m;)u[e=c[s]]=f?f(u[e],a[e]):a[e];return u};var an=function(r,n,t){var e,a=r,u=a;if(!a)return u;for(var o=arguments,i=0,l="number"==typeof t?2:o.length;++i<l;)if((a=o[i])&&L[typeof a])for(var f=-1,s=L[typeof a]&&Qr(a),c=s?s.length:0;++f<c;)void 0===u[e=s[f]]&&(u[e]=a[e]);return u};var un=function(r,n,t){var e,a=r,u=a;if(!a)return u;if(!L[typeof a])return u;n=n&&void 0===t?n:Cr(n,t,3);for(e in a)if(!1===n(a[e],e,r))return u;return u};var on=function(r,n,t){var e,a=r,u=a;if(!a)return u;if(!L[typeof a])return u;n=n&&void 0===t?n:Cr(n,t,3);for(var o=-1,i=L[typeof a]&&Qr(a),l=i?i.length:0;++o<l;)if(!1===n(a[e=i[o]],e,r))return u;return u};function ln(r,n,t){var e=Qr(r),a=e.length;for(n=Cr(n,t,3);a--;){var u=e[a];if(!1===n(r[u],u,r))break}return r}function fn(r){var n=[];return un(r,function(r,t){cn(r)&&n.push(t)}),n.sort()}function sn(r){for(var n=-1,t=Qr(r),e=t.length,a={};++n<e;){var u=t[n];a[r[u]]=u}return a}function cn(r){return"function"==typeof r}function mn(r){return!(!r||!L[typeof r])}function hn(r){return"number"==typeof r||r&&"object"==typeof r&&ur.call(r)==I||!1}var pn=cr?function(r){if(!r||ur.call(r)!=w)return!1;var n=r.valueOf,t=Wr(n)&&(t=cr(n))&&cr(t);return t?r==t||cr(r)==t:zr(r)}:zr;function dn(r){return"string"==typeof r||r&&"object"==typeof r&&ur.call(r)==T||!1}function gn(r){for(var n=-1,t=Qr(r),e=t.length,a=o(e);++n<e;)a[n]=r[t[n]];return a}function vn(r,n,t){var e=-1,a=Xr(),u=r?r.length:0,o=!1;return t=(t<0?_r(0,u+t):t)||0,Kr(r)?o=a(r,n,t)>-1:"number"==typeof u?o=(dn(r)?r.indexOf(n,t):a(r,n,t))>-1:on(r,function(r){if(++e>=t)return!(o=r===n)}),o}var Mn=Gr(function(r,n,t){mr.call(r,t)?r[t]++:r[t]=1});function Fn(r,n,t){var e=!0;n=Sr.createCallback(n,t,3);var a=-1,u=r?r.length:0;if("number"==typeof u)for(;++a<u&&(e=!!n(r[a],a,r)););else on(r,function(r,t,a){return e=!!n(r,t,a)});return e}function Nn(r,n,t){var e=[];n=Sr.createCallback(n,t,3);var a=-1,u=r?r.length:0;if("number"==typeof u)for(;++a<u;){var o=r[a];n(o,a,r)&&e.push(o)}else on(r,function(r,t,a){n(r,t,a)&&e.push(r)});return e}function yn(r,n,t){n=Sr.createCallback(n,t,3);var e,a=-1,u=r?r.length:0;if("number"!=typeof u)return on(r,function(r,t,a){if(n(r,t,a))return e=r,!1}),e;for(;++a<u;){var o=r[a];if(n(o,a,r))return o}}function En(r,n,t){var e=-1,a=r?r.length:0;if(n=n&&void 0===t?n:Cr(n,t,3),"number"==typeof a)for(;++e<a&&!1!==n(r[e],e,r););else on(r,n);return r}function _n(r,n,t){var e=r?r.length:0;if(n=n&&void 0===t?n:Cr(n,t,3),"number"==typeof e)for(;e--&&!1!==n(r[e],e,r););else{var a=Qr(r);e=a.length,on(r,function(r,t,u){return t=a?a[--e]:--e,n(u[t],t,u)})}return r}var bn=Gr(function(r,n,t){(mr.call(r,t)?r[t]:r[t]=[]).push(n)}),An=Gr(function(r,n,t){r[t]=n});function In(r,n,t){var e=-1,a=r?r.length:0;if(n=Sr.createCallback(n,t,3),"number"==typeof a)for(var u=o(a);++e<a;)u[e]=n(r[e],e,r);else u=[],on(r,function(r,t,a){u[++e]=n(r,t,a)});return u}function wn(r,n,t){var e=-1/0,a=e;if("function"!=typeof n&&t&&t[n]===r&&(n=null),null==n&&Kr(r))for(var u=-1,o=r.length;++u<o;){var i=r[u];i>a&&(a=i)}else n=null==n&&dn(r)?q:Sr.createCallback(n,t,3),En(r,function(r,t,u){var o=n(r,t,u);o>e&&(e=o,a=r)});return a}var Sn=In;function Tn(r,n,t,e){if(!r)return t;var a=arguments.length<3;n=Sr.createCallback(n,e,4);var u=-1,o=r.length;if("number"==typeof o)for(a&&(t=r[++u]);++u<o;)t=n(t,r[u],u,r);else on(r,function(r,e,u){t=a?(a=!1,r):n(t,r,e,u)});return t}function Dn(r,n,t,e){var a=arguments.length<3;return n=Sr.createCallback(n,e,4),_n(r,function(r,e,u){t=a?(a=!1,r):n(t,r,e,u)}),t}function Un(r){var n=-1,t=r?r.length:0,e=o("number"==typeof t?t:0);return En(r,function(r){var t=Pr(0,++n);e[n]=e[t],e[t]=r}),e}function On(r,n,t){var e;n=Sr.createCallback(n,t,3);var a=-1,u=r?r.length:0;if("number"==typeof u)for(;++a<u&&!(e=n(r[a],a,r)););else on(r,function(r,t,a){return!(e=n(r,t,a))});return!!e}var Ln=Nn;function Cn(n,t,e){var a=0,u=n?n.length:0;if("number"!=typeof t&&null!=t){var o=-1;for(t=Sr.createCallback(t,e,3);++o<u&&t(n[o],o,n);)a++}else if(null==(a=t)||e)return n?n[0]:r;return K(n,0,br(_r(0,a),u))}function Rn(r,n,t){if("number"==typeof t){var e=r?r.length:0;t=t<0?_r(0,e+t):t||0}else if(t){var a=Yn(r,n);return r[a]===n?a:-1}return P(r,n,t)}function xn(r,n,t){if("number"!=typeof n&&null!=n){var e=0,a=-1,u=r?r.length:0;for(n=Sr.createCallback(n,t,3);++a<u&&n(r[a],a,r);)e++}else e=null==n||t?1:_r(0,n);return K(r,e)}function Yn(r,n,t,e){var a=0,u=r?r.length:a;for(n=(t=t?Sr.createCallback(t,e,1):qn)(n);a<u;){var o=a+u>>>1;t(r[o])<n?a=o+1:u=o}return a}function kn(r,n,t,e){return"boolean"!=typeof n&&null!=n&&(e=t,t="function"!=typeof n&&e&&e[n]===r?null:n,n=!1),null!=t&&(t=Sr.createCallback(t,e,3)),Vr(r,n,t)}function jn(){for(var r=arguments.length>1?arguments:arguments[0],n=-1,t=r?wn(Sn(r,"length")):0,e=o(t<0?0:t);++n<t;)e[n]=Sn(r,n);return e}function Pn(r,n){var t=-1,e=r?r.length:0,a={};for(n||!e||Kr(r[0])||(n=[]);++t<e;){var u=r[t];n?a[u]=n[t]:u&&(a[u[0]]=u[1])}return a}function Vn(r,n){return arguments.length>2?qr(r,17,K(arguments,2),null,n):qr(r,1,null,null,n)}function Gn(n,t,e){var a,u,o,i,l,f,s,c=0,m=!1,h=!0;if(!cn(n))throw new nr;if(t=_r(0,t)||0,!0===e){var p=!0;h=!1}else mn(e)&&(p=e.leading,m="maxWait"in e&&(_r(t,e.maxWait)||0),h="trailing"in e?e.trailing:h);var d=function(){var e=t-(Hn()-i);if(e<=0){u&&lr(u);var m=s;u=f=s=r,m&&(c=Hn(),o=n.apply(l,a),f||u||(a=l=null))}else f=pr(d,e)},g=function(){f&&lr(f),u=f=s=r,(h||m!==t)&&(c=Hn(),o=n.apply(l,a),f||u||(a=l=null))};return function(){if(a=arguments,i=Hn(),l=this,s=h&&(f||!p),!1===m)var r=p&&!f;else{u||p||(c=i);var e=m-(i-c),v=e<=0;v?(u&&(u=lr(u)),c=i,o=n.apply(l,a)):u||(u=pr(g,e))}return v&&f?f=lr(f):f||t===m||(f=pr(d,t)),r&&(v=!0,o=n.apply(l,a)),!v||f||u||(a=l=null),o}}function qn(r){return r}function Bn(r,n,t){var e=!0,a=n&&fn(n);n&&(t||a.length)||(null==t&&(t=n),u=Tr,n=r,r=Sr,a=fn(n)),!1===t?e=!1:mn(t)&&"chain"in t&&(e=t.chain);var u=r,o=cn(u);En(a,function(t){var a=r[t]=n[t];o&&(u.prototype[t]=function(){var n=this.__chain__,t=this.__wrapped__,o=[t];hr.apply(o,arguments);var i=a.apply(r,o);if(e||n){if(t===i&&mn(i))return this;(i=new u(i)).__chain__=n}return i})})}function Xn(){}var Wn,Hn=Wr(Hn=x.now)&&Hn||function(){return(new x).getTime()},zn=8==Ar(i+"08")?Ar:function(r,n){return Ar(dn(r)?r.replace(d,""):r,n||0)};function $n(r){return function(n){return n[r]}}function Zn(){return this.__wrapped__}return Sr.after=function(r,n){if(!cn(n))throw new nr;return function(){if(--r<1)return n.apply(this,arguments)}},Sr.assign=en,Sr.at=function(r){for(var n=arguments,t=-1,e=Yr(n,!0,!1,1),a=n[2]&&n[2][n[1]]===r?1:e.length,u=o(a);++t<a;)u[t]=r[e[t]];return u},Sr.bind=Vn,Sr.bindAll=function(r){for(var n=arguments.length>1?Yr(arguments,!0,!1,1):fn(r),t=-1,e=n.length;++t<e;){var a=n[t];r[a]=qr(r[a],1,null,null,r)}return r},Sr.bindKey=function(r,n){return arguments.length>2?qr(n,19,K(arguments,2),null,r):qr(n,3,null,null,r)},Sr.chain=function(r){return(r=new Tr(r)).__chain__=!0,r},Sr.compact=function(r){for(var n=-1,t=r?r.length:0,e=[];++n<t;){var a=r[n];a&&e.push(a)}return e},Sr.compose=function(){for(var r=arguments,n=r.length;n--;)if(!cn(r[n]))throw new nr;return function(){for(var n=arguments,t=r.length;t--;)n=[r[t].apply(this,n)];return n[0]}},Sr.constant=function(r){return function(){return r}},Sr.countBy=Mn,Sr.create=function(r,n){var t=Lr(r);return n?en(t,n):t},Sr.createCallback=function(r,n,t){var e=typeof r;if(null==r||"function"==e)return Cr(r,n,t);if("object"!=e)return $n(r);var a=Qr(r),u=a[0],o=r[u];return 1!=a.length||o!=o||mn(o)?function(n){for(var t=a.length,e=!1;t--&&(e=kr(n[a[t]],r[a[t]],null,!0)););return e}:function(r){var n=r[u];return o===n&&(0!==o||1/o==1/n)}},Sr.curry=function(r,n){return qr(r,4,null,null,null,n="number"==typeof n?n:+n||r.length)},Sr.debounce=Gn,Sr.defaults=an,Sr.defer=function(n){if(!cn(n))throw new nr;var t=K(arguments,1);return pr(function(){n.apply(r,t)},1)},Sr.delay=function(n,t){if(!cn(n))throw new nr;var e=K(arguments,2);return pr(function(){n.apply(r,e)},t)},Sr.difference=function(r){return xr(r,Yr(arguments,!0,!0,1))},Sr.filter=Nn,Sr.flatten=function(r,n,t,e){return"boolean"!=typeof n&&null!=n&&(e=t,t="function"!=typeof n&&e&&e[n]===r?null:n,n=!1),null!=t&&(r=In(r,t,e)),Yr(r,n)},Sr.forEach=En,Sr.forEachRight=_n,Sr.forIn=un,Sr.forInRight=function(r,n,t){var e=[];un(r,function(r,n){e.push(n,r)});var a=e.length;for(n=Cr(n,t,3);a--&&!1!==n(e[a--],e[a],r););return r},Sr.forOwn=on,Sr.forOwnRight=ln,Sr.functions=fn,Sr.groupBy=bn,Sr.indexBy=An,Sr.initial=function(r,n,t){var e=0,a=r?r.length:0;if("number"!=typeof n&&null!=n){var u=a;for(n=Sr.createCallback(n,t,3);u--&&n(r[u],u,r);)e++}else e=null==n||t?1:n||e;return K(r,0,br(_r(0,a-e),a))},Sr.intersection=function(){for(var r=[],n=-1,t=arguments.length,e=H(),a=Xr(),o=a===P,i=H();++n<t;){var l=arguments[n];(Kr(l)||Zr(l))&&(r.push(l),e.push(o&&l.length>=u&&X(n?r[n]:i)))}var f=r[0],s=-1,c=f?f.length:0,m=[];r:for(;++s<c;){var h=e[0];if(l=f[s],(h?V(h,l):a(i,l))<0){for(n=t,(h||i).push(l);--n;)if(((h=e[n])?V(h,l):a(r[n],l))<0)continue r;m.push(l)}}for(;t--;)(h=e[t])&&Z(h);return $(e),$(i),m},Sr.invert=sn,Sr.invoke=function(r,n){var t=K(arguments,2),e=-1,a="function"==typeof n,u=r?r.length:0,i=o("number"==typeof u?u:0);return En(r,function(r){i[++e]=(a?n:r[n]).apply(r,t)}),i},Sr.keys=Qr,Sr.map=In,Sr.mapValues=function(r,n,t){var e={};return n=Sr.createCallback(n,t,3),on(r,function(r,t,a){e[t]=n(r,t,a)}),e},Sr.max=wn,Sr.memoize=function(r,n){if(!cn(r))throw new nr;var t=function(){var e=t.cache,u=n?n.apply(this,arguments):a+arguments[0];return mr.call(e,u)?e[u]:e[u]=r.apply(this,arguments)};return t.cache={},t},Sr.merge=function(r){var n=arguments,t=2;if(!mn(r))return r;if("number"!=typeof n[2]&&(t=n.length),t>3&&"function"==typeof n[t-2])var e=Cr(n[--t-1],n[t--],2);else t>2&&"function"==typeof n[t-1]&&(e=n[--t]);for(var a=K(arguments,1,t),u=-1,o=H(),i=H();++u<t;)jr(r,a[u],e,o,i);return $(o),$(i),r},Sr.min=function(r,n,t){var e=1/0,a=e;if("function"!=typeof n&&t&&t[n]===r&&(n=null),null==n&&Kr(r))for(var u=-1,o=r.length;++u<o;){var i=r[u];i<a&&(a=i)}else n=null==n&&dn(r)?q:Sr.createCallback(n,t,3),En(r,function(r,t,u){var o=n(r,t,u);o<e&&(e=o,a=r)});return a},Sr.omit=function(r,n,t){var e={};if("function"!=typeof n){var a=[];un(r,function(r,n){a.push(n)});for(var u=-1,o=(a=xr(a,Yr(arguments,!0,!1,1))).length;++u<o;){var i=a[u];e[i]=r[i]}}else n=Sr.createCallback(n,t,3),un(r,function(r,t,a){n(r,t,a)||(e[t]=r)});return e},Sr.once=function(r){var n,t;if(!cn(r))throw new nr;return function(){return n?t:(n=!0,t=r.apply(this,arguments),r=null,t)}},Sr.pairs=function(r){for(var n=-1,t=Qr(r),e=t.length,a=o(e);++n<e;){var u=t[n];a[n]=[u,r[u]]}return a},Sr.partial=function(r){return qr(r,16,K(arguments,1))},Sr.partialRight=function(r){return qr(r,32,null,K(arguments,1))},Sr.pick=function(r,n,t){var e={};if("function"!=typeof n)for(var a=-1,u=Yr(arguments,!0,!1,1),o=mn(r)?u.length:0;++a<o;){var i=u[a];i in r&&(e[i]=r[i])}else n=Sr.createCallback(n,t,3),un(r,function(r,t,a){n(r,t,a)&&(e[t]=r)});return e},Sr.pluck=Sn,Sr.property=$n,Sr.pull=function(r){for(var n=arguments,t=0,e=n.length,a=r?r.length:0;++t<e;)for(var u=-1,o=n[t];++u<a;)r[u]===o&&(dr.call(r,u--,1),a--);return r},Sr.range=function(r,n,t){r=+r||0,t="number"==typeof t?t:+t||1,null==n&&(n=r,r=0);for(var e=-1,a=_r(0,ir((n-r)/(t||1))),u=o(a);++e<a;)u[e]=r,r+=t;return u},Sr.reject=function(r,n,t){return n=Sr.createCallback(n,t,3),Nn(r,function(r,t,e){return!n(r,t,e)})},Sr.remove=function(r,n,t){var e=-1,a=r?r.length:0,u=[];for(n=Sr.createCallback(n,t,3);++e<a;){var o=r[e];n(o,e,r)&&(u.push(o),dr.call(r,e--,1),a--)}return u},Sr.rest=xn,Sr.shuffle=Un,Sr.sortBy=function(r,n,t){var e=-1,a=Kr(n),u=r?r.length:0,i=o("number"==typeof u?u:0);for(a||(n=Sr.createCallback(n,t,3)),En(r,function(r,t,u){var o=i[++e]=z();a?o.criteria=In(n,function(n){return r[n]}):(o.criteria=H())[0]=n(r,t,u),o.index=e,o.value=r}),u=i.length,i.sort(B);u--;){var l=i[u];i[u]=l.value,a||$(l.criteria),Z(l)}return i},Sr.tap=function(r,n){return n(r),r},Sr.throttle=function(r,n,t){var e=!0,a=!0;if(!cn(r))throw new nr;return!1===t?e=!1:mn(t)&&(e="leading"in t?t.leading:e,a="trailing"in t?t.trailing:a),U.leading=e,U.maxWait=n,U.trailing=a,Gn(r,n,U)},Sr.times=function(r,n,t){r=(r=+r)>-1?r:0;var e=-1,a=o(r);for(n=Cr(n,t,1);++e<r;)a[e]=n(e);return a},Sr.toArray=function(r){return r&&"number"==typeof r.length?K(r):gn(r)},Sr.transform=function(r,n,t,e){var a=Kr(r);if(null==t)if(a)t=[];else{var u=r&&r.constructor,o=u&&u.prototype;t=Lr(o)}return n&&(n=Sr.createCallback(n,e,4),(a?En:on)(r,function(r,e,a){return n(t,r,e,a)})),t},Sr.union=function(){return Vr(Yr(arguments,!0,!0))},Sr.uniq=kn,Sr.values=gn,Sr.where=Ln,Sr.without=function(r){return xr(r,K(arguments,1))},Sr.wrap=function(r,n){return qr(n,16,[r])},Sr.xor=function(){for(var r=-1,n=arguments.length;++r<n;){var t=arguments[r];if(Kr(t)||Zr(t))var e=e?Vr(xr(e,t).concat(xr(t,e))):t}return e||[]},Sr.zip=jn,Sr.zipObject=Pn,Sr.collect=In,Sr.drop=xn,Sr.each=En,Sr.eachRight=_n,Sr.extend=en,Sr.methods=fn,Sr.object=Pn,Sr.select=Nn,Sr.tail=xn,Sr.unique=kn,Sr.unzip=jn,Bn(Sr),Sr.clone=function(r,n,t,e){return"boolean"!=typeof n&&null!=n&&(e=t,t=n,n=!1),Or(r,n,"function"==typeof t&&Cr(t,e,1))},Sr.cloneDeep=function(r,n,t){return Or(r,!0,"function"==typeof n&&Cr(n,t,1))},Sr.contains=vn,Sr.escape=function(r){return null==r?"":rr(r).replace(tn,Br)},Sr.every=Fn,Sr.find=yn,Sr.findIndex=function(r,n,t){var e=-1,a=r?r.length:0;for(n=Sr.createCallback(n,t,3);++e<a;)if(n(r[e],e,r))return e;return-1},Sr.findKey=function(r,n,t){var e;return n=Sr.createCallback(n,t,3),on(r,function(r,t,a){if(n(r,t,a))return e=t,!1}),e},Sr.findLast=function(r,n,t){var e;return n=Sr.createCallback(n,t,3),_n(r,function(r,t,a){if(n(r,t,a))return e=r,!1}),e},Sr.findLastIndex=function(r,n,t){var e=r?r.length:0;for(n=Sr.createCallback(n,t,3);e--;)if(n(r[e],e,r))return e;return-1},Sr.findLastKey=function(r,n,t){var e;return n=Sr.createCallback(n,t,3),ln(r,function(r,t,a){if(n(r,t,a))return e=t,!1}),e},Sr.has=function(r,n){return!!r&&mr.call(r,n)},Sr.identity=qn,Sr.indexOf=Rn,Sr.isArguments=Zr,Sr.isArray=Kr,Sr.isBoolean=function(r){return!0===r||!1===r||r&&"object"==typeof r&&ur.call(r)==_||!1},Sr.isDate=function(r){return r&&"object"==typeof r&&ur.call(r)==b||!1},Sr.isElement=function(r){return r&&1===r.nodeType||!1},Sr.isEmpty=function(r){var n=!0;if(!r)return n;var t=ur.call(r),e=r.length;return t==E||t==T||t==y||t==w&&"number"==typeof e&&cn(r.splice)?!e:(on(r,function(){return n=!1}),n)},Sr.isEqual=function(r,n,t,e){return kr(r,n,"function"==typeof t&&Cr(t,e,2))},Sr.isFinite=function(r){return Nr(r)&&!yr(parseFloat(r))},Sr.isFunction=cn,Sr.isNaN=function(r){return hn(r)&&r!=+r},Sr.isNull=function(r){return null===r},Sr.isNumber=hn,Sr.isObject=mn,Sr.isPlainObject=pn,Sr.isRegExp=function(r){return r&&"object"==typeof r&&ur.call(r)==S||!1},Sr.isString=dn,Sr.isUndefined=function(r){return void 0===r},Sr.lastIndexOf=function(r,n,t){var e=r?r.length:0;for("number"==typeof t&&(e=(t<0?_r(0,e+t):br(t,e-1))+1);e--;)if(r[e]===n)return e;return-1},Sr.mixin=Bn,Sr.noConflict=function(){return t._=ar,this},Sr.noop=Xn,Sr.now=Hn,Sr.parseInt=zn,Sr.random=function(r,n,t){var e=null==r,a=null==n;if(null==t&&("boolean"==typeof r&&a?(t=r,r=1):a||"boolean"!=typeof n||(t=n,a=!0)),e&&a&&(n=1),r=+r||0,a?(n=r,r=0):n=+n||0,t||r%1||n%1){var u=Ir();return br(r+u*(n-r+parseFloat("1e-"+((u+"").length-1))),n)}return Pr(r,n)},Sr.reduce=Tn,Sr.reduceRight=Dn,Sr.result=function(r,n){if(r){var t=r[n];return cn(t)?r[n]():t}},Sr.runInContext=n,Sr.size=function(r){var n=r?r.length:0;return"number"==typeof n?n:Qr(r).length},Sr.some=On,Sr.sortedIndex=Yn,Sr.template=function(n,t,e){var a=Sr.templateSettings;n=rr(n||""),e=an({},e,a);var u,o=an({},e.imports,a.imports),i=Qr(o),m=gn(o),h=0,d=e.interpolate||g,v="__p += '",F=J((e.escape||g).source+"|"+d.source+"|"+(d===p?c:g).source+"|"+(e.evaluate||g).source+"|$","g");n.replace(F,function(r,t,e,a,o,i){return e||(e=a),v+=n.slice(h,i).replace(M,W),t&&(v+="' +\n__e("+t+") +\n'"),o&&(u=!0,v+="';\n"+o+";\n__p += '"),e&&(v+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),h=i+r.length,r}),v+="';\n";var y=e.variable,E=y;E||(v="with ("+(y="obj")+") {\n"+v+"\n}\n"),v=(u?v.replace(l,""):v).replace(f,"$1").replace(s,"$1;"),v="function("+y+") {\n"+(E?"":y+" || ("+y+" = {});\n")+"var __t, __p = '', __e = _.escape"+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+v+"return __p\n}";var _="\n/*\n//# sourceURL="+(e.sourceURL||"/lodash/template/source["+N+++"]")+"\n*/";try{var b=Y(i,"return "+v+_).apply(r,m)}catch(r){throw r.source=v,r}return t?b(t):(b.source=v,b)},Sr.unescape=function(r){return null==r?"":rr(r).replace(nn,$r)},Sr.uniqueId=function(r){var n=++e;return rr(null==r?"":r)+n},Sr.all=Fn,Sr.any=On,Sr.detect=yn,Sr.findWhere=yn,Sr.foldl=Tn,Sr.foldr=Dn,Sr.include=vn,Sr.inject=Tn,Bn((Wn={},on(Sr,function(r,n){Sr.prototype[n]||(Wn[n]=r)}),Wn),!1),Sr.first=Cn,Sr.last=function(n,t,e){var a=0,u=n?n.length:0;if("number"!=typeof t&&null!=t){var o=u;for(t=Sr.createCallback(t,e,3);o--&&t(n[o],o,n);)a++}else if(null==(a=t)||e)return n?n[u-1]:r;return K(n,_r(0,u-a))},Sr.sample=function(n,t,e){if(n&&"number"!=typeof n.length&&(n=gn(n)),null==t||e)return n?n[Pr(0,n.length-1)]:r;var a=Un(n);return a.length=br(_r(0,t),a.length),a},Sr.take=Cn,Sr.head=Cn,on(Sr,function(r,n){var t="sample"!==n;Sr.prototype[n]||(Sr.prototype[n]=function(n,e){var a=this.__chain__,u=r(this.__wrapped__,n,e);return a||null!=n&&(!e||t&&"function"==typeof n)?new Tr(u,a):u})}),Sr.VERSION="2.4.1",Sr.prototype.chain=function(){return this.__chain__=!0,this},Sr.prototype.toString=function(){return rr(this.__wrapped__)},Sr.prototype.value=Zn,Sr.prototype.valueOf=Zn,En(["join","pop","shift"],function(r){var n=tr[r];Sr.prototype[r]=function(){var r=this.__chain__,t=n.apply(this.__wrapped__,arguments);return r?new Tr(t,r):t}}),En(["push","reverse","sort","unshift"],function(r){var n=tr[r];Sr.prototype[r]=function(){return n.apply(this.__wrapped__,arguments),this}}),En(["concat","slice","splice"],function(r){var n=tr[r];Sr.prototype[r]=function(){return new Tr(n.apply(this.__wrapped__,arguments),this.__chain__)}}),Sr}();if("function"==typeof define&&"object"==typeof define.amd&&define.amd)R._=Q,define(function(){return Q});else{if(!x||!Y)return R._=R._||{},R._=Q,R._;k?(Y.exports=Q)._=Q:x._=Q}}).call(this),function(r,n){"use strict";var t=n.prototype.trim,e=n.prototype.trimRight,a=n.prototype.trimLeft,u=function(r){return 1*r||0},o=function(r,n){if(n<1)return"";for(var t="";n>0;)1&n&&(t+=r),n>>=1,r+=r;return t},i=[].slice,l=function(r){return null==r?"\\s":r.source?r.source:"["+p.escapeRegExp(r)+"]"};function f(r,n){var t,e,a=r.toLowerCase();for(n=[].concat(n),t=0;t<n.length;t+=1)if(e=n[t]){if(e.test&&e.test(r))return!0;if(e.toLowerCase()===a)return!0}}var s={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},c={};for(var m in s)c[s[m]]=m;c["'"]="#39";var h=function(){function r(r){return Object.prototype.toString.call(r).slice(8,-1).toLowerCase()}var t=o,e=function(){return e.cache.hasOwnProperty(arguments[0])||(e.cache[arguments[0]]=e.parse(arguments[0])),e.format.call(null,e.cache[arguments[0]],arguments)};return e.format=function(e,a){var u,o,i,l,f,s,c,m=1,p=e.length,d="",g=[];for(o=0;o<p;o++)if("string"===(d=r(e[o])))g.push(e[o]);else if("array"===d){if((l=e[o])[2])for(u=a[m],i=0;i<l[2].length;i++){if(!u.hasOwnProperty(l[2][i]))throw new Error(h('[_.sprintf] property "%s" does not exist',l[2][i]));u=u[l[2][i]]}else u=l[1]?a[l[1]]:a[m++];if(/[^s]/.test(l[8])&&"number"!=r(u))throw new Error(h("[_.sprintf] expecting number but found %s",r(u)));switch(l[8]){case"b":u=u.toString(2);break;case"c":u=n.fromCharCode(u);break;case"d":u=parseInt(u,10);break;case"e":u=l[7]?u.toExponential(l[7]):u.toExponential();break;case"f":u=l[7]?parseFloat(u).toFixed(l[7]):parseFloat(u);break;case"o":u=u.toString(8);break;case"s":u=(u=n(u))&&l[7]?u.substring(0,l[7]):u;break;case"u":u=Math.abs(u);break;case"x":u=u.toString(16);break;case"X":u=u.toString(16).toUpperCase()}u=/[def]/.test(l[8])&&l[3]&&u>=0?"+"+u:u,s=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",c=l[6]-n(u).length,f=l[6]?t(s,c):"",g.push(l[5]?u+f:f+u)}return g.join("")},e.cache={},e.parse=function(r){for(var n=r,t=[],e=[],a=0;n;){if(null!==(t=/^[^\x25]+/.exec(n)))e.push(t[0]);else if(null!==(t=/^\x25{2}/.exec(n)))e.push("%");else{if(null===(t=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(n)))throw new Error("[_.sprintf] huh?");if(t[2]){a|=1;var u=[],o=t[2],i=[];if(null===(i=/^([a-z_][a-z_\d]*)/i.exec(o)))throw new Error("[_.sprintf] huh?");for(u.push(i[1]);""!==(o=o.substring(i[0].length));)if(null!==(i=/^\.([a-z_][a-z_\d]*)/i.exec(o)))u.push(i[1]);else{if(null===(i=/^\[(\d+)\]/.exec(o)))throw new Error("[_.sprintf] huh?");u.push(i[1])}t[2]=u}else a|=2;if(3===a)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");e.push(t)}n=n.substring(t[0].length)}return e},e}(),p={VERSION:"2.3.0",isBlank:function(r){return null==r&&(r=""),/^\s*$/.test(r)},stripTags:function(r){return null==r?"":n(r).replace(/<\/?[^>]+>/g,"")},capitalize:function(r){return(r=null==r?"":n(r)).charAt(0).toUpperCase()+r.slice(1)},chop:function(r,t){return null==r?[]:(r=n(r),(t=~~t)>0?r.match(new RegExp(".{1,"+t+"}","g")):[r])},clean:function(r){return p.strip(r).replace(/\s+/g," ")},count:function(r,t){if(null==r||null==t)return 0;r=n(r);for(var e=0,a=0,u=(t=n(t)).length;-1!==(a=r.indexOf(t,a));)e++,a+=u;return e},chars:function(r){return null==r?[]:n(r).split("")},swapCase:function(r){return null==r?"":n(r).replace(/\S/g,function(r){return r===r.toUpperCase()?r.toLowerCase():r.toUpperCase()})},escapeHTML:function(r){return null==r?"":n(r).replace(/[&<>"']/g,function(r){return"&"+c[r]+";"})},unescapeHTML:function(r){return null==r?"":n(r).replace(/\&([^;]+);/g,function(r,t){var e;return t in s?s[t]:(e=t.match(/^#x([\da-fA-F]+)$/))?n.fromCharCode(parseInt(e[1],16)):(e=t.match(/^#(\d+)$/))?n.fromCharCode(~~e[1]):r})},escapeRegExp:function(r){return null==r?"":n(r).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(r,n,t,e){var a=p.chars(r);return a.splice(~~n,~~t,e),a.join("")},insert:function(r,n,t){return p.splice(r,n,0,t)},include:function(r,t){return""===t||null!=r&&-1!==n(r).indexOf(t)},join:function(){var r=i.call(arguments),n=r.shift();return null==n&&(n=""),r.join(n)},lines:function(r){return null==r?[]:n(r).split("\n")},reverse:function(r){return p.chars(r).reverse().join("")},startsWith:function(r,t){return""===t||null!=r&&null!=t&&(r=n(r),t=n(t),r.length>=t.length&&r.slice(0,t.length)===t)},endsWith:function(r,t){return""===t||null!=r&&null!=t&&(r=n(r),t=n(t),r.length>=t.length&&r.slice(r.length-t.length)===t)},succ:function(r){return null==r?"":(r=n(r)).slice(0,-1)+n.fromCharCode(r.charCodeAt(r.length-1)+1)},titleize:function(r){return null==r?"":(r=n(r).toLowerCase()).replace(/(?:^|\s|-)\S/g,function(r){return r.toUpperCase()})},camelize:function(r){return p.trim(r).replace(/[-_\s]+(.)?/g,function(r,n){return n?n.toUpperCase():""})},underscored:function(r){return p.trim(r).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(r){return p.trim(r).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(r){return p.titleize(n(r).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(r){return p.capitalize(p.underscored(r).replace(/_id$/,"").replace(/_/g," "))},trim:function(r,e){return null==r?"":!e&&t?t.call(r):(e=l(e),n(r).replace(new RegExp("^"+e+"+|"+e+"+$","g"),""))},ltrim:function(r,t){return null==r?"":!t&&a?a.call(r):(t=l(t),n(r).replace(new RegExp("^"+t+"+"),""))},rtrim:function(r,t){return null==r?"":!t&&e?e.call(r):(t=l(t),n(r).replace(new RegExp(t+"+$"),""))},truncate:function(r,t,e){return null==r?"":(r=n(r),e=e||"...",t=~~t,r.length>t?r.slice(0,t)+e:r)},prune:function(r,t,e){if(null==r)return"";if(r=n(r),t=~~t,e=null!=e?n(e):"...",r.length<=t)return r;var a=r.slice(0,t+1).replace(/.(?=\W*\w*$)/g,function(r){return r.toUpperCase()!==r.toLowerCase()?"A":" "});return((a=a.slice(a.length-2).match(/\w\w/)?a.replace(/\s*\S+$/,""):p.rtrim(a.slice(0,a.length-1)))+e).length>r.length?r:r.slice(0,a.length)+e},words:function(r,n){return p.isBlank(r)?[]:p.trim(r,n).split(n||/\s+/)},pad:function(r,t,e,a){r=null==r?"":n(r),t=~~t;var u=0;switch(e?e.length>1&&(e=e.charAt(0)):e=" ",a){case"right":return u=t-r.length,r+o(e,u);case"both":return u=t-r.length,o(e,Math.ceil(u/2))+r+o(e,Math.floor(u/2));default:return u=t-r.length,o(e,u)+r}},lpad:function(r,n,t){return p.pad(r,n,t)},rpad:function(r,n,t){return p.pad(r,n,t,"right")},lrpad:function(r,n,t){return p.pad(r,n,t,"both")},sprintf:h,vsprintf:function(r,n){return n.unshift(r),h.apply(null,n)},toNumber:function(r,n){return r?(r=p.trim(r)).match(/^-?\d+(?:\.\d+)?$/)?u(u(r).toFixed(~~n)):NaN:0},numberFormat:function(r,n,t,e){if(isNaN(r)||null==r)return"";r=r.toFixed(~~n),e="string"==typeof e?e:",";var a=r.split("."),u=a[0],o=a[1]?(t||".")+a[1]:"";return u.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+e)+o},strRight:function(r,t){if(null==r)return"";r=n(r);var e=(t=null!=t?n(t):t)?r.indexOf(t):-1;return~e?r.slice(e+t.length,r.length):r},strRightBack:function(r,t){if(null==r)return"";r=n(r);var e=(t=null!=t?n(t):t)?r.lastIndexOf(t):-1;return~e?r.slice(e+t.length,r.length):r},strLeft:function(r,t){if(null==r)return"";r=n(r);var e=(t=null!=t?n(t):t)?r.indexOf(t):-1;return~e?r.slice(0,e):r},strLeftBack:function(r,n){if(null==r)return"";r+="",n=null!=n?""+n:n;var t=r.lastIndexOf(n);return~t?r.slice(0,t):r},toSentence:function(r,n,t,e){n=n||", ",t=t||" and ";var a=r.slice(),u=a.pop();return r.length>2&&e&&(t=p.rtrim(n)+t),a.length?a.join(n)+t+u:u},toSentenceSerial:function(){var r=i.call(arguments);return r[3]=!0,p.toSentence.apply(p,r)},slugify:function(r){if(null==r)return"";var t="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",e=new RegExp(l(t),"g");return r=n(r).toLowerCase().replace(e,function(r){var n=t.indexOf(r);return"aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz".charAt(n)||"-"}),p.dasherize(r.replace(/[^\w\s-]/g,""))},surround:function(r,n){return[n,r,n].join("")},quote:function(r,n){return p.surround(r,n||'"')},unquote:function(r,n){return n=n||'"',r[0]===n&&r[r.length-1]===n?r.slice(1,r.length-1):r},exports:function(){var r={};for(var n in this)this.hasOwnProperty(n)&&!n.match(/^(?:include|contains|reverse)$/)&&(r[n]=this[n]);return r},repeat:function(r,t,e){if(null==r)return"";if(t=~~t,null==e)return o(n(r),t);for(var a=[];t>0;a[--t]=r);return a.join(e)},naturalCmp:function(r,t){if(r==t)return 0;if(!r)return-1;if(!t)return 1;for(var e=/(\.\d+)|(\d+)|(\D+)/g,a=n(r).toLowerCase().match(e),u=n(t).toLowerCase().match(e),o=Math.min(a.length,u.length),i=0;i<o;i++){var l=a[i],f=u[i];if(l!==f){var s=parseInt(l,10);if(!isNaN(s)){var c=parseInt(f,10);if(!isNaN(c)&&s-c)return s-c}return l<f?-1:1}}return a.length===u.length?a.length-u.length:r<t?-1:1},levenshtein:function(r,t){if(null==r&&null==t)return 0;if(null==r)return n(t).length;if(null==t)return n(r).length;r=n(r),t=n(t);for(var e,a,u=[],o=0;o<=t.length;o++)for(var i=0;i<=r.length;i++)a=o&&i?r.charAt(i-1)===t.charAt(o-1)?e:Math.min(u[i],u[i-1],e)+1:o+i,e=u[i],u[i]=a;return u.pop()},toBoolean:function(r,n,t){return"number"==typeof r&&(r=""+r),"string"!=typeof r?!!r:!!f(r=p.trim(r),n||["true","1"])||!f(r,t||["false","0"])&&void 0}};p.strip=p.trim,p.lstrip=p.ltrim,p.rstrip=p.rtrim,p.center=p.lrpad,p.rjust=p.lpad,p.ljust=p.rpad,p.contains=p.include,p.q=p.quote,p.toBool=p.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=p),exports._s=p),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return p}),r._=r._||{},r._.string=r._.str=p}(this,String),function(r){var n,t,e=this,a=Math.round,u=0,o=1,i=2,l=3,f=4,s=5,c=6,m={},h="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,p=/^\/?Date\((\-?\d+)/i,d=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,g=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,v=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,M=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,F=/\d\d?/,N=/\d{1,3}/,y=/\d{1,4}/,E=/[+\-]?\d{1,6}/,_=/\d+/,b=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,A=/Z|[\+\-]\d\d:?\d\d/gi,I=/T/i,w=/[\+\-]?\d+(\.\d{1,3})?/,S=/\d/,T=/\d\d/,D=/\d{3}/,U=/\d{4}/,O=/[+\-]?\d{6}/,L=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,C=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],R=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],x=/([\+\-]|\d\d)/gi,Y="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),k={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},j={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},P={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},V={},G="DDD w W M D d".split(" "),q="M D H h m s w W".split(" "),B={M:function(){return this.month()+1},MMM:function(r){return this.lang().monthsShort(this,r)},MMMM:function(r){return this.lang().months(this,r)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(r){return this.lang().weekdaysMin(this,r)},ddd:function(r){return this.lang().weekdaysShort(this,r)},dddd:function(r){return this.lang().weekdays(this,r)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return J(this.year()%100,2)},YYYY:function(){return J(this.year(),4)},YYYYY:function(){return J(this.year(),5)},YYYYYY:function(){var r=this.year();return(r>=0?"+":"-")+J(Math.abs(r),6)},gg:function(){return J(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return J(this.weekYear(),5)},GG:function(){return J(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return J(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return or(this.milliseconds()/100)},SS:function(){return J(or(this.milliseconds()/10),2)},SSS:function(){return J(this.milliseconds(),3)},SSSS:function(){return J(this.milliseconds(),3)},Z:function(){var r=-this.zone(),n="+";return r<0&&(r=-r,n="-"),n+J(or(r/60),2)+":"+J(or(r)%60,2)},ZZ:function(){var r=-this.zone(),n="+";return r<0&&(r=-r,n="-"),n+J(or(r/60),2)+J(or(r)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},X=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];function W(r,n){return function(t){return J(r.call(this,t),n)}}function H(r,n){return function(t){return this.lang().ordinal(r.call(this,t),n)}}for(;G.length;)t=G.pop(),B[t+"o"]=H(B[t],t);for(;q.length;)t=q.pop(),B[t+t]=W(B[t],2);function z(){}function $(r){sr(r),K(this,r)}function Z(r){var n=ar(r),t=n.year||0,e=n.month||0,a=n.week||0,u=n.day||0,o=n.hour||0,i=n.minute||0,l=n.second||0,f=n.millisecond||0;this._milliseconds=+f+1e3*l+6e4*i+36e5*o,this._days=+u+7*a,this._months=+e+12*t,this._data={},this._bubble()}function K(r,n){for(var t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);return n.hasOwnProperty("toString")&&(r.toString=n.toString),n.hasOwnProperty("valueOf")&&(r.valueOf=n.valueOf),r}function Q(r){return r<0?Math.ceil(r):Math.floor(r)}function J(r,n,t){for(var e=Math.abs(r)+"",a=r>=0;e.length<n;)e="0"+e;return(a?t?"+":"":"-")+e}function rr(r,t,e,a){var u,o,i=t._milliseconds,l=t._days,f=t._months;i&&r._d.setTime(+r._d+i*e),(l||f)&&(u=r.minute(),o=r.hour()),l&&r.date(r.date()+l*e),f&&r.month(r.month()+f*e),i&&!a&&n.updateOffset(r),(l||f)&&(r.minute(u),r.hour(o))}function nr(r){return"[object Array]"===Object.prototype.toString.call(r)}function tr(r,n,t){var e,a=Math.min(r.length,n.length),u=Math.abs(r.length-n.length),o=0;for(e=0;e<a;e++)(t&&r[e]!==n[e]||!t&&or(r[e])!==or(n[e]))&&o++;return o+u}function er(r){if(r){var n=r.toLowerCase().replace(/(.)s$/,"$1");r=j[r]||P[n]||n}return r}function ar(r){var n,t,e={};for(t in r)r.hasOwnProperty(t)&&(n=er(t))&&(e[n]=r[t]);return e}function ur(t){var e,a;if(0===t.indexOf("week"))e=7,a="day";else{if(0!==t.indexOf("month"))return;e=12,a="month"}n[t]=function(u,o){var i,l,f=n.fn._lang[t],s=[];if("number"==typeof u&&(o=u,u=r),l=function(r){var t=n().utc().set(a,r);return f.call(n.fn._lang,t,u||"")},null!=o)return l(o);for(i=0;i<e;i++)s.push(l(i));return s}}function or(r){var n=+r,t=0;return 0!==n&&isFinite(n)&&(t=n>=0?Math.floor(n):Math.ceil(n)),t}function ir(r,n){return new Date(Date.UTC(r,n+1,0)).getUTCDate()}function lr(r){return fr(r)?366:365}function fr(r){return r%4==0&&r%100!=0||r%400==0}function sr(r){var n;r._a&&-2===r._pf.overflow&&(n=r._a[o]<0||r._a[o]>11?o:r._a[i]<1||r._a[i]>ir(r._a[u],r._a[o])?i:r._a[l]<0||r._a[l]>23?l:r._a[f]<0||r._a[f]>59?f:r._a[s]<0||r._a[s]>59?s:r._a[c]<0||r._a[c]>999?c:-1,r._pf._overflowDayOfYear&&(n<u||n>i)&&(n=i),r._pf.overflow=n)}function cr(r){r._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function mr(r){return null==r._isValid&&(r._isValid=!isNaN(r._d.getTime())&&r._pf.overflow<0&&!r._pf.empty&&!r._pf.invalidMonth&&!r._pf.nullInput&&!r._pf.invalidFormat&&!r._pf.userInvalidated,r._strict&&(r._isValid=r._isValid&&0===r._pf.charsLeftOver&&0===r._pf.unusedTokens.length)),r._isValid}function hr(r){return r?r.toLowerCase().replace("_","-"):r}function pr(r,t){return t._isUTC?n(r).zone(t._offset||0):n(r).local()}function dr(r){var t,e,a,u,o=0,i=function(r){if(!m[r]&&h)try{require("./lang/"+r)}catch(r){}return m[r]};if(!r)return n.fn._lang;if(!nr(r)){if(e=i(r))return e;r=[r]}for(;o<r.length;){for(t=(u=hr(r[o]).split("-")).length,a=(a=hr(r[o+1]))?a.split("-"):null;t>0;){if(e=i(u.slice(0,t).join("-")))return e;if(a&&a.length>=t&&tr(u,a,!0)>=t-1)break;t--}o++}return n.fn._lang}function gr(r,n){return r.isValid()?(n=vr(n,r.lang()),V[n]||(V[n]=function(r){var n,t,e,a=r.match(v);for(n=0,t=a.length;n<t;n++)B[a[n]]?a[n]=B[a[n]]:a[n]=(e=a[n]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){var u="";for(n=0;n<t;n++)u+=a[n]instanceof Function?a[n].call(e,r):a[n];return u}}(n)),V[n](r)):r.lang().invalidDate()}function vr(r,n){var t=5;function e(r){return n.longDateFormat(r)||r}for(M.lastIndex=0;t>=0&&M.test(r);)r=r.replace(M,e),M.lastIndex=0,t-=1;return r}function Mr(r,n){var t,e=n._strict;switch(r){case"DDDD":return D;case"YYYY":case"GGGG":case"gggg":return e?U:y;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return e?O:E;case"S":if(e)return S;case"SS":if(e)return T;case"SSS":case"DDD":return e?D:N;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return b;case"a":case"A":return dr(n._l)._meridiemParse;case"X":return w;case"Z":case"ZZ":return A;case"T":return I;case"SSSS":return _;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return e?T:F;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return e?S:F;default:return new RegExp((t=r.replace("\\",""),t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(r,n,t,e,a){return n||t||e||a}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")))}}function Fr(r){var n=(r=r||"").match(A)||[],t=((n[n.length-1]||[])+"").match(x)||["-",0,0],e=60*t[1]+or(t[2]);return"+"===t[0]?-e:e}function Nr(r,n,t){var e,a=t._a;switch(r){case"M":case"MM":null!=n&&(a[o]=or(n)-1);break;case"MMM":case"MMMM":null!=(e=dr(t._l).monthsParse(n))?a[o]=e:t._pf.invalidMonth=n;break;case"D":case"DD":null!=n&&(a[i]=or(n));break;case"DDD":case"DDDD":null!=n&&(t._dayOfYear=or(n));break;case"YY":a[u]=or(n)+(or(n)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":a[u]=or(n);break;case"a":case"A":t._isPm=dr(t._l).isPM(n);break;case"H":case"HH":case"h":case"hh":a[l]=or(n);break;case"m":case"mm":a[f]=or(n);break;case"s":case"ss":a[s]=or(n);break;case"S":case"SS":case"SSS":case"SSSS":a[c]=or(1e3*("0."+n));break;case"X":t._d=new Date(1e3*parseFloat(n));break;case"Z":case"ZZ":t._useUTC=!0,t._tzm=Fr(n);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":r=r.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":r=r.substr(0,2),n&&(t._w=t._w||{},t._w[r]=n)}}function yr(r){var t,e,a,s,c,m,h,p,d,g,v=[];if(!r._d){var M,F;for(M=r,F=new Date,a=M._useUTC?[F.getUTCFullYear(),F.getUTCMonth(),F.getUTCDate()]:[F.getFullYear(),F.getMonth(),F.getDate()],r._w&&null==r._a[i]&&null==r._a[o]&&(c=function(t){var e=parseInt(t,10);return t?t.length<3?e>68?1900+e:2e3+e:e:null==r._a[u]?n().weekYear():r._a[u]},null!=(m=r._w).GG||null!=m.W||null!=m.E?h=wr(c(m.GG),m.W||1,m.E,4,1):(p=dr(r._l),d=null!=m.d?Ar(m.d,p):null!=m.e?parseInt(m.e,10)+p._week.dow:0,g=parseInt(m.w,10)||1,null!=m.d&&d<p._week.dow&&g++,h=wr(c(m.gg),g,d,p._week.doy,p._week.dow)),r._a[u]=h.year,r._dayOfYear=h.dayOfYear),r._dayOfYear&&(s=null==r._a[u]?a[u]:r._a[u],r._dayOfYear>lr(s)&&(r._pf._overflowDayOfYear=!0),e=br(s,0,r._dayOfYear),r._a[o]=e.getUTCMonth(),r._a[i]=e.getUTCDate()),t=0;t<3&&null==r._a[t];++t)r._a[t]=v[t]=a[t];for(;t<7;t++)r._a[t]=v[t]=null==r._a[t]?2===t?1:0:r._a[t];v[l]+=or((r._tzm||0)/60),v[f]+=or((r._tzm||0)%60),r._d=(r._useUTC?br:function(r,n,t,e,a,u,o){var i=new Date(r,n,t,e,a,u,o);r<1970&&i.setFullYear(r);return i}).apply(null,v)}}function Er(r){r._a=[],r._pf.empty=!0;var n,t,e,a,u,o=dr(r._l),i=""+r._i,f=i.length,s=0;for(e=vr(r._f,o).match(v)||[],n=0;n<e.length;n++)a=e[n],(t=(i.match(Mr(a,r))||[])[0])&&((u=i.substr(0,i.indexOf(t))).length>0&&r._pf.unusedInput.push(u),i=i.slice(i.indexOf(t)+t.length),s+=t.length),B[a]?(t?r._pf.empty=!1:r._pf.unusedTokens.push(a),Nr(a,t,r)):r._strict&&!t&&r._pf.unusedTokens.push(a);r._pf.charsLeftOver=f-s,i.length>0&&r._pf.unusedInput.push(i),r._isPm&&r._a[l]<12&&(r._a[l]+=12),!1===r._isPm&&12===r._a[l]&&(r._a[l]=0),yr(r),sr(r)}function _r(n){var t,e,a,u=n._i,o=p.exec(u);u===r?n._d=new Date:o?n._d=new Date(+o[1]):"string"==typeof u?function(r){var n,t=r._i,e=L.exec(t);if(e){for(r._pf.iso=!0,n=4;n>0;n--)if(e[n]){r._f=C[n-1]+(e[6]||" ");break}for(n=0;n<4;n++)if(R[n][1].exec(t)){r._f+=R[n][0];break}t.match(A)&&(r._f+="Z"),Er(r)}else r._d=new Date(t)}(n):nr(u)?(n._a=u.slice(0),yr(n)):(a=u,"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date?n._d=new Date(+u):"object"==typeof u?(t=n)._d||(e=ar(t._i),t._a=[e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond],yr(t)):n._d=new Date(u))}function br(r){var n=new Date(Date.UTC.apply(null,arguments));return r<1970&&n.setUTCFullYear(r),n}function Ar(r,n){if("string"==typeof r)if(isNaN(r)){if("number"!=typeof(r=n.weekdaysParse(r)))return null}else r=parseInt(r,10);return r}function Ir(r,t,e){var a,u=e-t,o=e-r.day();return o>u&&(o-=7),o<u-7&&(o+=7),a=n(r).add("d",o),{week:Math.ceil(a.dayOfYear()/7),year:a.year()}}function wr(r,n,t,e,a){var u,o=new Date(J(r,6,!0)+"-01-01").getUTCDay();return{year:(u=7*(n-1)+((t=null!=t?t:a)-a)+(a-o+(o>e?7:0))+1)>0?r:r-1,dayOfYear:u>0?u:lr(r-1)+u}}function Sr(r){var t=r._i,e=r._f;return void 0===r._pf&&cr(r),null===t?n.invalid({nullInput:!0}):("string"==typeof t&&(r._i=t=dr().preparse(t)),n.isMoment(t)?(r=K({},t))._d=new Date(+t._d):e?nr(e)?function(r){var n,t,e,a,u;if(0===r._f.length)return r._pf.invalidFormat=!0,void(r._d=new Date(NaN));for(a=0;a<r._f.length;a++)u=0,cr(n=K({},r)),n._f=r._f[a],Er(n),mr(n)&&(u+=n._pf.charsLeftOver,u+=10*n._pf.unusedTokens.length,n._pf.score=u,(null==e||u<e)&&(e=u,t=n));K(r,t||n)}(r):Er(r):_r(r),new $(r))}for(B.DDDD=W(B.DDD,3),K(z.prototype,{set:function(r){var n,t;for(t in r)"function"==typeof(n=r[t])?this[t]=n:this["_"+t]=n},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(r){return this._months[r.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(r){return this._monthsShort[r.month()]},monthsParse:function(r){var t,e,a;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(e=n.utc([2e3,t]),a="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[t]=new RegExp(a.replace(".",""),"i")),this._monthsParse[t].test(r))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(r){return this._weekdays[r.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(r){return this._weekdaysShort[r.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(r){return this._weekdaysMin[r.day()]},weekdaysParse:function(r){var t,e,a;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;t<7;t++)if(this._weekdaysParse[t]||(e=n([2e3,1]).day(t),a="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[t]=new RegExp(a.replace(".",""),"i")),this._weekdaysParse[t].test(r))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(r){var n=this._longDateFormat[r];return!n&&this._longDateFormat[r.toUpperCase()]&&(n=this._longDateFormat[r.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(r){return r.slice(1)}),this._longDateFormat[r]=n),n},isPM:function(r){return"p"===(r+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(r,n,t){return r>11?t?"pm":"PM":t?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(r,n){var t=this._calendar[r];return"function"==typeof t?t.apply(n):t},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(r,n,t,e){var a=this._relativeTime[t];return"function"==typeof a?a(r,n,t,e):a.replace(/%d/i,r)},pastFuture:function(r,n){var t=this._relativeTime[r>0?"future":"past"];return"function"==typeof t?t(n):t.replace(/%s/i,n)},ordinal:function(r){return this._ordinal.replace("%d",r)},_ordinal:"%d",preparse:function(r){return r},postformat:function(r){return r},week:function(r){return Ir(r,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),(n=function(n,t,e,a){return"boolean"==typeof e&&(a=e,e=r),Sr({_i:n,_f:t,_l:e,_strict:a,_isUTC:!1})}).utc=function(n,t,e,a){return"boolean"==typeof e&&(a=e,e=r),Sr({_useUTC:!0,_isUTC:!0,_l:e,_i:n,_f:t,_strict:a}).utc()},n.unix=function(r){return n(1e3*r)},n.duration=function(r,t){var e,a,u,o=r,m=null;return n.isDuration(r)?o={ms:r._milliseconds,d:r._days,M:r._months}:"number"==typeof r?(o={},t?o[t]=r:o.milliseconds=r):(m=d.exec(r))?(e="-"===m[1]?-1:1,o={y:0,d:or(m[i])*e,h:or(m[l])*e,m:or(m[f])*e,s:or(m[s])*e,ms:or(m[c])*e}):(m=g.exec(r))&&(e="-"===m[1]?-1:1,o={y:(u=function(r){var n=r&&parseFloat(r.replace(",","."));return(isNaN(n)?0:n)*e})(m[2]),M:u(m[3]),d:u(m[4]),h:u(m[5]),m:u(m[6]),s:u(m[7]),w:u(m[8])}),a=new Z(o),n.isDuration(r)&&r.hasOwnProperty("_lang")&&(a._lang=r._lang),a},n.version="2.5.0",n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.updateOffset=function(){},n.lang=function(r,t){var e,a;return r?(t?(e=hr(r),(a=t).abbr=e,m[e]||(m[e]=new z),m[e].set(a),m[e]):null===t?(delete m[r],r="en"):m[r]||dr(r),(n.duration.fn._lang=n.fn._lang=dr(r))._abbr):n.fn._lang._abbr},n.langData=function(r){return r&&r._lang&&r._lang._abbr&&(r=r._lang._abbr),dr(r)},n.isMoment=function(r){return r instanceof $},n.isDuration=function(r){return r instanceof Z},t=X.length-1;t>=0;--t)ur(X[t]);function Tr(r,t){n.fn[r]=n.fn[r+"s"]=function(r){var e=this._isUTC?"UTC":"";return null!=r?(this._d["set"+e+t](r),n.updateOffset(this),this):this._d["get"+e+t]()}}for(n.normalizeUnits=function(r){return er(r)},n.invalid=function(r){var t=n.utc(NaN);return null!=r?K(t._pf,r):t._pf.userInvalidated=!0,t},n.parseZone=function(r){return n(r).parseZone()},K(n.fn=$.prototype,{clone:function(){return n(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var r=n(this).utc();return 0<r.year()&&r.year()<=9999?gr(r,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):gr(r,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var r=this;return[r.year(),r.month(),r.date(),r.hours(),r.minutes(),r.seconds(),r.milliseconds()]},isValid:function(){return mr(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&tr(this._a,(this._isUTC?n.utc(this._a):n(this._a)).toArray())>0)},parsingFlags:function(){return K({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(r){var t=gr(this,r||n.defaultFormat);return this.lang().postformat(t)},add:function(r,t){return rr(this,"string"==typeof r?n.duration(+t,r):n.duration(r,t),1),this},subtract:function(r,t){return rr(this,"string"==typeof r?n.duration(+t,r):n.duration(r,t),-1),this},diff:function(r,t,e){var a,u,o=pr(r,this),i=6e4*(this.zone()-o.zone());return"year"===(t=er(t))||"month"===t?(a=432e5*(this.daysInMonth()+o.daysInMonth()),u=12*(this.year()-o.year())+(this.month()-o.month()),u+=(this-n(this).startOf("month")-(o-n(o).startOf("month")))/a,u-=6e4*(this.zone()-n(this).startOf("month").zone()-(o.zone()-n(o).startOf("month").zone()))/a,"year"===t&&(u/=12)):(a=this-o,u="second"===t?a/1e3:"minute"===t?a/6e4:"hour"===t?a/36e5:"day"===t?(a-i)/864e5:"week"===t?(a-i)/6048e5:a),e?u:Q(u)},from:function(r,t){return n.duration(this.diff(r)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(r){return this.from(n(),r)},calendar:function(){var r=pr(n(),this).startOf("day"),t=this.diff(r,"days",!0),e=t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){return fr(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(r){var n=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=r?(r=Ar(r,this.lang()),this.add({d:r-n})):n},month:function(r){var t,e=this._isUTC?"UTC":"";return null!=r?"string"==typeof r&&"number"!=typeof(r=this.lang().monthsParse(r))?this:(t=this.date(),this.date(1),this._d["set"+e+"Month"](r),this.date(Math.min(t,this.daysInMonth())),n.updateOffset(this),this):this._d["get"+e+"Month"]()},startOf:function(r){switch(r=er(r)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===r?this.weekday(0):"isoWeek"===r&&this.isoWeekday(1),this},endOf:function(r){return r=er(r),this.startOf(r).add("isoWeek"===r?"week":r,1).subtract("ms",1)},isAfter:function(r,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)>+n(r).startOf(t)},isBefore:function(r,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)<+n(r).startOf(t)},isSame:function(r,n){return n=n||"ms",+this.clone().startOf(n)==+pr(r,this).startOf(n)},min:function(r){return(r=n.apply(null,arguments))<this?this:r},max:function(r){return(r=n.apply(null,arguments))>this?this:r},zone:function(r){var t=this._offset||0;return null==r?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof r&&(r=Fr(r)),Math.abs(r)<16&&(r*=60),this._offset=r,this._isUTC=!0,t!==r&&rr(this,n.duration(t-r,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(r){return r=r?n(r).zone():0,(this.zone()-r)%60==0},daysInMonth:function(){return ir(this.year(),this.month())},dayOfYear:function(r){var t=a((n(this).startOf("day")-n(this).startOf("year"))/864e5)+1;return null==r?t:this.add("d",r-t)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(r){var n=Ir(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==r?n:this.add("y",r-n)},isoWeekYear:function(r){var n=Ir(this,1,4).year;return null==r?n:this.add("y",r-n)},week:function(r){var n=this.lang().week(this);return null==r?n:this.add("d",7*(r-n))},isoWeek:function(r){var n=Ir(this,1,4).week;return null==r?n:this.add("d",7*(r-n))},weekday:function(r){var n=(this.day()+7-this.lang()._week.dow)%7;return null==r?n:this.add("d",r-n)},isoWeekday:function(r){return null==r?this.day()||7:this.day(this.day()%7?r:r-7)},get:function(r){return this[r=er(r)]()},set:function(r,n){return"function"==typeof this[r=er(r)]&&this[r](n),this},lang:function(n){return n===r?this._lang:(this._lang=dr(n),this)}}),t=0;t<Y.length;t++)Tr(Y[t].toLowerCase().replace(/s$/,""),Y[t]);function Dr(r){n.duration.fn[r]=function(){return this._data[r]}}function Ur(r,t){n.duration.fn["as"+r]=function(){return+this/t}}Tr("year","FullYear"),n.fn.days=n.fn.day,n.fn.months=n.fn.month,n.fn.weeks=n.fn.week,n.fn.isoWeeks=n.fn.isoWeek,n.fn.toJSON=n.fn.toISOString,K(n.duration.fn=Z.prototype,{_bubble:function(){var r,n,t,e,a=this._milliseconds,u=this._days,o=this._months,i=this._data;i.milliseconds=a%1e3,r=Q(a/1e3),i.seconds=r%60,n=Q(r/60),i.minutes=n%60,t=Q(n/60),i.hours=t%24,u+=Q(t/24),i.days=u%30,o+=Q(u/30),i.months=o%12,e=Q(o/12),i.years=e},weeks:function(){return Q(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*or(this._months/12)},humanize:function(r){var n,t,e,u,o,i,l,f,s,c=+this,m=(n=c,t=!r,e=this.lang(),u=a(Math.abs(n)/1e3),o=a(u/60),i=a(o/60),l=a(i/24),f=a(l/365),(s=u<45&&["s",u]||1===o&&["m"]||o<45&&["mm",o]||1===i&&["h"]||i<22&&["hh",i]||1===l&&["d"]||l<=25&&["dd",l]||l<=45&&["M"]||l<345&&["MM",a(l/30)]||1===f&&["y"]||["yy",f])[2]=t,s[3]=n>0,s[4]=e,function(r,n,t,e,a){return a.relativeTime(n||1,!!t,r,e)}.apply({},s));return r&&(m=this.lang().pastFuture(c,m)),this.lang().postformat(m)},add:function(r,t){var e=n.duration(r,t);return this._milliseconds+=e._milliseconds,this._days+=e._days,this._months+=e._months,this._bubble(),this},subtract:function(r,t){var e=n.duration(r,t);return this._milliseconds-=e._milliseconds,this._days-=e._days,this._months-=e._months,this._bubble(),this},get:function(r){return this[(r=er(r)).toLowerCase()+"s"]()},as:function(r){return this["as"+(r=er(r)).charAt(0).toUpperCase()+r.slice(1)+"s"]()},lang:n.fn.lang,toIsoString:function(){var r=Math.abs(this.years()),n=Math.abs(this.months()),t=Math.abs(this.days()),e=Math.abs(this.hours()),a=Math.abs(this.minutes()),u=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(r?r+"Y":"")+(n?n+"M":"")+(t?t+"D":"")+(e||a||u?"T":"")+(e?e+"H":"")+(a?a+"M":"")+(u?u+"S":""):"P0D"}});for(t in k)k.hasOwnProperty(t)&&(Ur(t,k[t]),Dr(t.toLowerCase()));function Or(r){var t=!1,a=n;"undefined"==typeof ender&&(r?(e.moment=function(){return!t&&console&&console.warn&&(t=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),a.apply(null,arguments)},K(e.moment,a)):e.moment=n)}Ur("Weeks",6048e5),n.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},n.lang("en",{ordinal:function(r){var n=r%10;return r+(1===or(r%100/10)?"th":1===n?"st":2===n?"nd":3===n?"rd":"th")}}),h?(module.exports=n,Or(!0)):"function"==typeof define&&define.amd?define("moment",function(t,e,a){return a.config&&a.config()&&!0!==a.config().noGlobal&&Or(a.config().noGlobal===r),n}):Or()}.call(this),function(){var r,n={},t="en",e=null,a="0,0",u="undefined"!=typeof module&&module.exports;function o(r){this._value=r}function i(r,n,t,e){var a,u,o=Math.pow(10,n);return u=(t(r*o)/o).toFixed(n),e&&(a=new RegExp("0{1,"+e+"}$"),u=u.replace(a,"")),u}function l(r,e,a){var u,o,i,l,f;return e.indexOf("$")>-1?u=function(r,e,a){var u,o,i=e.indexOf("$"),l=e.indexOf("("),f=e.indexOf("-"),c="";e.indexOf(" $")>-1?(c=" ",e=e.replace(" $","")):e.indexOf("$ ")>-1?(c=" ",e=e.replace("$ ","")):e=e.replace("$","");o=s(r._value,e,a),i<=1?o.indexOf("(")>-1||o.indexOf("-")>-1?(o=o.split(""),u=1,(i<l||i<f)&&(u=0),o.splice(u,0,n[t].currency.symbol+c),o=o.join("")):o=n[t].currency.symbol+c+o:o.indexOf(")")>-1?((o=o.split("")).splice(-1,0,c+n[t].currency.symbol),o=o.join("")):o=o+c+n[t].currency.symbol;return o}(r,e,a):e.indexOf("%")>-1?u=function(r,n,t){var e,a="",u=100*r._value;n.indexOf(" %")>-1?(a=" ",n=n.replace(" %","")):n=n.replace("%","");(e=s(u,n,t)).indexOf(")")>-1?((e=e.split("")).splice(-1,0,a+"%"),e=e.join("")):e=e+a+"%";return e}(r,e,a):e.indexOf(":")>-1?(o=r,i=Math.floor(o._value/60/60),l=Math.floor((o._value-60*i*60)/60),f=Math.round(o._value-60*i*60-60*l),u=i+":"+(l<10?"0"+l:l)+":"+(f<10?"0"+f:f)):u=s(r._value,e,a),u}function f(r,a){var u,o,i,l,f,s=a,c=["KB","MB","GB","TB","PB","EB","ZB","YB"],m=!1;if(a.indexOf(":")>-1)r._value=function(r){var n=r.split(":"),t=0;3===n.length?(t+=60*Number(n[0])*60,t+=60*Number(n[1]),t+=Number(n[2])):2===n.length&&(t+=60*Number(n[0]),t+=Number(n[1]));return Number(t)}(a);else if(a===e)r._value=0;else{for("."!==n[t].delimiters.decimal&&(a=a.replace(/\./g,"").replace(n[t].delimiters.decimal,".")),u=new RegExp("[^a-zA-Z]"+n[t].abbreviations.thousand+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+n[t].abbreviations.million+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+n[t].abbreviations.billion+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),l=new RegExp("[^a-zA-Z]"+n[t].abbreviations.trillion+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),f=0;f<=c.length&&!(m=a.indexOf(c[f])>-1&&Math.pow(1024,f+1));f++);r._value=(m||1)*(s.match(u)?Math.pow(10,3):1)*(s.match(o)?Math.pow(10,6):1)*(s.match(i)?Math.pow(10,9):1)*(s.match(l)?Math.pow(10,12):1)*(a.indexOf("%")>-1?.01:1)*((a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1)*Number(a.replace(/[^0-9\.]+/g,"")),r._value=m?Math.ceil(r._value):r._value}return r._value}function s(r,a,u){var o,l,f,s,c,m,h=!1,p=!1,d=!1,g="",v=!1,M=!1,F=!1,N=!1,y=!1,E="",_="",b=Math.abs(r),A=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],I="",w=!1;if(0===r&&null!==e)return e;if(a.indexOf("(")>-1?(h=!0,a=a.slice(1,-1)):a.indexOf("+")>-1&&(p=!0,a=a.replace(/\+/g,"")),a.indexOf("a")>-1&&(v=a.indexOf("aK")>=0,M=a.indexOf("aM")>=0,F=a.indexOf("aB")>=0,N=a.indexOf("aT")>=0,y=v||M||F||N,a.indexOf(" a")>-1?(g=" ",a=a.replace(" a","")):a=a.replace("a",""),b>=Math.pow(10,12)&&!y||N?(g+=n[t].abbreviations.trillion,r/=Math.pow(10,12)):b<Math.pow(10,12)&&b>=Math.pow(10,9)&&!y||F?(g+=n[t].abbreviations.billion,r/=Math.pow(10,9)):b<Math.pow(10,9)&&b>=Math.pow(10,6)&&!y||M?(g+=n[t].abbreviations.million,r/=Math.pow(10,6)):(b<Math.pow(10,6)&&b>=Math.pow(10,3)&&!y||v)&&(g+=n[t].abbreviations.thousand,r/=Math.pow(10,3))),a.indexOf("b")>-1)for(a.indexOf(" b")>-1?(E=" ",a=a.replace(" b","")):a=a.replace("b",""),f=0;f<=A.length;f++)if(o=Math.pow(1024,f),l=Math.pow(1024,f+1),r>=o&&r<l){E+=A[f],o>0&&(r/=o);break}return a.indexOf("o")>-1&&(a.indexOf(" o")>-1?(_=" ",a=a.replace(" o","")):a=a.replace("o",""),_+=n[t].ordinal(r)),a.indexOf("[.]")>-1&&(d=!0,a=a.replace("[.]",".")),s=r.toString().split(".")[0],c=a.split(".")[1],m=a.indexOf(","),c?(s=(I=c.indexOf("[")>-1?i(r,(c=(c=c.replace("]","")).split("["))[0].length+c[1].length,u,c[1].length):i(r,c.length,u)).split(".")[0],I=I.split(".")[1].length?n[t].delimiters.decimal+I.split(".")[1]:"",d&&0===Number(I.slice(1))&&(I="")):s=i(r,null,u),s.indexOf("-")>-1&&(s=s.slice(1),w=!0),m>-1&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n[t].delimiters.thousands)),0===a.indexOf(".")&&(s=""),(h&&w?"(":"")+(!h&&w?"-":"")+(!w&&p?"+":"")+s+I+(_||"")+(g||"")+(E||"")+(h&&w?")":"")}function c(r){var n=r.toString().split(".");return n.length<2?1:Math.pow(10,n[1].length)}function m(){return Array.prototype.slice.call(arguments).reduce(function(r,n){var t=c(r),e=c(n);return t>e?t:e},-1/0)}(r=function(n){return r.isNumeral(n)?n=n.value():0===n||void 0===n?n=0:Number(n)||(n=r.fn.unformat(n)),new o(Number(n))}).version="1.5.3",r.isNumeral=function(r){return r instanceof o},r.language=function(e,a){if(!e)return t;if(e&&!a){if(!n[e])throw new Error("Unknown language : "+e);t=e}var u;return!a&&n[e]||(u=a,n[e]=u),r},r.languageData=function(r){if(!r)return n[t];if(!n[r])throw new Error("Unknown language : "+r);return n[r]},r.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(r){var n=r%10;return 1==~~(r%100/10)?"th":1===n?"st":2===n?"nd":3===n?"rd":"th"},currency:{symbol:"$"}}),r.zeroFormat=function(r){e="string"==typeof r?r:null},r.defaultFormat=function(r){a="string"==typeof r?r:"0.0"},r.validate=function(n,t){var e,a,u,o,i,l,f,s;if("string"!=typeof n&&(n+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",n)),""===(n=n.trim()))return!1;n=n.replace(/^[+-]?/,"");try{f=r.languageData(t)}catch(n){f=r.languageData(r.language())}return u=f.currency.symbol,i=f.abbreviations,e=f.delimiters.decimal,a="."===f.delimiters.thousands?"\\.":f.delimiters.thousands,(null===(s=n.match(/^[^\d]+/))||(n=n.substr(1),s[0]===u))&&((null===(s=n.match(/[^\d]+$/))||(n=n.slice(0,-1),s[0]===i.thousand||s[0]===i.million||s[0]===i.billion||s[0]===i.trillion))&&(!!n.match(/^\d+$/)||(l=new RegExp(a+"{2}"),!n.match(/[^\d.,]/g)&&(!((o=n.split(e)).length>2)&&(o.length<2?!!o[0].match(/^\d+.*\d$/)&&!o[0].match(l):1===o[0].length?!!o[0].match(/^\d+$/)&&!o[0].match(l)&&!!o[1].match(/^\d+$/):!!o[0].match(/^\d+.*\d$/)&&!o[0].match(l)&&!!o[1].match(/^\d+$/))))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(r,n){"use strict";if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof r)throw new TypeError(r+" is not a function");var t,e,a=this.length>>>0,u=!1;for(1<arguments.length&&(e=n,u=!0),t=0;a>t;++t)this.hasOwnProperty(t)&&(u?e=r(e,this[t],t,this):(e=this[t],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return e}),r.fn=o.prototype={clone:function(){return r(this)},format:function(r,n){return l(this,r||a,void 0!==n?n:Math.round)},unformat:function(r){return"[object Number]"===Object.prototype.toString.call(r)?r:f(this,r||a)},value:function(){return this._value},valueOf:function(){return this._value},set:function(r){return this._value=Number(r),this},add:function(r){var n=m.call(null,this._value,r);return this._value=[this._value,r].reduce(function(r,t,e,a){return r+n*t},0)/n,this},subtract:function(r){var n=m.call(null,this._value,r);return this._value=[r].reduce(function(r,t,e,a){return r-n*t},this._value*n)/n,this},multiply:function(r){return this._value=[this._value,r].reduce(function(r,n,t,e){var a=m(r,n);return r*a*(n*a)/(a*a)},1),this},divide:function(r){return this._value=[this._value,r].reduce(function(r,n,t,e){var a=m(r,n);return r*a/(n*a)}),this},difference:function(n){return Math.abs(r(this._value).subtract(n).value())}},u&&(module.exports=r),"undefined"==typeof ender&&(this.numeral=r),"function"==typeof define&&define.amd&&define([],function(){return r})}.call(window),function(r){"use strict";function n(r,n){var t=(65535&r)+(65535&n);return(r>>16)+(n>>16)+(t>>16)<<16|65535&t}function t(r,t,e,a,u,o){return n((i=n(n(t,r),n(a,o)))<<(l=u)|i>>>32-l,e);var i,l}function e(r,n,e,a,u,o,i){return t(n&e|~n&a,r,n,u,o,i)}function a(r,n,e,a,u,o,i){return t(n&a|e&~a,r,n,u,o,i)}function u(r,n,e,a,u,o,i){return t(n^e^a,r,n,u,o,i)}function o(r,n,e,a,u,o,i){return t(e^(n|~a),r,n,u,o,i)}function i(r,t){r[t>>5]|=128<<t%32,r[14+(t+64>>>9<<4)]=t;var i,l,f,s,c,m=1732584193,h=-271733879,p=-1732584194,d=271733878;for(i=0;i<r.length;i+=16)l=m,f=h,s=p,c=d,h=o(h=o(h=o(h=o(h=u(h=u(h=u(h=u(h=a(h=a(h=a(h=a(h=e(h=e(h=e(h=e(h,p=e(p,d=e(d,m=e(m,h,p,d,r[i],7,-680876936),h,p,r[i+1],12,-389564586),m,h,r[i+2],17,606105819),d,m,r[i+3],22,-1044525330),p=e(p,d=e(d,m=e(m,h,p,d,r[i+4],7,-176418897),h,p,r[i+5],12,1200080426),m,h,r[i+6],17,-1473231341),d,m,r[i+7],22,-45705983),p=e(p,d=e(d,m=e(m,h,p,d,r[i+8],7,1770035416),h,p,r[i+9],12,-1958414417),m,h,r[i+10],17,-42063),d,m,r[i+11],22,-1990404162),p=e(p,d=e(d,m=e(m,h,p,d,r[i+12],7,1804603682),h,p,r[i+13],12,-40341101),m,h,r[i+14],17,-1502002290),d,m,r[i+15],22,1236535329),p=a(p,d=a(d,m=a(m,h,p,d,r[i+1],5,-165796510),h,p,r[i+6],9,-1069501632),m,h,r[i+11],14,643717713),d,m,r[i],20,-373897302),p=a(p,d=a(d,m=a(m,h,p,d,r[i+5],5,-701558691),h,p,r[i+10],9,38016083),m,h,r[i+15],14,-660478335),d,m,r[i+4],20,-405537848),p=a(p,d=a(d,m=a(m,h,p,d,r[i+9],5,568446438),h,p,r[i+14],9,-1019803690),m,h,r[i+3],14,-187363961),d,m,r[i+8],20,1163531501),p=a(p,d=a(d,m=a(m,h,p,d,r[i+13],5,-1444681467),h,p,r[i+2],9,-51403784),m,h,r[i+7],14,1735328473),d,m,r[i+12],20,-1926607734),p=u(p,d=u(d,m=u(m,h,p,d,r[i+5],4,-378558),h,p,r[i+8],11,-2022574463),m,h,r[i+11],16,1839030562),d,m,r[i+14],23,-35309556),p=u(p,d=u(d,m=u(m,h,p,d,r[i+1],4,-1530992060),h,p,r[i+4],11,1272893353),m,h,r[i+7],16,-155497632),d,m,r[i+10],23,-1094730640),p=u(p,d=u(d,m=u(m,h,p,d,r[i+13],4,681279174),h,p,r[i],11,-358537222),m,h,r[i+3],16,-722521979),d,m,r[i+6],23,76029189),p=u(p,d=u(d,m=u(m,h,p,d,r[i+9],4,-640364487),h,p,r[i+12],11,-421815835),m,h,r[i+15],16,530742520),d,m,r[i+2],23,-995338651),p=o(p,d=o(d,m=o(m,h,p,d,r[i],6,-198630844),h,p,r[i+7],10,1126891415),m,h,r[i+14],15,-1416354905),d,m,r[i+5],21,-57434055),p=o(p,d=o(d,m=o(m,h,p,d,r[i+12],6,1700485571),h,p,r[i+3],10,-1894986606),m,h,r[i+10],15,-1051523),d,m,r[i+1],21,-2054922799),p=o(p,d=o(d,m=o(m,h,p,d,r[i+8],6,1873313359),h,p,r[i+15],10,-30611744),m,h,r[i+6],15,-1560198380),d,m,r[i+13],21,1309151649),p=o(p,d=o(d,m=o(m,h,p,d,r[i+4],6,-145523070),h,p,r[i+11],10,-1120210379),m,h,r[i+2],15,718787259),d,m,r[i+9],21,-343485551),m=n(m,l),h=n(h,f),p=n(p,s),d=n(d,c);return[m,h,p,d]}function l(r){var n,t="";for(n=0;n<32*r.length;n+=8)t+=String.fromCharCode(r[n>>5]>>>n%32&255);return t}function f(r){var n,t=[];for(t[(r.length>>2)-1]=void 0,n=0;n<t.length;n+=1)t[n]=0;for(n=0;n<8*r.length;n+=8)t[n>>5]|=(255&r.charCodeAt(n/8))<<n%32;return t}function s(r){var n,t,e="0123456789abcdef",a="";for(t=0;t<r.length;t+=1)n=r.charCodeAt(t),a+=e.charAt(n>>>4&15)+e.charAt(15&n);return a}function c(r){return unescape(encodeURIComponent(r))}function m(r){return l(i(f(n=c(r)),8*n.length));var n}function h(r,n){return function(r,n){var t,e,a=f(r),u=[],o=[];for(u[15]=o[15]=void 0,a.length>16&&(a=i(a,8*r.length)),t=0;t<16;t+=1)u[t]=909522486^a[t],o[t]=1549556828^a[t];return e=i(u.concat(f(n)),512+8*n.length),l(i(o.concat(e),640))}(c(r),c(n))}function p(r,n,t){return n?t?h(n,r):s(h(n,r)):t?m(r):s(m(r))}"function"==typeof define&&define.amd?define(function(){return p}):r.md5=p}(this),this.j$=this.jStat=function(r,n){var t=Array.prototype.concat,e=Array.prototype.slice,a=Object.prototype.toString;function u(n,t){var e=n>t?n:t;return r.pow(10,17-~~(r.log(e>0?e:-e)*r.LOG10E))}var o=Array.isArray||function(r){return"[object Array]"===a.call(r)};function i(r){return"[object Function]"===a.call(r)}function l(r){return"number"==typeof r&&r==r}function f(){return new f._init(arguments)}function s(){return 0}function c(){return 1}function m(r,n){return r===n?1:0}f.fn=f.prototype,f._init=function(r){var n;if(o(r[0]))if(o(r[0][0])){for(i(r[1])&&(r[0]=f.map(r[0],r[1])),n=0;n<r[0].length;n++)this[n]=r[0][n];this.length=r[0].length}else this[0]=i(r[1])?f.map(r[0],r[1]):r[0],this.length=1;else if(l(r[0]))this[0]=f.seq.apply(null,r),this.length=1;else{if(r[0]instanceof f)return f(r[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:u,isArray:o,isFunction:i,isNumber:l,toVector:function(r){return t.apply([],r)}},f.extend=function(r){var n,t;if(1===arguments.length){for(t in r)f[t]=r[t];return this}for(n=1;n<arguments.length;n++)for(t in arguments[n])r[t]=arguments[n][t];return r},f.rows=function(r){return r.length||1},f.cols=function(r){return r[0].length||1},f.dimensions=function(r){return{rows:f.rows(r),cols:f.cols(r)}},f.row=function(r,n){return r[n]},f.col=function(r,n){for(var t=new Array(r.length),e=0;e<r.length;e++)t[e]=[r[e][n]];return t},f.diag=function(r){for(var n=f.rows(r),t=new Array(n),e=0;e<n;e++)t[e]=[r[e][e]];return t},f.antidiag=function(r){for(var n=f.rows(r)-1,t=new Array(n),e=0;n>=0;n--,e++)t[e]=[r[e][n]];return t},f.transpose=function(r){var n,t,e,a,u,i=[];for(o(r[0])||(r=[r]),t=r.length,e=r[0].length,u=0;u<e;u++){for(n=new Array(t),a=0;a<t;a++)n[a]=r[a][u];i.push(n)}return 1===i.length?i[0]:i},f.map=function(r,n,t){var e,a,u,i,l;for(o(r[0])||(r=[r]),a=r.length,u=r[0].length,i=t?r:new Array(a),e=0;e<a;e++)for(i[e]||(i[e]=new Array(u)),l=0;l<u;l++)i[e][l]=n(r[e][l],e,l);return 1===i.length?i[0]:i},f.alter=function(r,n){return f.map(r,n,!0)},f.create=function(r,n,t){var e,a,u=new Array(r);for(i(n)&&(t=n,n=r),e=0;e<r;e++)for(u[e]=new Array(n),a=0;a<n;a++)u[e][a]=t(e,a);return u},f.zeros=function(r,n){return l(n)||(n=r),f.create(r,n,s)},f.ones=function(r,n){return l(n)||(n=r),f.create(r,n,c)},f.rand=function(n,t){return l(t)||(t=n),f.create(n,t,r.random)},f.identity=function(r,n){return l(n)||(n=r),f.create(r,n,m)},f.symmetric=function(r){var n,t,e=r.length;if(r.length!==r[0].length)return!1;for(n=0;n<e;n++)for(t=0;t<e;t++)if(r[t][n]!==r[n][t])return!1;return!0},f.clear=function(r){return f.alter(r,s)},f.seq=function(r,n,t,e){i(e)||(e=!1);var a,o=[],l=u(r,n),f=(n*l-r*l)/((t-1)*l),s=r;for(a=0;s<=n;s=(r*l+f*l*++a)/l)o.push(e?e(s,a):s);return o};var h=f.prototype;return h.length=0,h.push=Array.prototype.push,h.sort=Array.prototype.sort,h.splice=Array.prototype.splice,h.slice=Array.prototype.slice,h.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},h.map=function(r,n){return f(f.map(this,r,n))},h.alter=function(r){return f.alter(this,r),this},function(r){for(var n=0;n<r.length;n++)!function(r){h[r]=function(n){var t,e=this;return n?(setTimeout(function(){n.call(e,h[r].call(e))}),this):(t=f[r](this),o(t)?f(t):t)}}(r[n])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){h[r]=function(n,t){var e=this;return t?(setTimeout(function(){t.call(e,h[r].call(e,n))}),this):f(f[r](this,n))}}(r[n])}("row col".split(" ")),function(r){for(var n=0;n<r.length;n++)t=r[n],h[t]=new Function("return jStat(jStat."+t+".apply(null, arguments));");var t}("create zeros ones rand identity".split(" ")),f}(Math),function(r,n){var t=r.utils.isFunction;function e(r,n){return r-n}function a(r,t,e){return n.max(t,n.min(r,e))}r.sum=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t];return n},r.sumsqrd=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t]*r[t];return n},r.sumsqerr=function(n){for(var t,e=r.mean(n),a=0,u=n.length;--u>=0;)a+=(t=n[u]-e)*t;return a},r.product=function(r){for(var n=1,t=r.length;--t>=0;)n*=r[t];return n},r.min=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]<n&&(n=r[t]);return n},r.max=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]>n&&(n=r[t]);return n},r.mean=function(n){return r.sum(n)/n.length},r.meansqerr=function(n){return r.sumsqerr(n)/n.length},r.geomean=function(t){return n.pow(r.product(t),1/t.length)},r.median=function(r){var n=r.length,t=r.slice().sort(e);return 1&n?t[n/2|0]:(t[n/2-1]+t[n/2])/2},r.cumsum=function(r){var n,t=r.length,e=new Array(t);for(e[0]=r[0],n=1;n<t;n++)e[n]=e[n-1]+r[n];return e},r.diff=function(r){var n,t=[],e=r.length;for(n=1;n<e;n++)t.push(r[n]-r[n-1]);return t},r.mode=function(r){var n,t=r.length,a=r.slice().sort(e),u=1,o=0,i=0,l=[];for(n=0;n<t;n++)a[n]===a[n+1]?u++:(u>o?(l=[a[n]],o=u,i=0):u===o&&(l.push(a[n]),i++),u=1);return 0===i?l[0]:l},r.range=function(n){return r.max(n)-r.min(n)},r.variance=function(n,t){return r.sumsqerr(n)/(n.length-(t?1:0))},r.stdev=function(t,e){return n.sqrt(r.variance(t,e))},r.meandev=function(t){var e,a=0,u=r.mean(t);for(e=t.length-1;e>=0;e--)a+=n.abs(t[e]-u);return a/t.length},r.meddev=function(t){var e,a=0,u=r.median(t);for(e=t.length-1;e>=0;e--)a+=n.abs(t[e]-u);return a/t.length},r.coeffvar=function(n){return r.stdev(n)/r.mean(n)},r.quartiles=function(r){var t=r.length,a=r.slice().sort(e);return[a[n.round(t/4)-1],a[n.round(t/2)-1],a[n.round(3*t/4)-1]]},r.quantiles=function(r,t,u,o){var i,l,f,s,c,m=r.slice().sort(e),h=[t.length],p=r.length;for(void 0===u&&(u=3/8),void 0===o&&(o=3/8),i=0;i<t.length;i++)c=a((f=p*(l=t[i])+(u+l*(1-u-o)))-(s=n.floor(a(f,1,p-1))),0,1),h[i]=(1-c)*m[s-1]+c*m[s];return h},r.percentileOfScore=function(r,n,t){var e,a,u=0,o=r.length,i=!1;for("strict"===t&&(i=!0),a=0;a<o;a++)e=r[a],(i&&e<n||!i&&e<=n)&&u++;return u/o},r.covariance=function(n,t){var e,a=r.mean(n),u=r.mean(t),o=n.length,i=new Array(o);for(e=0;e<o;e++)i[e]=(n[e]-a)*(t[e]-u);return r.sum(i)/(o-1)},r.corrcoeff=function(n,t){return r.covariance(n,t)/r.stdev(n,1)/r.stdev(t,1)};var u=r.prototype;u.cumsum=function(n,e){var a=[],o=0,i=this;if(t(n)&&(e=n,n=!1),e)return setTimeout(function(){e.call(i,u.cumsum.call(i,n))}),this;if(this.length>1){for(i=!0===n?this:this.transpose();o<i.length;o++)a[o]=r.cumsum(i[o]);return a}return r.cumsum(this[0],n)},function(n){for(var e=0;e<n.length;e++)!function(n){u[n]=function(e,a){var o=[],i=0,l=this;if(t(e)&&(a=e,e=!1),a)return setTimeout(function(){a.call(l,u[n].call(l,e))}),this;if(this.length>1){for(l=!0===e?this:this.transpose();i<l.length;i++)o[i]=r[n](l[i]);return!0===e?r[n](r.utils.toVector(o)):o}return r[n](this[0],e)}}(n[e])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){u[n]=function(){var e=[],a=0,o=this,i=Array.prototype.slice.call(arguments);if(t(i[i.length-1])){var l=i[i.length-1],f=i.slice(0,i.length-1);return setTimeout(function(){l.call(o,u[n].apply(o,f))}),this}l=void 0;var s=function(t){return r[n].apply(o,[t].concat(i))};if(this.length>1){for(o=o.transpose();a<o.length;a++)e[a]=s(o[a]);return e}return s(this[0])}}(n[e])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(r,n){r.gammaln=function(r){var t,e,a,u=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(a=(e=t=r)+5.5,a-=(t+.5)*n.log(a);u<6;u++)i+=o[u]/++e;return n.log(2.5066282746310007*i/t)-a},r.gammafn=function(r){var t,e,a,u,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,f=0,s=0,c=0,m=r;if(m<=0){if(!(u=m%1+3.6e-16))return 1/0;l=(1&m?-1:1)*n.PI/n.sin(n.PI*u),m=1-m}for(a=m,e=m<1?m++:(m-=f=(0|m)-1)-1,t=0;t<8;++t)c=(c+o[t])*e,s=s*e+i[t];if(u=c/s+1,a<m)u/=a;else if(a>m)for(t=0;t<f;++t)u*=m,m++;return l&&(u=l/u),u},r.gammap=function(t,e){var a,u=r.gammaln(t),o=t,i=1/t,l=i,f=e+1-t,s=1/1e-30,c=1/f,m=c,h=1,p=-~(8.5*n.log(t>=1?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;h<=p;h++)i+=l*=e/++o;return i*n.exp(-e+t*n.log(e)-u)}for(;h<=p;h++)m*=(c=1/(c=(a=-h*(h-t))*c+(f+=2)))*(s=f+a/s);return 1-m*n.exp(-e+t*n.log(e)-u)},r.factorialln=function(n){return n<0?NaN:r.gammaln(n+1)},r.factorial=function(n){return n<0?NaN:r.gammafn(n+1)},r.combination=function(t,e){return t>170||e>170?n.exp(r.combinationln(t,e)):r.factorial(t)/r.factorial(e)/r.factorial(t-e)},r.combinationln=function(n,t){return r.factorialln(n)-r.factorialln(t)-r.factorialln(n-t)},r.permutation=function(n,t){return r.factorial(n)/r.factorial(n-t)},r.betafn=function(t,e){if(!(t<=0||e<=0))return t+e>170?n.exp(r.betaln(t,e)):r.gammafn(t)*r.gammafn(e)/r.gammafn(t+e)},r.betaln=function(n,t){return r.gammaln(n)+r.gammaln(t)-r.gammaln(n+t)},r.betacf=function(r,t,e){var a,u,o,i,l=1e-30,f=1,s=t+e,c=t+1,m=t-1,h=1,p=1-s*r/c;for(n.abs(p)<l&&(p=l),i=p=1/p;f<=100&&(p=1+(u=f*(e-f)*r/((m+(a=2*f))*(t+a)))*p,n.abs(p)<l&&(p=l),h=1+u/h,n.abs(h)<l&&(h=l),i*=(p=1/p)*h,p=1+(u=-(t+f)*(s+f)*r/((t+a)*(c+a)))*p,n.abs(p)<l&&(p=l),h=1+u/h,n.abs(h)<l&&(h=l),i*=o=(p=1/p)*h,!(n.abs(o-1)<3e-7));f++);return i},r.gammapinv=function(t,e){var a,u,o,i,l,f,s=0,c=e-1,m=r.gammaln(e);if(t>=1)return n.max(100,e+100*n.sqrt(e));if(t<=0)return 0;for(e>1?(l=n.log(c),f=n.exp(c*(l-1)-m),i=t<.5?t:1-t,a=(2.30753+.27061*(u=n.sqrt(-2*n.log(i))))/(1+u*(.99229+.04481*u))-u,t<.5&&(a=-a),a=n.max(.001,e*n.pow(1-1/(9*e)-a/(3*n.sqrt(e)),3))):a=t<(u=1-e*(.253+.12*e))?n.pow(t/u,1/e):1-n.log(1-(t-u)/(1-u));s<12;s++){if(a<=0)return 0;if((a-=u=(o=(r.gammap(e,a)-t)/(u=e>1?f*n.exp(-(a-c)+c*(n.log(a)-l)):n.exp(-a+c*n.log(a)-m)))/(1-.5*n.min(1,o*((e-1)/a-1))))<=0&&(a=.5*(a+u)),n.abs(u)<1e-8*a)break}return a},r.erf=function(r){var t,e,a,u,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],i=o.length-1,l=!1,f=0,s=0;for(r<0&&(r=-r,l=!0),e=4*(t=2/(2+r))-2;i>0;i--)a=f,f=e*f-s+o[i],s=a;return u=t*n.exp(-r*r+.5*(o[0]+e*f)-s),l?u-1:1-u},r.erfc=function(n){return 1-r.erf(n)},r.erfcinv=function(t){var e,a,u,o,i=0;if(t>=2)return-100;if(t<=0)return 100;for(o=t<1?t:2-t,e=-.70711*((2.30753+.27061*(u=n.sqrt(-2*n.log(o/2))))/(1+u*(.99229+.04481*u))-u);i<2;i++)e+=(a=r.erfc(e)-o)/(1.1283791670955126*n.exp(-e*e)-e*a);return t<1?e:-e},r.ibetainv=function(t,e,a){var u,o,i,l,f,s,c,m,h,p,d=e-1,g=a-1,v=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&a>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(l=n.sqrt(-2*n.log(i))))/(1+l*(.99229+.04481*l))-l,t<.5&&(s=-s),c=(s*s-3)/6,m=2/(1/(2*e-1)+1/(2*a-1)),h=s*n.sqrt(c+m)/m-(1/(2*a-1)-1/(2*e-1))*(c+5/6-2/(3*m)),s=e/(e+a*n.exp(2*h))):(u=n.log(e/(e+a)),o=n.log(a/(e+a)),s=t<(l=n.exp(e*u)/e)/(h=l+(f=n.exp(a*o)/a))?n.pow(e*h*t,1/e):1-n.pow(a*h*(1-t),1/a)),p=-r.gammaln(e)-r.gammaln(a)+r.gammaln(e+a);v<10;v++){if(0===s||1===s)return s;if((s-=l=(f=(r.ibeta(s,e,a)-t)/(l=n.exp(d*n.log(s)+g*n.log(1-s)+p)))/(1-.5*n.min(1,f*(d/s-g/(1-s)))))<=0&&(s=.5*(s+l)),s>=1&&(s=.5*(s+l+1)),n.abs(l)<1e-8*s&&v>0)break}return s},r.ibeta=function(t,e,a){var u=0===t||1===t?0:n.exp(r.gammaln(e+a)-r.gammaln(e)-r.gammaln(a)+e*n.log(t)+a*n.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+a+2)?u*r.betacf(t,e,a)/e:1-u*r.betacf(1-t,a,e)/a)},r.randn=function(t,e){var a,u,o,i,l;if(e||(e=t),t)return r.create(t,e,function(){return r.randn()});do{a=n.random(),u=1.7156*(n.random()-.5),l=(o=a-.449871)*o+(i=n.abs(u)+.386595)*(.196*i-.25472*o)}while(l>.27597&&(l>.27846||u*u>-4*n.log(a)*a*a));return u/a},r.randg=function(t,e,a){var u,o,i,l,f,s,c=t;if(a||(a=e),t||(t=1),e)return(s=r.zeros(e,a)).alter(function(){return r.randg(t)}),s;t<1&&(t+=1),u=t-1/3,o=1/n.sqrt(9*u);do{do{l=1+o*(f=r.randn())}while(l<=0);l*=l*l,i=n.random()}while(i>1-.331*n.pow(f,4)&&n.log(i)>.5*f*f+u*(1-l+n.log(l)));if(t==c)return u*l;do{i=n.random()}while(0===i);return n.pow(i,1/c)*u*l},function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(){return r(r.map(this,function(t){return r[n](t)}))}}(n[t])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(){return r(r[n].apply(null,arguments))}}(n[t])}("randn".split(" "))}(this.jStat,Math),function(r,n){!function(n){for(var t=0;t<n.length;t++)!function(n){r[n]=function(r,n,t){return this instanceof arguments.callee?(this._a=r,this._b=n,this._c=t,this):new arguments.callee(r,n,t)},r.fn[n]=function(t,e,a){var u=r[n](t,e,a);return u.data=this,u},r[n].prototype.sample=function(t){var e=this._a,a=this._b,u=this._c;return t?r.alter(t,function(){return r[n].sample(e,a,u)}):r[n].sample(e,a,u)},function(t){for(var e=0;e<t.length;e++)!function(t){r[n].prototype[t]=function(e){var a=this._a,u=this._b,o=this._c;return e||0===e||(e=this.data),"number"!=typeof e?r.fn.map.call(e,function(e){return r[n][t](e,a,u,o)}):r[n][t](e,a,u,o)}}(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){r[n].prototype[t]=function(){return r[n][t](this._a,this._b,this._c)}}(t[e])}("mean median mode variance".split(" "))}(n[t])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),r.extend(r.beta,{pdf:function(t,e,a){return t>1||t<0?0:1==e&&1==a?1:e<512||a<512?n.pow(t,e-1)*n.pow(1-t,a-1)/r.betafn(e,a):n.exp((e-1)*n.log(t)+(a-1)*n.log(1-t)-r.betaln(e,a))},cdf:function(n,t,e){return n>1||n<0?1*(n>1):r.ibeta(n,t,e)},inv:function(n,t,e){return r.ibetainv(n,t,e)},mean:function(r,n){return r/(r+n)},median:function(r,n){throw new Error("median not yet implemented")},mode:function(r,t){return r*t/(n.pow(r+t,2)*(r+t+1))},sample:function(n,t){var e=r.randg(n);return e/(e+r.randg(t))},variance:function(r,t){return r*t/(n.pow(r+t,2)*(r+t+1))}}),r.extend(r.centralF,{pdf:function(t,e,a){if(!(t<0))return n.sqrt(n.pow(e*t,e)*n.pow(a,a)/n.pow(e*t+a,e+a))/(t*r.betafn(e/2,a/2))},cdf:function(n,t,e){return r.ibeta(t*n/(t*n+e),t/2,e/2)},inv:function(n,t,e){return e/(t*(1/r.ibetainv(n,t/2,e/2)-1))},mean:function(r,n){return n>2?n/(n-2):void 0},mode:function(r,n){return r>2?n*(r-2)/(r*(n+2)):void 0},sample:function(n,t){return 2*r.randg(n/2)/n/(2*r.randg(t/2)/t)},variance:function(r,n){if(!(n<=4))return 2*n*n*(r+n-2)/(r*(n-2)*(n-2)*(n-4))}}),r.extend(r.cauchy,{pdf:function(r,t,e){return e/(n.pow(r-t,2)+n.pow(e,2))/n.PI},cdf:function(r,t,e){return n.atan((r-t)/e)/n.PI+.5},inv:function(r,t,e){return t+e*n.tan(n.PI*(r-.5))},median:function(r,n){return r},mode:function(r,n){return r},sample:function(t,e){return r.randn()*n.sqrt(1/(2*r.randg(.5)))*e+t}}),r.extend(r.chisquare,{pdf:function(t,e){return n.exp((e/2-1)*n.log(t)-t/2-e/2*n.log(2)-r.gammaln(e/2))},cdf:function(n,t){return r.gammap(t/2,n/2)},inv:function(n,t){return 2*r.gammapinv(n,.5*t)},mean:function(r){return r},median:function(r){return r*n.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(n){return 2*r.randg(n/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,t){return r<0?0:t*n.exp(-t*r)},cdf:function(r,t){return r<0?0:1-n.exp(-t*r)},inv:function(r,t){return-n.log(1-r)/t},mean:function(r){return 1/r},median:function(r){return 1/r*n.log(2)},mode:function(r){return 0},sample:function(r){return-1/r*n.log(n.random())},variance:function(r){return n.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(t,e,a){return n.exp((e-1)*n.log(t)-t/a-r.gammaln(e)-e*n.log(a))},cdf:function(n,t,e){return r.gammap(t,n/e)},inv:function(n,t,e){return r.gammapinv(n,t)*e},mean:function(r,n){return r*n},mode:function(r,n){if(r>1)return(r-1)*n},sample:function(n,t){return r.randg(n)*t},variance:function(r,n){return r*n*n}}),r.extend(r.invgamma,{pdf:function(t,e,a){return n.exp(-(e+1)*n.log(t)-a/t-r.gammaln(e)+e*n.log(a))},cdf:function(n,t,e){return 1-r.gammap(t,e/n)},inv:function(n,t,e){return e/r.gammapinv(1-n,t)},mean:function(r,n){return r>1?n/(r-1):void 0},mode:function(r,n){return n/(r+1)},sample:function(n,t){return t/r.randg(n)},variance:function(r,n){if(!(r<=2))return n*n/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,t,e){return n.exp(n.log(t)+n.log(e)+(t-1)*n.log(r)+(e-1)*n.log(1-n.pow(r,t)))},cdf:function(r,t,e){return 1-n.pow(1-n.pow(r,t),e)},mean:function(n,t){return t*r.gammafn(1+1/n)*r.gammafn(t)/r.gammafn(1+1/n+t)},median:function(r,t){return n.pow(1-n.pow(2,-1/t),1/r)},mode:function(r,t){if(r>=1&&t>=1&&1!==r&&1!==t)return n.pow((r-1)/(r*t-1),1/r)},variance:function(r,n){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,t,e){return n.exp(-n.log(r)-.5*n.log(2*n.PI)-n.log(e)-n.pow(n.log(r)-t,2)/(2*e*e))},cdf:function(t,e,a){return.5+.5*r.erf((n.log(t)-e)/n.sqrt(2*a*a))},inv:function(t,e,a){return n.exp(-1.4142135623730951*a*r.erfcinv(2*t)+e)},mean:function(r,t){return n.exp(r+t*t/2)},median:function(r,t){return n.exp(r)},mode:function(r,t){return n.exp(r-t*t)},sample:function(t,e){return n.exp(r.randn()*e+t)},variance:function(r,t){return(n.exp(t*t)-1)*n.exp(2*r+t*t)}}),r.extend(r.normal,{pdf:function(r,t,e){return n.exp(-.5*n.log(2*n.PI)-n.log(e)-n.pow(r-t,2)/(2*e*e))},cdf:function(t,e,a){return.5*(1+r.erf((t-e)/n.sqrt(2*a*a)))},inv:function(n,t,e){return-1.4142135623730951*e*r.erfcinv(2*n)+t},mean:function(r,n){return r},median:function(r,n){return r},mode:function(r,n){return r},sample:function(n,t){return r.randn()*t+n},variance:function(r,n){return n*n}}),r.extend(r.pareto,{pdf:function(r,t,e){if(!(r<=t))return e*n.pow(t,e)/n.pow(r,e+1)},cdf:function(r,t,e){return 1-n.pow(t/r,e)},mean:function(r,t){if(!(t<=1))return t*n.pow(r,t)/(t-1)},median:function(r,t){return r*(t*n.SQRT2)},mode:function(r,n){return r},variance:function(r,t){if(!(t<=2))return r*r*t/(n.pow(t-1,2)*(t-2))}}),r.extend(r.studentt,{pdf:function(t,e){return r.gammafn((e+1)/2)/(n.sqrt(e*n.PI)*r.gammafn(e/2))*n.pow(1+t*t/e,-(e+1)/2)},cdf:function(t,e){var a=e/2;return r.ibeta((t+n.sqrt(t*t+e))/(2*n.sqrt(t*t+e)),a,a)},inv:function(t,e){var a=r.ibetainv(2*n.min(t,1-t),.5*e,.5);return a=n.sqrt(e*(1-a)/a),t>0?a:-a},mean:function(r){return r>1?0:void 0},median:function(r){return 0},mode:function(r){return 0},sample:function(t){return r.randn()*n.sqrt(t/(2*r.randg(t/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,t,e){return r<0?0:e/t*n.pow(r/t,e-1)*n.exp(-n.pow(r/t,e))},cdf:function(r,t,e){return r<0?0:1-n.exp(-n.pow(r/t,e))},inv:function(r,t,e){return t*n.pow(-n.log(1-r),1/e)},mean:function(n,t){return n*r.gammafn(1+1/t)},median:function(r,t){return r*n.pow(n.log(2),1/t)},mode:function(r,t){if(!(t<=1))return r*n.pow((t-1)/t,1/t)},sample:function(r,t){return r*n.pow(-n.log(n.random()),1/t)},variance:function(t,e){return t*t*r.gammafn(1+2/e)-n.pow(this.mean(t,e),2)}}),r.extend(r.uniform,{pdf:function(r,n,t){return r<n||r>t?0:1/(t-n)},cdf:function(r,n,t){return r<n?0:r<t?(r-n)/(t-n):1},mean:function(r,n){return.5*(r+n)},median:function(n,t){return r.mean(n,t)},mode:function(r,n){throw new Error("mode is not yet implemented")},sample:function(r,t){return r/2+t/2+(t/2-r/2)*(2*n.random()-1)},variance:function(r,t){return n.pow(t-r,2)/12}}),r.extend(r.binomial,{pdf:function(t,e,a){return 0===a||1===a?e*a===t?1:0:r.combination(e,t)*n.pow(a,t)*n.pow(1-a,e-t)},cdf:function(n,t,e){var a=[],u=0;if(n<0)return 0;if(n<t){for(;u<=n;u++)a[u]=r.binomial.pdf(u,t,e);return r.sum(a)}return 1}}),r.extend(r.negbin,{pdf:function(t,e,a){return!(t!=t|0)&&(t<0?0:r.combination(t+e-1,e-1)*n.pow(1-a,t)*n.pow(a,e))},cdf:function(n,t,e){var a=0,u=0;if(n<0)return 0;for(;u<=n;u++)a+=r.negbin.pdf(u,t,e);return a}}),r.extend(r.hypgeom,{pdf:function(t,e,a,u){if(t!=t|0)return!1;if(t<0||t<a-(e-u))return 0;if(t>u||t>a)return 0;if(2*a>e)return 2*u>e?r.hypgeom.pdf(e-a-u+t,e,e-a,e-u):r.hypgeom.pdf(u-t,e,e-a,u);if(2*u>e)return r.hypgeom.pdf(a-t,e,a,e-u);if(a<u)return r.hypgeom.pdf(t,e,u,a);for(var o=1,i=0,l=0;l<t;l++){for(;o>1&&i<u;)o*=1-a/(e-i),i++;o*=(u-l)*(a-l)/((l+1)*(e-a-u+l+1))}for(;i<u;i++)o*=1-a/(e-i);return n.min(1,n.max(0,o))},cdf:function(t,e,a,u){if(t<0||t<a-(e-u))return 0;if(t>=u||t>=a)return 1;if(2*a>e)return 2*u>e?r.hypgeom.cdf(e-a-u+t,e,e-a,e-u):1-r.hypgeom.cdf(u-t-1,e,e-a,u);if(2*u>e)return 1-r.hypgeom.cdf(a-t-1,e,a,e-u);if(a<u)return r.hypgeom.cdf(t,e,u,a);for(var o=1,i=1,l=0,f=0;f<t;f++){for(;o>1&&l<u;){var s=1-a/(e-l);i*=s,o*=s,l++}o+=i*=(u-f)*(a-f)/((f+1)*(e-a-u+f+1))}for(;l<u;l++)o*=1-a/(e-l);return n.min(1,n.max(0,o))}}),r.extend(r.poisson,{pdf:function(t,e){return n.pow(e,t)*n.exp(-e)/r.factorial(t)},cdf:function(n,t){var e=[],a=0;if(n<0)return 0;for(;a<=n;a++)e.push(r.poisson.pdf(a,t));return r.sum(e)},mean:function(r){return r},variance:function(r){return r},sample:function(r){var t=1,e=0,a=n.exp(-r);do{e++,t*=n.random()}while(t>a);return e-1}}),r.extend(r.triangular,{pdf:function(r,n,t,e){return t<=n||e<n||e>t?void 0:r<n||r>t?0:r<=e?2*(r-n)/((t-n)*(e-n)):2*(t-r)/((t-n)*(t-e))},cdf:function(r,t,e,a){if(!(e<=t||a<t||a>e))return r<t?0:r<=a?n.pow(r-t,2)/((e-t)*(a-t)):1-n.pow(e-r,2)/((e-t)*(e-a))},mean:function(r,n,t){return(r+n+t)/3},median:function(r,t,e){return e<=(r+t)/2?t-n.sqrt((t-r)*(t-e))/n.sqrt(2):e>(r+t)/2?r+n.sqrt((t-r)*(e-r))/n.sqrt(2):void 0},mode:function(r,n,t){return t},sample:function(r,t,e){var a=n.random();return a<(e-r)/(t-r)?r+n.sqrt(a*(t-r)*(e-r)):t-n.sqrt((1-a)*(t-r)*(t-e))},variance:function(r,n,t){return(r*r+n*n+t*t-r*n-r*t-n*t)/18}})}(this.jStat,Math),function(r,n){var t=Array.prototype.push,e=r.utils.isArray;r.extend({add:function(n,t){return e(t)?(e(t[0])||(t=[t]),r.map(n,function(r,n,e){return r+t[n][e]})):r.map(n,function(r){return r+t})},subtract:function(n,t){return e(t)?(e(t[0])||(t=[t]),r.map(n,function(r,n,e){return r-t[n][e]||0})):r.map(n,function(r){return r-t})},divide:function(n,t){return e(t)?(e(t[0])||(t=[t]),r.multiply(n,r.inv(t))):r.map(n,function(r){return r/t})},multiply:function(n,t){var a,u,o,i,l=n.length,f=n[0].length,s=r.zeros(l,o=e(t)?t[0].length:f),c=0;if(e(t)){for(;c<o;c++)for(a=0;a<l;a++){for(i=0,u=0;u<f;u++)i+=n[a][u]*t[u][c];s[a][c]=i}return 1===l&&1===c?s[0][0]:s}return r.map(n,function(r){return r*t})},dot:function(n,t){e(n[0])||(n=[n]),e(t[0])||(t=[t]);for(var a,u,o=1===n[0].length&&1!==n.length?r.transpose(n):n,i=1===t[0].length&&1!==t.length?r.transpose(t):t,l=[],f=0,s=o.length,c=o[0].length;f<s;f++){for(l[f]=[],a=0,u=0;u<c;u++)a+=o[f][u]*i[f][u];l[f]=a}return 1===l.length?l[0]:l},pow:function(t,e){return r.map(t,function(r){return n.pow(r,e)})},abs:function(t){return r.map(t,function(r){return n.abs(r)})},norm:function(r,t){var a=0,u=0;for(isNaN(t)&&(t=2),e(r[0])&&(r=r[0]);u<r.length;u++)a+=n.pow(n.abs(r[u]),t);return n.pow(a,1/t)},angle:function(t,e){return n.acos(r.dot(t,e)/(r.norm(t)*r.norm(e)))},aug:function(r,n){for(var e=r.slice(),a=0;a<e.length;a++)t.apply(e[a],n[a]);return e},inv:function(n){for(var t,e=n.length,a=n[0].length,u=r.identity(e,a),o=r.gauss_jordan(n,u),i=[],l=0;l<e;l++)for(i[l]=[],t=a-1;t<o[0].length;t++)i[l][t-a]=o[l][t];return i},det:function(r){var n,t=r.length,e=2*t,a=new Array(e),u=t-1,o=e-1,i=u-t+1,l=o,f=0,s=0;if(2===t)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(;f<e;f++)a[f]=1;for(f=0;f<t;f++){for(n=0;n<t;n++)a[i<0?i+t:i]*=r[f][n],a[l<t?l+t:l]*=r[f][n],i++,l--;i=--u-t+1,l=--o}for(f=0;f<t;f++)s+=a[f];for(;f<e;f++)s-=a[f];return s},gauss_elimination:function(t,e){var a,u,o,i,l=0,f=0,s=t.length,c=t[0].length,m=1,h=0,p=[];for(a=(t=r.aug(t,e))[0].length;l<s;l++){for(u=t[l][l],f=l,i=l+1;i<c;i++)u<n.abs(t[i][l])&&(u=t[i][l],f=i);if(f!=l)for(i=0;i<a;i++)o=t[l][i],t[l][i]=t[f][i],t[f][i]=o;for(f=l+1;f<s;f++)for(m=t[f][l]/t[l][l],i=l;i<a;i++)t[f][i]=t[f][i]-m*t[l][i]}for(l=s-1;l>=0;l--){for(h=0,f=l+1;f<=s-1;f++)h=p[f]*t[l][f];p[l]=(t[l][a-1]-h)/t[l][l]}return p},gauss_jordan:function(t,e){for(var a=r.aug(t,e),u=a.length,o=a[0].length,i=0;i<u;i++){for(var l=i,f=i+1;f<u;f++)n.abs(a[f][i])>n.abs(a[l][i])&&(l=f);var s=a[i];a[i]=a[l],a[l]=s;for(f=i+1;f<u;f++){c=a[f][i]/a[i][i];for(var m=i;m<o;m++)a[f][m]-=a[i][m]*c}}for(i=u-1;i>=0;i--){c=a[i][i];for(f=0;f<i;f++)for(m=o-1;m>i-1;m--)a[f][m]-=a[i][m]*a[f][i]/c;a[i][i]/=c;for(m=u;m<o;m++)a[i][m]/=c}return a},lu:function(r,n){throw new Error("lu not yet implemented")},cholesky:function(r,n){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(t,e,a,u){for(var o,i,l,f,s=0,c=0,m=t.length,h=[],p=[],d=[];s<m;s++)for(h[s]=[],p[s]=[],d[s]=[],c=0;c<m;c++)s>c?(h[s][c]=t[s][c],p[s][c]=d[s][c]=0):s<c?(p[s][c]=t[s][c],h[s][c]=d[s][c]=0):(d[s][c]=t[s][c],h[s][c]=p[s][c]=0);for(l=r.multiply(r.multiply(r.inv(d),r.add(h,p)),-1),i=r.multiply(r.inv(d),e),o=a,f=r.add(r.multiply(l,a),i),s=2;n.abs(r.norm(r.subtract(f,o)))>u;)o=f,f=r.add(r.multiply(l,o),i),s++;return f},gauss_seidel:function(t,e,a,u){for(var o,i,l,f,s,c=0,m=t.length,h=[],p=[],d=[];c<m;c++)for(h[c]=[],p[c]=[],d[c]=[],o=0;o<m;o++)c>o?(h[c][o]=t[c][o],p[c][o]=d[c][o]=0):c<o?(p[c][o]=t[c][o],h[c][o]=d[c][o]=0):(d[c][o]=t[c][o],h[c][o]=p[c][o]=0);for(f=r.multiply(r.multiply(r.inv(r.add(d,h)),p),-1),l=r.multiply(r.inv(r.add(d,h)),e),i=a,s=r.add(r.multiply(f,a),l),c=2;n.abs(r.norm(r.subtract(s,i)))>u;)i=s,s=r.add(r.multiply(f,i),l),c+=1;return s},SOR:function(t,e,a,u,o){for(var i,l,f,s,c,m=0,h=t.length,p=[],d=[],g=[];m<h;m++)for(p[m]=[],d[m]=[],g[m]=[],i=0;i<h;i++)m>i?(p[m][i]=t[m][i],d[m][i]=g[m][i]=0):m<i?(d[m][i]=t[m][i],p[m][i]=g[m][i]=0):(g[m][i]=t[m][i],p[m][i]=d[m][i]=0);for(s=r.multiply(r.inv(r.add(g,r.multiply(p,o))),r.subtract(r.multiply(g,1-o),r.multiply(d,o))),f=r.multiply(r.multiply(r.inv(r.add(g,r.multiply(p,o))),e),o),l=a,c=r.add(r.multiply(s,a),f),m=2;n.abs(r.norm(r.subtract(c,l)))>u;)l=c,c=r.add(r.multiply(s,l),f),m++;return c},householder:function(t){for(var e,a,u,o,i=t.length,l=t[0].length,f=0,s=[],c=[];f<i-1;f++){for(e=0,o=f+1;o<l;o++)e+=t[o][f]*t[o][f];for(e=(t[f+1][f]>0?-1:1)*n.sqrt(e),a=n.sqrt((e*e-t[f+1][f]*e)/2),(s=r.zeros(i,1))[f+1][0]=(t[f+1][f]-e)/(2*a),u=f+2;u<i;u++)s[u][0]=t[u][f]/(2*a);c=r.subtract(r.identity(i,l),r.multiply(r.multiply(s,r.transpose(s)),2)),t=r.multiply(c,r.multiply(t,c))}return t},QR:function(t,e){for(var a,u,o,i,l=t.length,f=t[0].length,s=0,c=[],m=[],h=[];s<l-1;s++){for(u=0,a=s+1;a<f;a++)u+=t[a][s]*t[a][s];for(u=(t[s+1][s]>0?-1:1)*n.sqrt(u),o=n.sqrt((u*u-t[s+1][s]*u)/2),(c=r.zeros(l,1))[s+1][0]=(t[s+1][s]-u)/(2*o),i=s+2;i<l;i++)c[i][0]=t[i][s]/(2*o);m=r.subtract(r.identity(l,f),r.multiply(r.multiply(c,r.transpose(c)),2)),t=r.multiply(m,t),e=r.multiply(m,e)}for(s=l-1;s>=0;s--){for(0,a=s+1;a<=f-1;a++)h[a]*t[s][a];h[s]=e[s][0]/t[s][s]}return h},jacobi:function(t){for(var e,a,u,o,i,l,f,s=1,c=t.length,m=r.identity(c,c),h=[];1===s;){for(0,i=t[0][1],u=0,o=1,e=0;e<c;e++)for(a=0;a<c;a++)e!=a&&i<n.abs(t[e][a])&&(i=n.abs(t[e][a]),u=e,o=a);for(l=t[u][u]===t[o][o]?t[u][o]>0?n.PI/4:-n.PI/4:n.atan(2*t[u][o]/(t[u][u]-t[o][o]))/2,(f=r.identity(c,c))[u][u]=n.cos(l),f[u][o]=-n.sin(l),f[o][u]=n.sin(l),f[o][o]=n.cos(l),m=r.multiply(m,f),t=r.multiply(r.multiply(r.inv(f),t),f),s=0,e=1;e<c;e++)for(a=1;a<c;a++)e!=a&&n.abs(t[e][a])>.001&&(s=1)}for(e=0;e<c;e++)h.push(t[e][e]);return[m,h]},rungekutta:function(r,n,t,e,a,u){var o,i,l;if(2===u)for(;e<=t;)a=a+((o=n*r(e,a))+(i=n*r(e+n,a+o)))/2,e+=n;if(4===u)for(;e<=t;)a=a+((o=n*r(e,a))+2*(i=n*r(e+n/2,a+o/2))+2*(l=n*r(e+n/2,a+i/2))+n*r(e+n,a+l))/6,e+=n;return a},romberg:function(r,t,e,a){for(var u,o,i,l,f,s=0,c=(e-t)/2,m=[],h=[],p=[];s<a/2;){for(f=r(t),i=t,l=0;i<=e;i+=c,l++)m[l]=i;for(u=m.length,i=1;i<u-1;i++)f+=(i%2!=0?4:2)*r(m[i]);f=c/3*(f+r(e)),p[s]=f,c/=2,s++}for(o=p.length,u=1;1!==o;){for(i=0;i<o-1;i++)h[i]=(n.pow(4,u)*p[i+1]-p[i])/(n.pow(4,u)-1);o=h.length,p=h,h=[],u++}return p},richardson:function(r,t,e,a){function u(r,n){for(var t,e=0,a=r.length;e<a;e++)r[e]===n&&(t=e);return t}r.length;for(var o,i,l,f,s,c=n.abs(e-r[u(r,e)+1]),m=0,h=[],p=[];a>=c;)o=u(r,e+a),i=u(r,e),h[m]=(t[o]-2*t[i]+t[2*i-o])/(a*a),a/=2,m++;for(f=h.length,l=1;1!=f;){for(s=0;s<f-1;s++)p[s]=(n.pow(4,l)*h[s+1]-h[s])/(n.pow(4,l)-1);f=p.length,h=p,p=[],l++}return h},simpson:function(r,n,t,e){for(var a,u=(t-n)/e,o=r(n),i=[],l=n,f=0,s=1;l<=t;l+=u,f++)i[f]=l;for(a=i.length;s<a-1;s++)o+=(s%2!=0?4:2)*r(i[s]);return u/3*(o+r(t))},hermite:function(r,n,t,e){for(var a,u=r.length,o=0,i=0,l=[],f=[],s=[],c=[];i<u;i++){for(l[i]=1,a=0;a<u;a++)i!=a&&(l[i]*=(e-r[a])/(r[i]-r[a]));for(f[i]=0,a=0;a<u;a++)i!=a&&(f[i]+=1/(r[i]-r[a]));s[i]=(1-2*(e-r[i])*f[i])*(l[i]*l[i]),c[i]=(e-r[i])*(l[i]*l[i]),o+=s[i]*n[i]+c[i]*t[i]}return o},lagrange:function(r,n,t){for(var e,a,u=0,o=0,i=r.length;o<i;o++){for(a=n[o],e=0;e<i;e++)o!=e&&(a*=(t-r[e])/(r[o]-r[e]));u+=a}return u},cubic_spline:function(n,t,e){for(var a,u,o=n.length,i=0,l=[],f=[],s=[],c=[],m=[],h=[];i<o-1;i++)c[i]=n[i+1]-n[i];for(s[0]=0,i=1;i<o-1;i++)s[i]=3/c[i]*(t[i+1]-t[i])-3/c[i-1]*(t[i]-t[i-1]);for(i=1;i<o-1;i++)l[i]=[],f[i]=[],l[i][i-1]=c[i-1],l[i][i]=2*(c[i-1]+c[i]),l[i][i+1]=c[i],f[i][0]=s[i];for(u=r.multiply(r.inv(l),f),a=0;a<o-1;a++)m[a]=(t[a+1]-t[a])/c[a]-c[a]*(u[a+1][0]+2*u[a][0])/3,h[a]=(u[a+1][0]-u[a][0])/(3*c[a]);for(a=0;a<o&&!(n[a]>e);a++);return t[a-=1]+(e-n[a])*m[a]+r.sq(e-n[a])*u[a]+(e-n[a])*r.sq(e-n[a])*h[a]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){var t,e,a,u,o,i=n.length,l=n[0].length,f=0,s=[],c=[],m=[],h=[],p=[],d=[],g=[];for(f=0;f<i;f++)s[f]=r.sum(n[f])/l;for(f=0;f<l;f++)for(p[f]=[],t=0;t<i;t++)p[f][t]=n[t][f]-s[t];for(p=r.transpose(p),f=0;f<i;f++)for(d[f]=[],t=0;t<i;t++)d[f][t]=r.dot([p[f]],[p[t]])/(l-1);for(o=(a=r.jacobi(d))[0],c=a[1],g=r.transpose(o),f=0;f<c.length;f++)for(t=f;t<c.length;t++)c[f]<c[t]&&(e=c[f],c[f]=c[t],c[t]=e,m=g[f],g[f]=g[t],g[t]=m);for(u=r.transpose(p),f=0;f<i;f++)for(h[f]=[],t=0;t<u.length;t++)h[f][t]=r.dot([g[f]],[u[t]]);return[n,c,g,h]}}),function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(t,e){var a=this;return e?(setTimeout(function(){e.call(a,r.fn[n].call(a,t))},15),this):r(r[n](this,t))}}(n[t])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(r,n){var t=[].slice,e=r.utils.isNumber;r.extend({zscore:function(){var n=t.call(arguments);return e(n[1])?(n[0]-n[1])/n[2]:(n[0]-r.mean(n[1]))/r.stdev(n[1],n[2])},ztest:function(){var a=t.call(arguments);if(4===a.length){if(e(a[1])){var u=r.zscore(a[0],a[1],a[2]);return 1===a[3]?r.normal.cdf(-n.abs(u),0,1):2*r.normal.cdf(-n.abs(u),0,1)}u=a[0];return 1===a[2]?r.normal.cdf(-n.abs(u),0,1):2*r.normal.cdf(-n.abs(u),0,1)}u=r.zscore(a[0],a[1],a[3]);return 1===a[1]?r.normal.cdf(-n.abs(u),0,1):2*r.normal.cdf(-n.abs(u),0,1)}}),r.extend(r.fn,{zscore:function(r,n){return(r-this.mean())/this.stdev(n)},ztest:function(t,e,a){var u=n.abs(this.zscore(t,a));return 1===e?r.normal.cdf(-u,0,1):2*r.normal.cdf(-u,0,1)}}),r.extend({tscore:function(){var e=t.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/n.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/n.sqrt(e[1].length))},ttest:function(){var a,u=t.call(arguments);return 5===u.length?(a=n.abs(r.tscore(u[0],u[1],u[2],u[3])),1===u[4]?r.studentt.cdf(-a,u[3]-1):2*r.studentt.cdf(-a,u[3]-1)):e(u[1])?(a=n.abs(u[0]),1==u[2]?r.studentt.cdf(-a,u[1]-1):2*r.studentt.cdf(-a,u[1]-1)):(a=n.abs(r.tscore(u[0],u[1])),1==u[2]?r.studentt.cdf(-a,u[1].length-1):2*r.studentt.cdf(-a,u[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-r.studentt.cdf(n.abs(this.tscore(t)),this.cols()-1):2*r.studentt.cdf(-n.abs(this.tscore(t)),this.cols()-1)}}),r.extend({anovafscore:function(){var e,a,u,o,i,l,f,s,c=t.call(arguments);if(1===c.length){for(i=new Array(c[0].length),f=0;f<c[0].length;f++)i[f]=c[0][f];c=i}if(2===c.length)return r.variance(c[0])/r.variance(c[1]);for(a=new Array,f=0;f<c.length;f++)a=a.concat(c[f]);for(u=r.mean(a),e=0,f=0;f<c.length;f++)e+=c[f].length*n.pow(r.mean(c[f])-u,2);for(e/=c.length-1,l=0,f=0;f<c.length;f++)for(o=r.mean(c[f]),s=0;s<c[f].length;s++)l+=n.pow(c[f][s]-o,2);return e/(l/=a.length-c.length)},anovaftest:function(){var n,a,u,o,i=t.call(arguments);if(e(i[0]))return 1-r.centralF.cdf(i[0],i[1],i[2]);for(anovafscore=r.anovafscore(i),n=i.length-1,u=0,o=0;o<i.length;o++)u+=i[o].length;return a=u-n-1,1-r.centralF.cdf(anovafscore,n,a)},ftest:function(n,t,e){return 1-r.centralF.cdf(n,t,e)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var n,t=0;for(n=0;n<this.length;n++)t+=this[n].length;return r.ftest(this.anovafscore(),this.length-1,t-this.length)}}),r.extend({normalci:function(){var e,a=t.call(arguments),u=new Array(2);return e=4===a.length?n.abs(r.normal.inv(a[1]/2,0,1)*a[2]/n.sqrt(a[3])):n.abs(r.normal.inv(a[1]/2,0,1)*r.stdev(a[2])/n.sqrt(a[2].length)),u[0]=a[0]-e,u[1]=a[0]+e,u},tci:function(){var e,a=t.call(arguments),u=new Array(2);return e=4===a.length?n.abs(r.studentt.inv(a[1]/2,a[3]-1)*a[2]/n.sqrt(a[3])):n.abs(r.studentt.inv(a[1]/2,a[2].length-1)*r.stdev(a[2],!0)/n.sqrt(a[2].length)),u[0]=a[0]-e,u[1]=a[0]+e,u},significant:function(r,n){return r<n}}),r.extend(r.fn,{normalci:function(n,t){return r.normalci(n,t,this.toArray())},tci:function(n,t){return r.tci(n,t,this.toArray())}})}(this.jStat,Math),function(){var root=this,Formula=root.Formula={},_=root._,numeral=root.numeral,jStat=root.jStat,moment=root.moment,lodash=_.noConflict(),md5=root.md5,_s=_.str;if("undefined"!=typeof exports)module.exports=exportModule(require("numeral"),require("jStat"),require("moment"),require("lodash"),require("underscore.string"),require("blueimp-md5"));else{if("function"!=typeof define||!define.amd)return Formula=exportModule(numeral,jStat,moment,lodash,_s,md5),Formula;define("formula",["numeral","jstat","moment","lodash","underscore.string","md5"],exportModule)}function exportModule(numeral,jStat,moment,_,_s,md5){var MEMOIZED_FACT=[],SQRT2PI=2.5066282746310002,WEEK_STARTS=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],WEEK_TYPES=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],WEEKEND_TYPES=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],simplifyArguments=function(arguments){for(var r in arguments)_.isArray(arguments[r])&&(arguments[r]=Formula.FLATTEN(arguments[r]));return arguments};return Formula.UNIQUE=function(){return _.unique(arguments)},Formula.FLATTEN=function(){return _.flatten(arguments)},Formula.FUNCTION=function(){var r=Array.prototype.slice.call(arguments),n=r[r.length-1],t=n.replace(/(\w+)\(/g,function(){return"Formulae."+arguments[0]});return r[r.length-1]="return "+t+";",t!==n&&r.unshift("Formulae"),Function.apply(null,r)},Formula.MOMENT=function(r,n){return moment(r).format(n)},Formula.MOMENTADD=function(r,n,t){return moment(r).add(n,t)},Formula.MOMENTDIFF=function(r,n,t){return moment(n).diff(moment.utc(r),t)},Formula.MOMENTSUB=function(r,n,t){return moment(r).subtract(n,t)},Formula.MOMENTUTC=function(r,n){return moment.utc(r).format(n)},Formula.MOMENTUTCADD=function(r,n,t){return moment.utc(r).add(n,t)},Formula.MOMENTUTCDIFF=function(r,n,t){return moment.utc(n).diff(moment.utc(r),t)},Formula.MOMENTUTCSUB=function(r,n,t){return moment.utc(r).subtract(n,t)},Formula.MOMENTUNIX=function(r){return moment.unix(r).toDate()},Formula.MOMENTFORMAT=function(r,n){return moment(r).format(n)},Formula.MOMENTISLEAPYEAR=function(r,n){return moment(r,n).isLeapYear()},Formula.MOMENTISDST=function(r,n){return moment(r,n).isDST()},Formula.MOMENTSTARTOF=function(r,n,t){return moment(r,t).startOf(n).toDate()},Formula.MOMENTENDOF=function(r,n,t){return moment(r,t).endOf(n).toDate()},Formula.MOMENTISAFTER=function(r,n,t){return moment(r,t).isAfter(moment(n,t))},Formula.MOMENTISBEFORE=function(r,n,t){return moment(r,t).isBefore(moment(n,t))},Formula.INTERVAL=function(r){var n=Math.floor(r/94608e4);r%=94608e4;var t=Math.floor(r/2592e3);r%=2592e3;var e=Math.floor(r/86400);r%=86400;var a=Math.floor(r/3600);r%=3600;var u=Math.floor(r/60),o=r%=60;return"P"+(n=n>0?n+"Y":"")+(t=t>0?t+"M":"")+(e=e>0?e+"D":"")+"T"+(a=a>0?a+"H":"")+(u=u>0?u+"M":"")+(o=o>0?o+"S":"")},Formula.ARGSCONCAT=function(r){for(var n=[],t=0;t<r.length;t++)n=n.concat(r[t]);return n},Formula.ARGSTOARRAY=function(r){return Array.prototype.slice.call(r,0)},Formula.CLEANFLOAT=function(r){var n=Math.pow(10,14);return Math.round(r*n)/n},Formula.COUNTIN=function(r,n){for(var t=0,e=0;e<r.length;e++)r[e]===n&&t++;return t},Formula.FINDFIELD=function(r,n){for(var t=null,e=0;e<r.length;e++)if(r[e][0]===n){t=e;break}return null==t?"#VALUE!":t},Formula.FINDRESULTINDEX=function(database,criteria){for(var maxCriteriaLength=criteria[0].length,i=1;i<criteria.length;i++)criteria[i].length>maxCriteriaLength&&(maxCriteriaLength=criteria[i].length);var columnResultIndexes=[];for(i=1;i<maxCriteriaLength;i++){for(var rowResultIndexes=[],j=0;j<criteria.length;j++)if(!(criteria[j].length<maxCriteriaLength)){for(var criteriaTitle=criteria[j][0],criteriaIndex=Formula.FINDFIELD(database,criteriaTitle),criteriaValues=_.rest(database[criteriaIndex]),count=0,singleResultIndexes=[],k=0;k<criteriaValues.length;k++)eval(criteriaValues[k]+criteria[j][i])&&(singleResultIndexes[count++]=k);rowResultIndexes[j]=singleResultIndexes}columnResultIndexes[i-1]=_.intersection.apply(_,rowResultIndexes)}var resultIndexes=_.union.apply(_,columnResultIndexes);return resultIndexes},Formula.DAVERAGE=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=0,i=0;i<e.length;i++)o+=a[e[i]];return Formula.IF(0===e.length,"#DIV/0!",o/e.length)},Formula.DCOUNT=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.COUNT(o)},Formula.DCOUNTA=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.COUNTA(o)},Formula.DGET=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);return 0===e.length?"#VALUE!":e.length>1?"#NUM!":a[e[0]]},Formula.DMAX=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=a[e[0]],i=1;i<e.length;i++)o<a[e[i]]&&(o=a[e[i]]);return o},Formula.DMIN=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=a[e[0]],i=1;i<e.length;i++)o>a[e[i]]&&(o=a[e[i]]);return o},Formula.DPRODUCT=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];o=_.compact(o);var l=1;for(i=0;i<o.length;i++)l*=o[i];return l},Formula.DSTDEV=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return o=_.compact(o),Formula.STDEVS(o)},Formula.DSTDEVP=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return o=_.compact(o),Formula.STDEVP(o)},Formula.DSUM=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.SUM(o)},Formula.DVAR=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.VARS(o)},Formula.DVARP=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.VARP(o)},Formula.GETJSON=function(r){var n=new XMLHttpRequest;if(n.open("GET",r,!1),n.send(null),200===n.status)return JSON.parse(n.responseText)},Formula.DATE=function(){if(!arguments.length)return new Date;if(1===arguments.length)return new Date(arguments[0]);var r=arguments;return r[1]=r[1]-1,new(Date.bind.apply(Date,[Date].concat([].splice.call(r,0))))},Formula.DATEVALUE=function(r){return Math.ceil((moment(r)-moment("1900-01-01"))/864e5)+2},Formula.DAY=function(r){return new Date(r).getDate()},Formula.DAYS=function(r,n){return moment(new Date(r)).diff(moment(new Date(n)),"days")},Formula.DAYS360=function(r,n,t){var e=moment(new Date(r)),a=moment(new Date(n)),u=31,o=31,i=e.date(),l=a.date();return t?(i=31===i?30:i,l=31===l?30:l):(1===e.month()&&(u=e.daysInMonth()),1===a.month()&&(o=a.daysInMonth()),30!==(i=i===u?30:i)&&i!==u||(l=l===o?30:l)),360*(a.year()-e.year())+30*(a.month()-e.month())+(l-i)},Formula.EDATE=function(r,n){return moment(new Date(r)).add("months",n).toDate()},Formula.EOMONTH=function(r,n){var t=moment(new Date(r)).add("months",n);return new Date(t.year(),t.month(),t.daysInMonth())},Formula.FROMNOW=function(r,n){return moment(new Date(r)).fromNow(n)},Formula.HOUR=function(r){return r<=1?Math.floor(24*r):new Date(r).getHours()},Formula.MINUTE=function(r){return r<=1?Math.floor(1440*r)-60*Math.floor(24*r):new Date(r).getMinutes()},Formula.ISOWEEKNUM=function(r){return moment(new Date(r)).format("w")},Formula.MONTH=function(r){return new Date(r).getMonth()+1},Formula.NETWORKDAYS=function(r,n,t){return Formula.NETWORKDAYSINTL(r,n,1,t)},Formula.NETWORKDAYSINTL=function(r,n,t,e){var a=WEEKEND_TYPES[void 0===t?1:t],u=moment(r),o=moment(n).diff(u,"days")+1,i=o,l=u,f=[];if(void 0!==e)for(var s=0;s<e.length;s++)f[s]=moment(new Date(e[s])).format("MM-DD-YYYY");if(!a.length&&!f.length)return i;for(var c=0;c<o;)a.indexOf(parseInt(l.format("d"),10))>=0?i--:f.indexOf(l.format("MM-DD-YYYY"))>=0&&i--,l=l.add("days",1),c++;return i},Formula.NOW=function(){return new Date},Formula.SECOND=function(r){return new Date(r).getSeconds()},Formula.TIME=function(r,n,t){return(3600*r+60*n+t)/86400},Formula.TIMEVALUE=function(r){var n=new Date(r);return(3600*n.getHours()+60*n.getMinutes()+n.getSeconds())/86400},Formula.TODAY=Formula.NOW,Formula.WEEKDAY=function(r,n){var t=moment(new Date(r)).format("d");return WEEK_TYPES[void 0===n?1:n][t]},Formula.WEEKNUM=function(r,n){var t=moment(new Date(r)),e=moment(new Date(t.year(),0,1)),a=void 0===n?1:n,u=WEEK_STARTS[a],o=e.format("d"),i=o<u?u-o+1:o-u;return 21===a?Formula.ISOWEEKNUM(r):Math.floor(t.diff(e.subtract("days",i),"days")/7)+1},Formula.WORKDAY=function(r,n,t){return Formula.WORKDAYINTL(r,n,1,t)},Formula.WORKDAYINTL=function(r,n,t,e){var a=WEEKEND_TYPES[void 0===t?1:t],u=moment(new Date(r)),o="",i=[];if(void 0!==e)for(var l=0;l<e.length;l++)i[l]=moment(new Date(e[l])).format("MM-DD-YYYY");for(var f=0;f<n;)o=(u=u.add("days",1)).format("d"),a.indexOf(parseInt(o,10))<0&&i.indexOf(u.format("MM-DD-YYYY"))<0&&f++;return u.toDate()},Formula.YEAR=function(r){return new Date(r).getFullYear()},Formula.YEARFRAC=function(r,n,t){t=void 0===t?0:t;var e=moment(new Date(r)),a=moment(new Date(n));if(!e.isValid()||!a.isValid())return"#VALUE!";if(-1===[0,1,2,3,4].indexOf(t))return"#NUM!";if(e===a)return 0;e.diff(a)>0&&(a=moment(new Date(r)),e=moment(new Date(n)));var u=e.year(),o=e.month(),i=e.date(),l=a.year(),f=a.month(),s=a.date();switch(t){case 0:return 31===i&&31===s?(i=30,s=30):31===i?i=30:30===i&&31===s?s=30:1===o&&1===f&&e.daysInMonth()===i&&a.daysInMonth()===s?(i=30,s=30):1===o&&e.daysInMonth()===i&&(i=30),(s+30*f+360*l-(i+30*o+360*u))/360;case 1:var c=365;if(u===l||u+1===l&&(o>f||o===f&&i>=s))return u===l&&moment([u]).isLeapYear()?c=366:(function(r,n){var t=moment(new Date(r.year(),2,1));if(moment([r.year()]).isLeapYear()&&r.diff(t)<0&&n.diff(t)>=0)return!0;var e=moment(new Date(n.year(),2,1));return!!(moment([n.year()]).isLeapYear()&&n.diff(e)>=0&&r.diff(e)<0)}(e,a)||1===f&&29===s)&&(c=366),a.diff(e,"days")/c;var m=l-u+1,h=moment(new Date(l+1,0,1)).diff(moment(new Date(u,0,1)),"days")/m;return a.diff(e,"days")/h;case 2:return a.diff(e,"days")/360;case 3:return a.diff(e,"days")/365;case 4:return 31===i&&(i=30),31===s&&(s=30),(s+30*f+360*l-(i+30*o+360*u))/360}},Formula.BESSELI=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),t=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();var e=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),a=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function u(o,i){if(0===(i=Math.round(i)))return(l=o)<=3.75?r(n,l*l/14.0625):Math.exp(Math.abs(l))/Math.sqrt(Math.abs(l))*r(t,3.75/Math.abs(l));var l,f;if(1===i)return(f=o)<3.75?f*r(e,f*f/14.0625):(f<0?-1:1)*Math.exp(Math.abs(f))/Math.sqrt(Math.abs(f))*r(a,3.75/Math.abs(f));if(i<0)throw"BESSELI Order ("+i+") must be nonnegative";if(0===Math.abs(o))return 0;var s,c,m,h,p,d=2/Math.abs(o);for(m=s=0,h=1,c=2*Math.round((i+Math.round(Math.sqrt(40*i)))/2);c>0;c--)p=c*d*h+m,m=h,h=p,Math.abs(h)>1e10&&(h*=1e-10,m*=1e-10,s*=1e-10),c===i&&(s=m);return s*=u(o,0)/h,o<0&&i%2?-s:s}}(),Formula.BESSELJ=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}var n=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),u=.636619772;function o(o){var i,l,f,s=o*o,c=Math.abs(o)-.785398164;return Math.abs(o)<8?i=(l=r(n,s))/(f=r(t,s)):(l=r(e,s=64/s),f=r(a,s),i=Math.sqrt(u/Math.abs(o))*(Math.cos(c)*l-Math.sin(c)*f*8/Math.abs(o))),i}var i=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),s=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function c(n){var t,e,a,o=n*n,c=Math.abs(n)-2.356194491;return Math.abs(n)<8?t=(e=n*r(i,o))/(a=r(l,o)):(e=r(f,o=64/o),a=r(s,o),t=Math.sqrt(u/Math.abs(n))*(Math.cos(c)*e-Math.sin(c)*a*8/Math.abs(n)),n<0&&(t=-t)),t}return function(r,n){if(0===(n=Math.round(n)))return o(Math.abs(r));if(1===n)return c(Math.abs(r));if(n<0)throw"BESSELJ: Order ("+n+") must be nonnegative";if(0===Math.abs(r))return 0;var t,e,a,u,i,l,f,s=2/Math.abs(r);if(Math.abs(r)>n)t=function(r,n,t,e,a){a||(a=-1);var u,o=2/r;if(0===n)return t;if(1===n)return e;for(var i=1;i!==n;++i)u=e*i*o+a*t,t=e,e=u;return e}(r,n,o(Math.abs(r)),c(Math.abs(r)),-1);else{for(a=0,i=t=u=0,l=1,e=2*Math.floor((n+Math.floor(Math.sqrt(40*n)))/2);e>0;e--)f=e*s*l-i,i=l,l=f,Math.abs(l)>1e10&&(l*=1e-10,i*=1e-10,t*=1e-10,u*=1e-10),a&&(u+=l),a=!a,e===n&&(t=i);t/=u=2*u-l}return r<0&&n%2?-t:t}}(),Formula.BESSELK=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();var e,a,u,o,i,l=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),f=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return e=function(e){return e<=2?-Math.log(e/2)*Formula.BESSELI(e,0)+r(n,e*e/4):Math.exp(-e)/Math.sqrt(e)*r(t,2/e)},a=function(n){return n<=2?Math.log(n/2)*Formula.BESSELI(n,1)+1/n*r(l,n*n/4):Math.exp(-n)/Math.sqrt(n)*r(f,2/n)},u="BESSELK",o=2,i=1,function(r,n){if(0===n)return e(r);if(1===n)return a(r);if(n<0)throw u+": Order ("+n+") must be nonnegative";if(1===o&&0===r)throw u+": Undefined when x == 0";if(2===o&&r<=0)throw u+": Undefined when x <= 0";return function(r,n,t,e,a){a||(a=-1);var u,o=2/r;if(0===n)return t;if(1===n)return e;for(var i=1;i!==n;++i)u=e*i*o+a*t,t=e,e=u;return e}(r,n,e(r),a(r),i)}}(),Formula.BESSELY=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}var n=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),t=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),u=.636619772;var o,i,l,f,s,c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return o=function(o){var i,l,f,s=o*o,c=o-.785398164;return o<8?i=(l=r(n,s))/(f=r(t,s))+u*Formula.BESSELJ(o,0)*Math.log(o):(l=r(e,s=64/s),f=r(a,s),i=Math.sqrt(u/o)*(Math.sin(c)*l+Math.cos(c)*f*8/o)),i},i=function(n){var t,e,a,o=n*n,i=n-2.356194491;return n<8?t=(e=n*r(c,o))/(a=r(m,o))+u*(Formula.BESSELJ(n,1)*Math.log(n)-1/n):(e=r(h,o=64/o),a=r(p,o),t=Math.sqrt(u/n)*(Math.sin(i)*e+Math.cos(i)*a*8/n)),t},l="BESSELY",f=1,s=-1,function(r,n){if(0===n)return o(r);if(1===n)return i(r);if(n<0)throw l+": Order ("+n+") must be nonnegative";if(1===f&&0===r)throw l+": Undefined when x == 0";if(2===f&&r<=0)throw l+": Undefined when x <= 0";return function(r,n,t,e,a){a||(a=-1);var u,o=2/r;if(0===n)return t;if(1===n)return e;for(var i=1;i!==n;++i)u=e*i*o+a*t,t=e,e=u;return e}(r,n,o(r),i(r),s)}}(),Formula.VALIDBIN=function(r){return/^[01]{1,10}$/.test(r)},Formula.BIN2DEC=function(r){if(!Formula.VALIDBIN(r))return"#NUM!";var n=parseInt(r,2),t=r.toString();return 10===t.length&&"1"===t.substring(0,1)?parseInt(t.substring(1),2)-512:n},Formula.BIN2HEX=function(r,n){if(!Formula.VALIDBIN(r))return"#NUM!";var t=r.toString();if(10===t.length&&"1"===t.substring(0,1))return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);var e=parseInt(r,2).toString(16);return void 0===n?e:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!"},Formula.BIN2OCT=function(r,n){if(!Formula.VALIDBIN(r))return"#NUM!";var t=r.toString();if(10===t.length&&"1"===t.substring(0,1))return(1073741312+parseInt(t.substring(1),2)).toString(8);var e=parseInt(r,2).toString(8);return void 0===n?e:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!"},Formula.BITAND=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":r<0||n<0?"#NUM!":Math.floor(r)!==r||Math.floor(n)!==n?"#NUM!":r>0xffffffffffff||n>0xffffffffffff?"#NUM!":r&n},Formula.BITLSHIFT=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":r<0?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(n)>53?"#NUM!":n>=0?r<<n:r>>-n},Formula.BITOR=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":r<0||n<0?"#NUM!":Math.floor(r)!==r||Math.floor(n)!==n?"#NUM!":r>0xffffffffffff||n>0xffffffffffff?"#NUM!":r|n},Formula.BITRSHIFT=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":r<0?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(n)>53?"#NUM!":n>=0?r>>n:r<<-n},Formula.BITXOR=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":r<0||n<0?"#NUM!":Math.floor(r)!==r||Math.floor(n)!==n?"#NUM!":r>0xffffffffffff||n>0xffffffffffff?"#NUM!":r^n},Formula.COMPLEX=function(r,n,t){if(isNaN(r)||isNaN(n))return"#VALUE!";if("i"!==(t=void 0===t?"i":t)&&"j"!==t)return"#VALUE!";if(0===r&&0===n)return 0;if(0===r)return 1===n?t:n.toString()+t;if(0===n)return r.toString();var e=n>0?"+":"";return r.toString()+e+(1===n?t:n.toString()+t)},Formula.CONVERT=function(r,n,t){if(isNaN(r))return"#VALUE!";for(var e,a=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},o={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},i=null,l=null,f=n,s=t,c=1,m=1,h=0;h<a.length;h++)e=null===a[h][2]?[]:a[h][2],(a[h][1]===f||e.indexOf(f)>=0)&&(i=a[h]),(a[h][1]===s||e.indexOf(s)>=0)&&(l=a[h]);if(null===i){var p=u[n.substring(0,2)],d=o[n.substring(0,1)];"da"===n.substring(0,2)&&(d=["dekao",10,"da"]),p?(c=p[2],f=n.substring(2)):d&&(c=d[1],f=n.substring(d[2].length));for(var g=0;g<a.length;g++)e=null===a[g][2]?[]:a[g][2],(a[g][1]===f||e.indexOf(f)>=0)&&(i=a[g])}if(null===l){var v=u[t.substring(0,2)],M=o[t.substring(0,1)];"da"===t.substring(0,2)&&(M=["dekao",10,"da"]),v?(m=v[2],s=t.substring(2)):M&&(m=M[1],s=t.substring(M[2].length));for(var F=0;F<a.length;F++)e=null===a[F][2]?[]:a[F][2],(a[F][1]===s||e.indexOf(s)>=0)&&(l=a[F])}return null===i||null===l?"#N/A":i[3]!==l[3]?"#N/A":r*i[6]*c/(l[6]*m)},Formula.DEC2BIN=function(r,n){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(r)||r<-512||r>511)return"#NUM!";if(r<0)return"1"+_s.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var t=parseInt(r,10).toString(2);return void 0===n?t:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=t.length?_s.repeat("0",n-t.length)+t:"#NUM!"},Formula.DEC2HEX=function(r,n){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(r)||r<-549755813888||r>549755813887)return"#NUM!";if(r<0)return(1099511627776+r).toString(16);var t=parseInt(r,10).toString(16);return void 0===n?t:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=t.length?_s.repeat("0",n-t.length)+t:"#NUM!"},Formula.DEC2OCT=function(r,n){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(r)||r<-536870912||r>536870911)return"#NUM!";if(r<0)return(1073741824+r).toString(8);var t=parseInt(r,10).toString(8);return void 0===n?t:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=t.length?_s.repeat("0",n-t.length)+t:"#NUM!"},Formula.DELTA=function(r,n){return n=void 0===n?0:n,isNaN(r)||isNaN(n)?"#VALUE!":r===n?1:0},Formula.ERF=function(r,n){return n=void 0===n?0:n,isNaN(r)||isNaN(n)?"#VALUE!":jStat.erf(r)},Formula.ERFC=function(r){return isNaN(r)?"#VALUE!":jStat.erfc(r)},Formula.ERFCPRECISE=function(){},Formula.ERFPRECISE=function(){},Formula.GESTEP=function(r,n){return n=void 0===n?0:n,isNaN(r)||isNaN(n)?"#VALUE!":r>=n?1:0},Formula.HEX2BIN=function(r,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var t=10===r.length&&"f"===r.substring(0,1).toLowerCase(),e=t?parseInt(r,16)-1099511627776:parseInt(r,16);if(e<-512||e>511)return"#NUM!";if(t)return"1"+_s.repeat("0",9-(512+e).toString(2).length)+(512+e).toString(2);var a=e.toString(2);return void 0===n?a:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=a.length?_s.repeat("0",n-a.length)+a:"#NUM!"},Formula.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var n=parseInt(r,16);return n>=549755813888?n-1099511627776:n},Formula.HEX2OCT=function(r,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,16);if(t>536870911&&t<0xffe0000000)return"#NUM!";if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);var e=t.toString(8);return void 0===n?e:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!"},Formula.IMABS=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Math.sqrt(Math.pow(n,2)+Math.pow(t,2))},Formula.IMAGINARY=function(r){if(0===r||"0"===r)return 0;if(["i","j"].indexOf(r)>=0)return 1;var n=(r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),t=r.indexOf("-");0===n&&(n=r.indexOf("+",1)),0===t&&(t=r.indexOf("-",1));var e=r.substring(r.length-1,r.length),a="i"===e||"j"===e;return n>=0||t>=0?a?n>=0?isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?"#NUM!":Number(r.substring(n+1,r.length-1)):isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":-Number(r.substring(t+1,r.length-1)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":r.substring(0,r.length-1):isNaN(r)?"#NUM!":0},Formula.IMARGUMENT=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":0===n&&0===t?"#DIV/0!":0===n&&t>0?Math.PI/2:0===n&&t<0?-Math.PI/2:0===t&&n>0?0:0===t&&n<0?-Math.PI:n>0?Math.atan(t/n):n<0&&t>=0?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI},Formula.IMCONJUGATE=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":0!==t?Formula.COMPLEX(n,-t,e):r},Formula.IMCOS=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,e)},Formula.IMCOSH=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,e)},Formula.IMCOT=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV(Formula.IMCOS(r),Formula.IMSIN(r))},Formula.IMCSC=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMSIN(r))},Formula.IMCSCH=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMSINH(r))},Formula.IMDIV=function(r,n){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(n),u=Formula.IMAGINARY(n),o=r.substring(r.length-1),i=r.substring(r.length-1),l="i";if("j"===o?l="j":"j"===i&&(l="j"),"#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";if(0===a&&0===u)return"#NUM!";var f=a*a+u*u;return Formula.COMPLEX((t*a+e*u)/f,(e*a-t*u)/f,l)},Formula.IMEXP=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);if(e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t)return"#NUM!";var a=Math.exp(n);return Formula.COMPLEX(a*Math.cos(t),a*Math.sin(t),e)},Formula.IMLN=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(n*n+t*t)),Math.atan(t/n),e)},Formula.IMLOG10=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(10),Math.atan(t/n)/Math.log(10),e)},Formula.IMLOG2=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(2),Math.atan(t/n)/Math.log(2),e)},Formula.IMPOWER=function(r,n){if(isNaN(n))return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=r.substring(r.length-1);if(a="i"===a||"j"===a?a:"i","#NUM!"===t||"#NUM!"===e)return"#NUM!";var u=Math.pow(Formula.IMABS(r),n),o=Formula.IMARGUMENT(r);return Formula.COMPLEX(u*Math.cos(n*o),u*Math.sin(n*o),a)},Formula.IMPRODUCT=function(){for(var r=arguments[0],n=1;n<arguments.length;n++){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[n]),u=Formula.IMAGINARY(arguments[n]);if("#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";r=Formula.COMPLEX(t*a-e*u,t*u+e*a)}return r},Formula.IMREAL=function(r){if(0===r||"0"===r)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var n=r.indexOf("+"),t=r.indexOf("-");0===n&&(n=r.indexOf("+",1)),0===t&&(t=r.indexOf("-",1));var e=r.substring(r.length-1,r.length),a="i"===e||"j"===e;return n>=0||t>=0?a?n>=0?isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?"#NUM!":Number(r.substring(0,n)):isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":Number(r.substring(0,t)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":0:isNaN(r)?"#NUM!":r},Formula.IMSEC=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMCOS(r))},Formula.IMSECH=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMCOSH(r))},Formula.IMSIN=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,e)},Formula.IMSINH=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,e)},Formula.IMSQRT=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);if(e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t)return"#NUM!";var a=Math.sqrt(Formula.IMABS(r)),u=Formula.IMARGUMENT(r);return Formula.COMPLEX(a*Math.cos(u/2),a*Math.sin(u/2),e)},Formula.IMSUB=function(r,n){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(n),u=Formula.IMAGINARY(n),o=r.substring(r.length-1),i=r.substring(r.length-1),l="i";return"j"===o?l="j":"j"===i&&(l="j"),"#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u?"#NUM!":Formula.COMPLEX(t-a,e-u,l)},Formula.IMSUM=function(){for(var r=arguments[0],n=1;n<arguments.length;n++){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[n]),u=Formula.IMAGINARY(arguments[n]);if("#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";r=Formula.COMPLEX(t+a,e+u)}return r},Formula.IMTAN=function(r){if(!0===r||!1===r)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV(Formula.IMSIN(r),Formula.IMCOS(r))},Formula.OCT2BIN=function(r,n){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var t=10===r.length&&"7"===r.substring(0,1),e=t?parseInt(r,8)-1073741824:parseInt(r,8);if(e<-512||e>511)return"#NUM!";if(t)return"1"+_s.repeat("0",9-(512+e).toString(2).length)+(512+e).toString(2);var a=e.toString(2);return void 0===n?a:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=a.length?_s.repeat("0",n-a.length)+a:"#NUM!"},Formula.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var n=parseInt(r,8);return n>=536870912?n-1073741824:n},Formula.OCT2HEX=function(r,n){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);var e=t.toString(16);return void 0===n?e:isNaN(n)?"#VALUE!":n<0?"#NUM!":(n=Math.floor(n))>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!"},Formula.ACCRINT=function(r,n,t,e,a,u,o,i){if(!moment(r).isValid()||!moment(n).isValid()||!moment(t).isValid())return"#VALUE!";if(e<=0||a<=0)return"#NUM!";if(-1===[1,2,4].indexOf(u))return"#NUM!";if(-1===[0,1,2,3,4].indexOf(o))return"#NUM!";if(moment(r).diff(moment(t))>=0)return"#NUM!";a=void 0===a?0:a,o=void 0===o?0:o,i=void 0===i||i;var l=0;switch(o){case 0:case 1:case 2:case 3:case 4:l=Formula.YEARFRAC(r,t,o)}return a*e*l},Formula.ACCRINTM=function(){},Formula.AMORDEGRC=function(){},Formula.AMORLINC=function(){},Formula.COUPDAYBS=function(){},Formula.COUPDAYS=function(){},Formula.COUPDAYSNC=function(){},Formula.COUPNCD=function(){},Formula.COUPNUM=function(){},Formula.COUPPCD=function(){},Formula.CUMIPMT=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),interest=0;1===start&&0===type&&(interest=-value,start++);for(var i=start;i<=end;i++)interest+=1===type?Formula.FV(rate,i-2,payment,value,1)-payment:Formula.FV(rate,i-1,payment,value,0);return interest*=rate,interest},Formula.CUMPRINC=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),principal=0;1===start&&(principal=0===type?payment+value*rate:payment,start++);for(var i=start;i<=end;i++)principal+=type>0?payment-(Formula.FV(rate,i-2,payment,value,1)-payment)*rate:payment-Formula.FV(rate,i-1,payment,value,0)*rate;return principal},Formula.DB=function(r,n,t,e,a){if(a=void 0===a?12:a,isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e)||isNaN(a))return"#VALUE!";if(r<0||n<0||t<0||e<0)return"#NUM!";if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a))return"#NUM!";if(e>t)return"#NUM!";if(n>=r)return 0;for(var u=(1-Math.pow(n/r,1/t)).toFixed(3),o=r*u*a/12,i=o,l=0,f=e===t?t-1:e,s=2;s<=f;s++)i+=l=(r-i)*u;return 1===e?o:e===t?(r-i)*u:l},Formula.DDB=function(r,n,t,e,a){if(a=void 0===a?2:a,isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e)||isNaN(a))return"#VALUE!";if(r<0||n<0||t<0||e<0||a<=0)return"#NUM!";if(e>t)return"#NUM!";if(n>=r)return 0;for(var u=0,o=0,i=1;i<=e;i++)u+=o=Math.min(a/t*(r-u),r-n-u);return o},Formula.DISC=function(){},Formula.DOLLARDE=function(r,n){if(isNaN(r)||isNaN(n))return"#VALUE!";if(n<0)return"#NUM!";if(n>=0&&n<1)return"#DIV/0!";n=parseInt(n,10);var t=parseInt(r,10);t+=r%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;var e=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return t=Math.round(t*e)/e},Formula.DOLLARFR=function(r,n){if(isNaN(r)||isNaN(n))return"#VALUE!";if(n<0)return"#NUM!";if(n>=0&&n<1)return"#DIV/0!";n=parseInt(n,10);var t=parseInt(r,10);return t+=r%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n},Formula.DURATION=function(){},Formula.EFFECT=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":r<=0||n<1?"#NUM!":(n=parseInt(n,10),Math.pow(1+r/n,n)-1)},Formula.FV=function(rate,periods,payment,value,type){var result;if(type=void 0===type?0:type,rate=eval(rate),0===rate)result=value+payment*periods;else{var term=Math.pow(1+rate,periods);result=1===type?value*term+payment*(1+rate)*(term-1)/rate:value*term+payment*(term-1)/rate}return-result},Formula.FVSCHEDULE=function(r,n){for(var t=r,e=0;e<n.length;e++){if(isNaN(n[e]))return"#VALUE!";t*=1+n[e]}return t},Formula.INTRATE=function(){},Formula.IPMT=function(rate,period,periods,present,future,type){type=void 0===type?0:type,rate=eval(rate),periods=eval(periods);var payment=Formula.PMT(rate,periods,present,future,type),interest;return interest=1===period?1===type?0:-present:1===type?Formula.FV(rate,period-2,payment,present,1)-payment:Formula.FV(rate,period-1,payment,present,0),interest*rate},Formula.IRR=function(r,n){r=Formula.FLATTEN(r);for(var t=function(r,n,t){for(var e=t+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(e,(n[u]-n[0])/365);return a},e=function(r,n,t){for(var e=t+1,a=0,u=1;u<r.length;u++){var o=(n[u]-n[0])/365;a-=o*r[u]/Math.pow(e,o+1)}return a},a=[],u=!1,o=!1,i=0;i<r.length;i++)a[i]=0===i?0:a[i-1]+365,r[i]>0&&(u=!0),r[i]<0&&(o=!0);if(!u||!o)return"#NUM!";var l,f,s,c=n=void 0===n?.1:n,m=0,h=!0;do{l=c-(s=t(r,a,c))/e(r,a,c),f=Math.abs(l-c),c=l,h=f>1e-10&&Math.abs(s)>1e-10}while(h&&++m<50);return h?"#NUM!":c},Formula.ISPMT=function(rate,period,periods,value){return rate=eval(rate),periods=eval(periods),value*rate*(period/periods-1)},Formula.MDURATION=function(){},Formula.MIRR=function(r,n,t){for(var e=r.length,a=[],u=[],o=0;o<e;o++)r[o]<0?a.push(r[o]):u.push(r[o]);var i=-Formula.NPV(t,u)*Math.pow(1+t,e-1),l=Formula.NPV(n,a)*(1+n);return Math.pow(i/l,1/(e-1))-1},Formula.NOMINAL=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":r<=0||n<1?"#NUM!":(n=parseInt(n,10),(Math.pow(r+1,1/n)-1)*n)},Formula.NPER=function(rate,payment,present,future,type){type=void 0===type?0:type,future=void 0===future?0:future,rate=eval(rate);var num=payment*(1+rate*type)-future*rate,den=present*rate+payment*(1+rate*type);return Math.log(num/den)/Math.log(1+rate)},Formula.NPV=function(){for(var r=[],n=0;n<arguments.length;n++)r=r.concat(arguments[n]);for(var t=r[0],e=0,a=1;a<r.length;a++)e+=r[a]/Math.pow(1+t,a);return e},Formula.ODDFPRICE=function(){},Formula.ODDFYIELD=function(){},Formula.ODDLPRICE=function(){},Formula.ODDLYIELD=function(){},Formula.PDURATION=function(r,n,t){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":r<=0?"#NUM!":(Math.log(t)-Math.log(n))/Math.log(1+r)},Formula.PMT=function(rate,periods,present,future,type){var result;if(type=void 0===type?0:type,rate=eval(rate),periods=eval(periods),0===rate)result=(present+future)/periods;else{var term=Math.pow(1+rate,periods);result=1===type?(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate):future*rate/(term-1)+present*rate/(1-1/term)}return-result},Formula.PPMT=function(r,n,t,e,a,u){return Formula.PMT(r,t,e,a,u)-Formula.IPMT(r,n,t,e,a,u)},Formula.PRICE=function(){},Formula.PRICEDISC=function(){},Formula.PRICEMAT=function(){},Formula.PV=function(rate,periods,payment,future,type){return type=void 0===type?0:type,rate=eval(rate),periods=eval(periods),0===rate?-payment*periods-future:((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)},Formula.RATE=function(periods,payment,present,future,type,guess){guess=void 0===guess?.01:guess,future=void 0===future?0:future,type=void 0===type?0:type,periods=eval(periods);var epsMax=1e-10,iterMax=50,y,y0,y1,x0,x1=0,f=0,i=0,rate=guess;for(Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=present+payment*periods+future,y1=present*f+payment*(1/rate+type)*(f-1)+future,i=x0=0,x1=rate;Math.abs(y0-y1)>epsMax&&i<iterMax;)rate=(y1*x0-y0*x1)/(y1-y0),x0=x1,x1=rate,Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=y1,y1=y,++i;return rate},Formula.RECEIVED=function(){},Formula.RRI=function(r,n,t){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":0===r||0===n?"#NUM!":Math.pow(t/n,1/r)-1},Formula.SLN=function(r,n,t){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":0===t?"#NUM!":(r-n)/t},Formula.SYD=function(r,n,t,e){return isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e)?"#VALUE!":0===t?"#NUM!":e<1||e>t?"#NUM!":(r-n)*(t-(e=parseInt(e,10))+1)*2/(t*(t+1))},Formula.TBILLEQ=function(r,n,t){return moment(r).isValid()&&moment(n).isValid()?t<=0?"#NUM!":moment(r).diff(moment(n))>0?"#NUM!":moment(n).diff(moment(r),"years")>1?"#NUM!":365*t/(360-t*Formula.DAYS360(r,n)):"#VALUE!"},Formula.TBILLPRICE=function(r,n,t){return moment(r).isValid()&&moment(n).isValid()?t<=0?"#NUM!":moment(r).diff(moment(n))>0?"#NUM!":moment(n).diff(moment(r),"years")>1?"#NUM!":100*(1-t*Formula.DAYS360(r,n)/360):"#VALUE!"},Formula.TBILLYIELD=function(r,n,t){return moment(r).isValid()&&moment(n).isValid()?t<=0?"#NUM!":moment(r).diff(moment(n))>0?"#NUM!":moment(n).diff(moment(r),"years")>1?"#NUM!":360*(100-t)/(t*Formula.DAYS360(r,n)):"#VALUE!"},Formula.VDB=function(){},Formula.XIRR=function(r,n,t){for(var e=function(r,n,t){for(var e=t+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(e,moment(n[u]).diff(moment(n[0]),"days")/365);return a},a=function(r,n,t){for(var e=t+1,a=0,u=1;u<r.length;u++){var o=moment(n[u]).diff(moment(n[0]),"days")/365;a-=o*r[u]/Math.pow(e,o+1)}return a},u=!1,o=!1,i=0;i<r.length;i++)r[i]>0&&(u=!0),r[i]<0&&(o=!0);if(!u||!o)return"#NUM!";var l,f,s,c=t=t||.1,m=0,h=!0;do{l=c-(s=e(r,n,c))/a(r,n,c),f=Math.abs(l-c),c=l,h=f>1e-10&&Math.abs(s)>1e-10}while(h&&++m<50);return h?"#NUM!":c},Formula.XNPV=function(r,n,t){for(var e=0,a=0;a<n.length;a++)e+=n[a]/Math.pow(1+r,moment(t[a]).diff(moment(t[0]),"days")/365);return e},Formula.YIELD=function(){},Formula.YIELDDISC=function(){},Formula.YIELDMAT=function(){},Formula.ISNUMBER=function(r){return!(isNaN(parseFloat(r))||!isFinite(r))},Formula.AND=function(){for(var r=!0,n=0;n<arguments.length;n++)arguments[n]||(r=!1);return r},Formula.FALSE=function(){return!1},Formula.SWITCH=function(){var r;if(arguments.length>0){var n=arguments[0],t=arguments.length-1,e=Math.floor(t/2),a=!1,u=t%2==0?null:arguments[arguments.length-1];if(e)for(var o=0;o<e;o++)if(n===arguments[2*o+1]){r=arguments[2*o+2],a=!0;break}!a&&u&&(r=u)}return r},Formula.IF=function(r,n,t){return r?n:t},Formula.IFNA=function(r,n){return"#N/A"===r?n:r},Formula.NOT=function(r){return!r},Formula.OR=function(){for(var r=!1,n=0;n<arguments.length;n++)arguments[n]&&(r=!0);return r},Formula.TRUE=function(){return!0},Formula.XOR=function(){for(var r=0,n=0;n<arguments.length;n++)arguments[n]&&r++;return!!(1&Math.floor(Math.abs(r)))},Formula.REFERENCE=function(r,n){try{var t=n.split("."),e=r;return _(t).forEach(function(r){if("]"===r[r.length-1]){var n=r.indexOf("["),t=r.substring(n+1,r.length-1);e=e[r.substring(0,n)][t]}else e=e[r]}),e}catch(r){return}},Formula.ABS=function(r){return Math.abs(r)},Formula.ACOS=function(r){return Math.acos(r)},Formula.ACOSH=function(r){return Math.log(r+Math.sqrt(r*r-1))},Formula.ACOT=function(r){return Math.atan(1/r)},Formula.ACOTH=function(r){return.5*Math.log((r+1)/(r-1))},Formula.AGGREGATE=function(r){for(var n=[],t=2;t<arguments.length;t++)switch(r){case 1:n[t-2]=Formula.AVERAGE(arguments[t]);break;case 2:n[t-2]=Formula.COUNT(arguments[t]);break;case 3:n[t-2]=Formula.COUNTA(arguments[t]);break;case 4:n[t-2]=Formula.MAX(arguments[t]);break;case 5:n[t-2]=Formula.MIN(arguments[t]);break;case 6:n[t-2]=Formula.PRODUCT(arguments[t]);break;case 7:n[t-2]=Formula.STDEVS(arguments[t]);break;case 8:n[t-2]=Formula.STDEVP(arguments[t]);break;case 9:n[t-2]=Formula.SUM(arguments[t]);break;case 10:n[t-2]=Formula.VARS(arguments[t]);break;case 11:n[t-2]=Formula.VARP(arguments[t]);break;case 12:n[t-2]=Formula.MEDIAN(arguments[t]);break;case 13:n[t-2]=Formula.MODESNGL(arguments[t]);break;case 14:n[t-2]=Formula.LARGE(arguments[t]);break;case 15:n[t-2]=Formula.SMALL(arguments[t]);break;case 16:n[t-2]=Formula.PERCENTILEINC(arguments[t]);break;case 17:n[t-2]=Formula.QUARTILEINC(arguments[t]);break;case 18:n[t-2]=Formula.PERCENTILEEXC(arguments[t]);break;case 19:n[t-2]=Formula.QUARTILEEXC(arguments[t])}return n},Formula.ARABIC=function(r){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))throw new Error("Incorrect roman number");var n=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){n+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),n},Formula.ASIN=function(r){return Math.asin(r)},Formula.ASINH=function(r){return Math.log(r+Math.sqrt(r*r+1))},Formula.ATAN=function(r){return Math.atan(r)},Formula.ATAN2=function(r,n){return Math.atan2(r,n)},Formula.ATANH=function(r){return Math.log((1+r)/(1-r))/2},Formula.BASE=function(r,n,t){t=void 0===t?0:t;var e=r.toString(n);return new Array(Math.max(t+1-e.length,0)).join("0")+e},Formula.CEILING=function(r,n,t){if(0===n)return 0;n=void 0===n?1:Math.abs(n),t=void 0===t?0:t;var e=-Math.floor(Math.log(n)/Math.log(10));return r>=0?Formula.ROUND(Math.ceil(r/n)*n,e):0===t?-Formula.ROUND(Math.floor(Math.abs(r)/n)*n,e):-Formula.ROUND(Math.ceil(Math.abs(r)/n)*n,e)},Formula.CEILINGMATH=Formula.CEILING,Formula.CEILINGPRECISE=Formula.CEILING,Formula.COMBIN=function(r,n){return Formula.FACT(r)/(Formula.FACT(n)*Formula.FACT(r-n))},Formula.COMBINA=function(r,n){return 0===r&&0===n?1:Formula.COMBIN(r+n-1,r-1)},Formula.COS=Math.cos,Formula.COSH=function(r){return(Math.exp(r)+Math.exp(-r))/2},Formula.COT=function(r){return 1/Math.tan(r)},Formula.COTH=function(r){var n=Math.exp(2*r);return(n+1)/(n-1)},Formula.CSC=function(r){return 1/Math.sin(r)},Formula.CSCH=function(r){return 2/(Math.exp(r)-Math.exp(-r))},Formula.DECIMAL=function(r,n){return parseInt(r,n)},Formula.DEGREES=function(r){return 180*r/Math.PI},Formula.EVEN=function(r){return Formula.CEILING(r,-2,-1)},Formula.EXP=Math.exp,Formula.FACT=function(r){var n=Math.floor(r);return 0===n||1===n?1:MEMOIZED_FACT[n]>0?MEMOIZED_FACT[n]:(MEMOIZED_FACT[n]=Formula.FACT(n-1)*n,MEMOIZED_FACT[n])},Formula.FACTDOUBLE=function(r){var n=Math.floor(r);return n<=0?1:n*Formula.FACTDOUBLE(n-2)},Formula.FLOOR=function(r,n,t){if(0===n)return 0;n=n?Math.abs(n):1;var e=-Math.floor(Math.log(n)/Math.log(10));return r>=0?Formula.ROUND(Math.floor(r/n)*n,e):0===t||void 0===t?-Formula.ROUND(Math.ceil(Math.abs(r)/n)*n,e):-Formula.ROUND(Math.floor(Math.abs(r)/n)*n,e)},Formula.FLOORMATH=Formula.FLOOR,Formula.FLOORPRECISE=function(r,n){if(0===n)return 0;n=n?Math.abs(n):1;var t=-Math.floor(Math.log(n)/Math.log(10));return r>=0?Formula.ROUND(Math.round(r/n)*n,t):-Formula.ROUND(Math.ceil(Math.abs(r)/n)*n,t)},Formula.GCD=function(){for(var r,n,t=arguments.length-1,e=arguments[t];t;)for(n=arguments[--t];r=n%e;n=e,e=r);return e},Formula.INT=function(r){return Math.floor(r)},Formula.ISEVEN=function(r){return!(1&Math.floor(Math.abs(r)))},Formula.ISOCEILING=Formula.CEILING,Formula.ISODD=function(r){return!!(1&Math.floor(Math.abs(r)))},Formula.LCM=function(){for(var r,n,t,e,a=Formula.ARGSTOARRAY(arguments),u=1;void 0!==(t=a.pop());)for(;t>1;){if(t%2){for(r=3,n=Math.floor(Math.sqrt(t));r<=n&&t%r;r+=2);e=r<=n?r:t}else e=2;for(t/=e,u*=e,r=a.length;r;a[--r]%e==0&&1==(a[r]/=e)&&a.splice(r,1));}return u},Formula.LN=function(r){return Math.log(r)},Formula.LOG=function(r,n){return n=void 0===n?10:n,Math.log(r)/Math.log(n)},Formula.LOG10=function(r){return Math.log(r)/Math.log(10)},Formula.MOD=function(r,n){var t=Math.abs(r%n);return n>0?t:-t},Formula.MROUND=function(r,n){if(r*n<0)throw new Error("Number and multiple must have the same sign.");return Math.round(r/n)*n},Formula.MULTINOMIAL=function(){for(var r=0,n=1,t=0;t<arguments.length;t++)r+=arguments[t],n*=Formula.FACT(arguments[t]);return Formula.FACT(r)/n},Formula.ODD=function(r){var n=Math.ceil(Math.abs(r));return n=1&n?n:n+1,r>0?n:-n},Formula.E=function(){return Math.E},Formula.PI=function(){return Math.PI},Formula.POWER=function(r,n){var t=Math.pow(r,n);return isNaN(t)?"#NUM!":t},Formula.PRODUCT=function(){for(var r=1,n=0;n<arguments.length;n++)r*=arguments[n];return r},Formula.QUOTIENT=function(r,n){return(r/n).toFixed(0)},Formula.RADIANS=function(r){return r*Math.PI/180},Formula.RAND=function(){return Math.random()},Formula.RANDBETWEEN=function(r,n){return r+Math.ceil((n-r+1)*Math.random())-1},Formula.ROUND=function(r,n){return Math.round(r*Math.pow(10,n))/Math.pow(10,n)},Formula.ROUNDDOWN=function(r,n){return(r>0?1:-1)*Math.floor(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},Formula.ROUNDUP=function(r,n){return(r>0?1:-1)*Math.ceil(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},Formula.SERIESSUM=function(r,n,t,e){for(var a=e[0]*Math.pow(r,n),u=1;u<e.length;u++)a+=e[u]*Math.pow(r,n+u*t);return a},Formula.SEC=function(r){return 1/Math.cos(r)},Formula.SECH=function(r){return 2/(Math.exp(r)+Math.exp(-r))},Formula.SIGN=function(r){return r<0?-1:0===r?0:1},Formula.SIN=Math.sin,Formula.SINH=function(r){return(Math.exp(r)-Math.exp(-r))/2},Formula.SQRT=Math.sqrt,Formula.SQRTPI=function(r){return Math.sqrt(r*Math.PI)},Formula.SUBTOTAL=function(r){for(var n=[],t=1;t<arguments.length;t++)switch(r){case 1:n[t-1]=Formula.AVERAGE(arguments[t]);break;case 2:n[t-1]=Formula.COUNT(arguments[t]);break;case 3:n[t-1]=Formula.COUNTA(arguments[t]);break;case 4:n[t-1]=Formula.MAX(arguments[t]);break;case 5:n[t-1]=Formula.MIN(arguments[t]);break;case 6:n[t-1]=Formula.PRODUCT(arguments[t]);break;case 7:n[t-1]=Formula.STDEV(arguments[t]);break;case 8:n[t-1]=Formula.STDEVP(arguments[t]);break;case 9:n[t-1]=Formula.SUM(arguments[t]);break;case 10:n[t-1]=Formula.VAR(arguments[t]);break;case 11:n[t-1]=Formula.VARP(arguments[t])}return n},Formula.SUM=function(){for(var r=Formula.FLATTEN(arguments),n=0,t=0;t<r.length;t++)if(r[t]instanceof Array)for(var e=0;e<r[t].length;e++)n+=Formula.ISNUMBER(r[t][e])?r[t][e]:0;else n+=Formula.ISNUMBER(r[t])?r[t]:0;return n},Formula.SUMIF=function(range,criteria){range=Formula.FLATTEN(range);for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},Formula.SUMIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?range[i]:0}return result},Formula.SUMPRODUCT=function(){for(var r=arguments.length+1,n=0,t=0;t<arguments[0].length;t++)for(var e=0;e<arguments[0][t].length;e++){for(var a=1,u=1;u<r;u++)a*=arguments[u-1][t][e];n+=a}return n},Formula.SUMSQ=function(){for(var r=Formula.FLATTEN(arguments),n=0,t=0;t<r.length;t++)n+=Formula.ISNUMBER(r[t])?r[t]*r[t]:0;return n},Formula.SUMX2MY2=function(r,n){var t=0;r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var e=0;e<r.length;e++)t+=r[e]*r[e]-n[e]*n[e];return t},Formula.SUMX2PY2=function(r,n){var t=0;r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var e=0;e<r.length;e++)t+=r[e]*r[e]+n[e]*n[e];return t},Formula.SUMXMY2=function(r,n){var t=0;r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var e=0;e<r.length;e++)t+=Math.pow(r[e]-n[e],2);return t},Formula.TAN=function(r){return Math.tan(r)},Formula.TANH=function(r){var n=Math.exp(2*r);return(n-1)/(n+1)},Formula.TRUNC=function(r,n){return n=void 0===n?0:n,(r>0?1:-1)*Math.floor(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},Formula.AVEDEV=function(){var r=Formula.FLATTEN(arguments);return jStat.sum(jStat(r).subtract(jStat.mean(r)).abs()[0])/r.length},Formula.AVERAGE=function(){for(var r=Formula.NUMBERS(Formula.FLATTEN(arguments)),n=r.length,t=0,e=0,a=0;a<n;a++)t+=r[a],e+=1;return t/e},Formula.AVERAGEA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=0;a<n;a++){var u=r[a];"number"==typeof u&&(t+=u),!0===u&&t++,null!==u&&e++}return t/e},Formula.AVERAGEIF=function(range,criteria,average_range){average_range=average_range||range,range=Formula.FLATTEN(range),average_range=Formula.FLATTEN(average_range);for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},Formula.AVERAGEIFS=function(){for(var args=Formula.ARGSTOARRAY(arguments),criteria=(args.length-1)/2,range=Formula.FLATTEN(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},Formula.BETADIST=function(r,n,t,e,a,u){return r=(r-(a=void 0===a?0:a))/((u=void 0===u?1:u)-a),e?jStat.beta.cdf(r,n,t):jStat.beta.pdf(r,n,t)},Formula.BETAINV=function(r,n,t,e,a){return e=void 0===e?0:e,a=void 0===a?1:a,jStat.beta.inv(r,n,t)*(a-e)+e},Formula.BINOMDIST=function(r,n,t,e){return e?jStat.binomial.cdf(r,n,t):jStat.binomial.pdf(r,n,t)},Formula.BINOMDISTRANGE=function(r,n,t,e){e=void 0===e?t:e;for(var a=0,u=t;u<=e;u++)a+=Formula.COMBIN(r,u)*Math.pow(n,u)*Math.pow(1-n,r-u);return a},Formula.BINOMINV=function(r,n,t){for(var e=0;e<=r;){if(jStat.binomial.cdf(e,r,n)>=t)return e;e++}},Formula.CHISQDIST=function(r,n,t){return t?jStat.chisquare.cdf(r,n):jStat.chisquare.pdf(r,n)},Formula.CHISQDISTRT=function(){},Formula.CHISQINV=function(r,n){return jStat.chisquare.inv(r,n)},Formula.CHISQINVRT=function(){},Formula.CHISQTEST=function(){},Formula.CONFIDENCENORM=function(r,n,t){return jStat.normalci(1,r,n,t)[1]-1},Formula.CONFIDENCET=function(r,n,t){return jStat.tci(1,r,n,t)[1]-1},Formula.CORREL=function(){return jStat.corrcoeff.apply(this,arguments)},Formula.COUNT=function(){return Formula.NUMBERS(Formula.FLATTEN(arguments)).length},Formula.COUNTA=function(){var r=Formula.FLATTEN(arguments);return r.length-Formula.COUNTBLANK(r)},Formula.COUNTBLANK=function(){for(var r,n=Formula.FLATTEN(arguments),t=0,e=0;e<n.length;e++)null!==(r=n[e])&&""!==r&&r||t++;return t},Formula.COUNTIF=function(r,n){r=Formula.FLATTEN(r);for(var t=0,e=0;e<r.length;e++)r[e].match(new RegExp(n))&&t++;return t},Formula.COUNTIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?1:0}return result},Formula.COUNTUNIQUE=function(){return _.uniq(Formula.FLATTEN(arguments)).length},Formula.COVARIANCEP=function(r,n){r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var t=jStat.mean(r),e=jStat.mean(n),a=0,u=r.length,o=0;o<u;o++)a+=(r[o]-t)*(n[o]-e);return a/u},Formula.COVARIANCES=function(){return jStat.covariance.apply(this,simplifyArguments(arguments))},Formula.DEVSQ=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n,2);return t},Formula.EXPONDIST=function(r,n,t){return t?jStat.exponential.cdf(r,n):jStat.exponential.pdf(r,n)},Formula.FDIST=function(r,n,t,e){return e?jStat.centralF.cdf(r,n,t):jStat.centralF.pdf(r,n,t)},Formula.FDISTRT=function(){},Formula.FINV=function(r,n,t){return r<=0||r>1?"#NUM!":jStat.centralF.inv(1-r,n,t)},Formula.FINVRT=function(){},Formula.FTEST=function(){},Formula.FISHER=function(r){return Math.log((1+r)/(1-r))/2},Formula.FISHERINV=function(r){var n=Math.exp(2*r);return(n-1)/(n+1)},Formula.FORECAST=function(r,n,t){t=Formula.FLATTEN(t),n=Formula.FLATTEN(n);for(var e=jStat.mean(t),a=jStat.mean(n),u=t.length,o=0,i=0,l=0;l<u;l++)o+=(t[l]-e)*(n[l]-a),i+=Math.pow(t[l]-e,2);var f=o/i;return a-f*e+f*r},Formula.FREQUENCY=function(r,n){for(var t=r.length,e=n.length,a=[],u=0;u<=e;u++){a[u]=0;for(var o=0;o<t;o++)0===u?r[o]<=n[0]&&(a[0]+=1):u<e?r[o]>n[u-1]&&r[o]<=n[u]&&(a[u]+=1):u===e&&r[o]>n[e-1]&&(a[e]+=1)}return a},Formula.GAMMA=function(){return jStat.gammafn.apply(this,arguments)},Formula.GAMMADIST=function(){},Formula.GAMMAINV=function(){},Formula.GAMMALN=function(){return jStat.gammaln.apply(this,arguments)},Formula.GAMMALNPRECISE=function(){},Formula.GAUSS=function(r){return jStat.normal.cdf(r,0,1)-.5},Formula.GEOMEAN=function(){return jStat.geomean(Formula.ARGSCONCAT(arguments))},Formula.GROWTH=function(r,n,t,e){var a;if(void 0===n)for(n=[],a=1;a<=r.length;a++)n.push(a);if(void 0===t)for(t=[],a=1;a<=r.length;a++)t.push(a);void 0===e&&(e=!0);var u,o,i=r.length,l=0,f=0,s=0,c=0;for(a=0;a<i;a++){var m=n[a],h=Math.log(r[a]);l+=m,f+=h,s+=m*h,c+=m*m}l/=i,f/=i,s/=i,c/=i,e?o=f-(u=(s-l*f)/(c-l*l))*l:(u=s/c,o=0);var p=[];for(a=0;a<t.length;a++)p.push(Math.exp(o+u*t[a]));return p},Formula.HARMEAN=function(){for(var r=Formula.ARGSCONCAT(arguments),n=r.length,t=0,e=0;e<n;e++)t+=1/r[e];return n/t},Formula.HYPGEOMDIST=function(r,n,t,e,a){function u(r,n,t,e){return Formula.COMBIN(t,r)*Formula.COMBIN(e-t,n-r)/Formula.COMBIN(e,n)}return a?function(r,n,t,e){for(var a=0,o=0;o<=r;o++)a+=u(o,n,t,e);return a}(r,n,t,e):u(r,n,t,e)},Formula.INTERCEPT=function(r,n){return Formula.FORECAST(0,r,n)},Formula.KURT=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=r.length,e=0,a=0;a<t;a++)e+=Math.pow(r[a]-n,4);return t*(t+1)/((t-1)*(t-2)*(t-3))*(e/=Math.pow(jStat.stdev(r,!0),4))-3*(t-1)*(t-1)/((t-2)*(t-3))},Formula.LARGE=function(r,n){return r.sort(function(r,n){return n-r})[n-1]},Formula.LINEST=function(r,n){for(var t=jStat.mean(n),e=jStat.mean(r),a=n.length,u=0,o=0,i=0;i<a;i++)u+=(n[i]-t)*(r[i]-e),o+=Math.pow(n[i]-t,2);var l=u/o;return[l,e-l*t]},Formula.LOGEST=function(){},Formula.LOGNORMDIST=function(r,n,t,e){return e?jStat.lognormal.cdf(r,n,t):jStat.lognormal.pdf(r,n,t)},Formula.LOGNORMINV=function(r,n,t){return jStat.lognormal.inv(r,n,t)},Formula.MAX=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=n>0?r[0]:0,e=0;e<n;e++)t=r[e]>t&&!0!==r[e]&&!1!==r[e]?r[e]:t;return t},Formula.MAXA=function(){var r=Formula.FLATTEN(arguments);return r.length>0?Math.max.apply(Math,r):0},Formula.MEDIAN=function(){return jStat.median(Formula.FLATTEN(arguments))},Formula.MIN=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=n>0?r[0]:0,e=0;e<n;e++)t=r[e]<t&&!0!==r[e]&&!1!==r[e]?r[e]:t;return t},Formula.MINA=function(){var r=Formula.FLATTEN(arguments);return r.length>0?Math.min.apply(Math,r):0},Formula.MODEMULT=function(){for(var r,n=Formula.ARGSCONCAT(arguments),t=n.length,e={},a=[],u=0,o=0;o<t;o++)e[r=n[o]]=e[r]?e[r]+1:1,e[r]>u&&(u=e[r],a=[]),e[r]===u&&(a[a.length]=r);return a},Formula.MODESNGL=function(){return Formula.MODEMULT(Formula.ARGSCONCAT(arguments)).sort(function(r,n){return r-n})[0]},Formula.NEGBINOMDIST=function(r,n,t,e){return e?jStat.negbin.cdf(r,n,t):jStat.negbin.pdf(r,n,t)},Formula.NORMDIST=function(r,n,t,e){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":t<=0?"#NUM!":e?jStat.normal.cdf(r,n,t):jStat.normal.pdf(r,n,t)},Formula.NORMINV=function(r,n,t){return jStat.normal.inv(r,n,t)},Formula.NORMSDIST=function(r,n){return n?jStat.normal.cdf(r,0,1):jStat.normal.pdf(r,0,1)},Formula.NORMSINV=function(r){return jStat.normal.inv(r,0,1)},Formula.PEARSON=function(r,n){for(var t=jStat.mean(r),e=jStat.mean(n),a=r.length,u=0,o=0,i=0,l=0;l<a;l++)u+=(r[l]-t)*(n[l]-e),o+=Math.pow(r[l]-t,2),i+=Math.pow(n[l]-e,2);return u/Math.sqrt(o*i)},Formula.PERCENTILEEXC=function(r,n){var t=(r=r.sort(function(r,n){return r-n})).length;if(n<1/(t+1)||n>1-1/(t+1))return"#NUM!";var e=n*(t+1)-1,a=Math.floor(e);return Formula.CLEANFLOAT(e===a?r[e]:r[a]+(e-a)*(r[a+1]-r[a]))},Formula.PERCENTILEINC=function(r,n){var t=n*((r=r.sort(function(r,n){return r-n})).length-1),e=Math.floor(t);return Formula.CLEANFLOAT(t===e?r[t]:r[e]+(t-e)*(r[e+1]-r[e]))},Formula.PERCENTRANKEXC=function(r,n,t){r=r.sort(function(r,n){return r-n});var e=_.uniq(r),a=r.length,u=e.length;t=void 0===t?3:t;for(var o=Math.pow(10,t),i=0,l=!1,f=0;!l&&f<u;)n===e[f]?(i=(r.indexOf(e[f])+1)/(a+1),l=!0):n>=e[f]&&(n<e[f+1]||f===u-1)&&(i=(r.indexOf(e[f])+1+(n-e[f])/(e[f+1]-e[f]))/(a+1),l=!0),f++;return Math.floor(i*o)/o},Formula.PERCENTRANKINC=function(r,n,t){r=r.sort(function(r,n){return r-n});var e=_.uniq(r),a=r.length,u=e.length;t=void 0===t?3:t;for(var o=Math.pow(10,t),i=0,l=!1,f=0;!l&&f<u;)n===e[f]?(i=r.indexOf(e[f])/(a-1),l=!0):n>=e[f]&&(n<e[f+1]||f===u-1)&&(i=(r.indexOf(e[f])+(n-e[f])/(e[f+1]-e[f]))/(a-1),l=!0),f++;return Math.floor(i*o)/o},Formula.PERMUT=function(r,n){return Formula.FACT(r)/Formula.FACT(r-n)},Formula.PERMUTATIONA=function(r,n){return Math.pow(r,n)},Formula.PHI=function(r){return Math.exp(-.5*r*r)/SQRT2PI},Formula.POISSONDIST=function(r,n,t){return t?jStat.poisson.cdf(r,n):jStat.poisson.pdf(r,n)},Formula.PROB=function(r,n,t,e){if(void 0===t)return 0;if(t===(e=void 0===e?t:e))return r.indexOf(t)>=0?n[r.indexOf(t)]:0;for(var a=r.sort(function(r,n){return r-n}),u=a.length,o=0,i=0;i<u;i++)a[i]>=t&&a[i]<=e&&(o+=n[r.indexOf(a[i])]);return o},Formula.QUARTILEEXC=function(r,n){switch(n){case 1:return Formula.PERCENTILEEXC(r,.25);case 2:return Formula.PERCENTILEEXC(r,.5);case 3:return Formula.PERCENTILEEXC(r,.75);default:return"#NUM!"}},Formula.QUARTILEINC=function(r,n){switch(n){case 1:return Formula.PERCENTILEINC(r,.25);case 2:return Formula.PERCENTILEINC(r,.5);case 3:return Formula.PERCENTILEINC(r,.75);default:return"#NUM!"}},Formula.RANKAVG=function(r,n,t){var e=(t=void 0!==t&&t)?function(r,n){return r-n}:function(r,n){return n-r};n=n.sort(e);var a=Formula.COUNTIN(n,r);return a>1?(2*n.indexOf(r)+a+1)/2:n.indexOf(r)+1},Formula.RANKEQ=function(r,n,t){var e=(t=void 0!==t&&t)?function(r,n){return r-n}:function(r,n){return n-r};return(n=n.sort(e)).indexOf(r)+1},Formula.RSQ=function(r,n){return Math.pow(Formula.PEARSON(r,n),2)},Formula.SKEW=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=r.length,e=0,a=0;a<t;a++)e+=Math.pow(r[a]-n,3);return t*e/((t-1)*(t-2)*Math.pow(jStat.stdev(r,!0),3))},Formula.SKEWP=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=r.length,e=0,a=0,u=0;u<t;u++)a+=Math.pow(r[u]-n,3),e+=Math.pow(r[u]-n,2);return e/=t,(a/=t)/Math.pow(e,1.5)},Formula.SLOPE=function(r,n){for(var t=jStat.mean(n),e=jStat.mean(r),a=n.length,u=0,o=0,i=0;i<a;i++)u+=(n[i]-t)*(r[i]-e),o+=Math.pow(n[i]-t,2);return u/o},Formula.SMALL=function(r,n){return r.sort(function(r,n){return r-n})[n-1]},Formula.STANDARDIZE=function(r,n,t){return(r-n)/t},Formula.STDEVA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=jStat.mean(r),a=0;a<n;a++)t+=Math.pow(r[a]-e,2);return Math.sqrt(t/(n-1))},Formula.STDEVP=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;u<n;u++)!0!==r[u]&&!1!==r[u]&&(t+=Math.pow(r[u]-a,2),e++);return Math.sqrt(t/e)},Formula.STDEVPA=function(){for(var r=Formula.ARGSCONCAT(arguments),n=r.length,t=0,e=jStat.mean(r),a=0;a<n;a++)t+=Math.pow(r[a]-e,2);return Math.sqrt(t/n)},Formula.STDEVS=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;u<n;u++)!0!==r[u]&&!1!==r[u]&&(t+=Math.pow(r[u]-a,2),e++);return Math.sqrt(t/(e-1))},Formula.STEYX=function(r,n){for(var t=jStat.mean(n),e=jStat.mean(r),a=n.length,u=0,o=0,i=0,l=0;l<a;l++)u+=Math.pow(r[l]-e,2),o+=(n[l]-t)*(r[l]-e),i+=Math.pow(n[l]-t,2);return Math.sqrt((u-o*o/i)/(a-2))},Formula.TDIST=function(r,n,t){return t?jStat.studentt.cdf(r,n):jStat.studentt.pdf(r,n)},Formula.TDIST2T=function(){},Formula.TDISTRT=function(){},Formula.TINV=function(r,n){return jStat.studentt.inv(r,n)},Formula.TINV2T=function(){},Formula.TTEST=function(){},Formula.TREND=function(){},Formula.TRIMMEAN=function(r,n){r=Formula.FLATTEN(r);var t=Formula.FLOOR(r.length*n,2)/2;return jStat.mean(_.initial(_.rest(r.sort(function(r,n){return r-n}),t),t))},Formula.VARA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGEA(r),u=0;u<n;u++){var o=r[u];t+="number"==typeof o?Math.pow(o-a,2):!0===o?Math.pow(1-a,2):Math.pow(0-a,2),null!==o&&e++}return t/(e-1)},Formula.VARP=function(){for(var r=Formula.NUMBERS(Formula.FLATTEN(arguments)),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;u<n;u++)t+=Math.pow(r[u]-a,2),e++;return t/e},Formula.VARPA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGEA(r),u=0;u<n;u++){var o=r[u];t+="number"==typeof o?Math.pow(o-a,2):!0===o?Math.pow(1-a,2):Math.pow(0-a,2),null!==o&&e++}return t/e},Formula.VARS=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;u<n;u++)!0!==r[u]&&!1!==r[u]&&(t+=Math.pow(r[u]-a,2),e++);return t/(e-1)},Formula.WEIBULLDIST=function(r,n,t,e){return e?1-Math.exp(-Math.pow(r/t,n)):Math.pow(r,n-1)*Math.exp(-Math.pow(r/t,n))*n/Math.pow(t,n)},Formula.ZTEST=function(r,n,t){var e=r.length,a=void 0===t?Formula.STDEVS(r):t;return 1-Formula.NORMSDIST((Formula.AVERAGE(r)-n)/(a/Math.sqrt(e)),Formula.TRUE)},Formula.CHAR=function(r){return String.fromCharCode(r)},Formula.CLEAN=function(r){return r.replace(/[\0-\x1F]/g,"")},Formula.CODE=function(r){return r.charCodeAt(0)},Formula.CONCATENATE=function(){for(var r="",n=0;n<arguments.length;n++)null!==arguments[n]&&void 0!==arguments[n]&&(r+=arguments[n]);return r},Formula.DOLLAR=function(r,n){var t="";return(n=void 0===n?2:n)<=0?(r=Math.round(r*Math.pow(10,n))/Math.pow(10,n),t="($0,0)"):n>0&&(t="($0,0."+new Array(n+1).join("0")+")"),numeral(r).format(t)},Formula.EXACT=function(r,n){return r===n},Formula.FIND=function(r,n,t){return t=void 0===t?0:t,n?n.indexOf(r,t-1)+1:null},Formula.FIXED=function(r,n,t){n=void 0===n?2:n;var e=(t=void 0!==t&&t)?"0":"0,0";return n<=0?r=Math.round(r*Math.pow(10,n))/Math.pow(10,n):n>0&&(e+="."+new Array(n+1).join("0")),numeral(r).format(e)},Formula.HTML2TEXT=function(r){var n="";return r&&(r instanceof Array?r.forEach(function(r){""!==n&&(n+="\n"),n+=r.replace(/<(?:.|\n)*?>/gm,"")}):n=r.replace(/<(?:.|\n)*?>/gm,"")),n},Formula.HUMANIZE=function(r){if(r instanceof Date){var n=moment(r);return n.hours()||n.minutes()||n.seconds()?n.format("dddd, MMMM Do YYYY, h:mm:ss"):n.format("dddd, MMMM Do YYYY")}return r},Formula.JOIN=function(r,n){return r.join(n)},Formula.LEFT=function(r,n){return n=void 0===n?1:n,r?r.substring(0,n):null},Formula.LEN=function(r){return r?r.length:0},Formula.LOWER=function(r){return r?r.toLowerCase():r},Formula.MID=function(r,n,t){return r.substring(n-1,t)},Formula.NUMBERVALUE=function(r,n,t){return n=void 0===n?".":n,t=void 0===t?",":t,Number(r.replace(n,".").replace(t,""))},Formula.NUMBERS=function(){return Formula.FLATTEN(arguments).filter(function(r){return"number"==typeof r})},Formula.PROPER=function(r){if(r)return r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})},Formula.REGEXEXTRACT=function(r,n){var t=r.match(new RegExp(n));return t?t[t.length>1?t.length-1:0]:null},Formula.REGEXMATCH=function(r,n,t){var e=r.match(new RegExp(n));return t?e:!!e},Formula.REGEXREPLACE=function(r,n,t){return r.replace(new RegExp(n),t)},Formula.REPLACE=function(r,n,t,e){return r.substr(0,n-1)+e+r.substr(n-1+t)},Formula.REPT=function(r,n){return new Array(n+1).join(r)},Formula.RIGHT=function(r,n){return n=void 0===n?1:n,r?r.substring(r.length-n):null},Formula.ROMAN=function(r){for(var n=String(r).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],e="",a=3;a--;)e=(t[+n.pop()+10*a]||"")+e;return new Array(+n.join("")+1).join("M")+e},Formula.SEARCH=function(r,n,t){return t=void 0===t?0:t,n.toLowerCase().indexOf(r.toLowerCase(),t-1)+1},Formula.SPLIT=function(r,n){return _s.words(r,n)},Formula.SUBSTITUTE=function(r,n,t,e){if(!(r&&n&&t))return r;if(void 0===e)return r.replace(new RegExp(n,"g"),t);for(var a=0,u=0;r.indexOf(n,a)>0;)if(a=r.indexOf(n,a+1),++u===e)return r.substring(0,a)+t+r.substring(a+n.length)},Formula.T=function(r){return"string"==typeof r?r:null},Formula.TEXT=function(r,n){if(!r)return"";if(r instanceof Object)try{return JSON.stringify(r)}catch(r){return""}return"string"==typeof r?n?n.indexOf("0")>=0?numeral(r).format(n):moment(new Date(r)).format(n):r:r.toString&&"function"==typeof r.toString?r.toString():""},Formula.TRIM=function(r){return _s.clean(r)},Formula.UNICHAR=Formula.CHAR,Formula.UNICODE=Formula.CODE,Formula.UPPER=function(r){return r.toUpperCase()},Formula.VALUE=function(r){return numeral().unformat(r)},Formula.MD5=function(r,n,t){return md5(r,n,t)},Formula.NUMERAL=function(r,n){return numeral(r).format(n)},Formula.ISERR=function(r){return["#DIV/0!","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!"].indexOf(r)>=0},Formula.ISERROR=function(r){return Formula.ISERR(r)||"#N/A"===r},Formula.IFERROR=function(r,n){return Formula.ISERROR(r)?n:r},Formula}}.call(this);