var Parser=function(){var o=function(t,e,r,n){for(r=r||{},n=t.length;n--;r[t[n]]=e);return r},$V0=[1,4],$V1=[1,5],$V2=[1,7],$V3=[1,10],$V4=[1,8],$V5=[1,9],$V6=[1,11],$V7=[1,16],$V8=[1,17],$V9=[1,14],$Va=[1,15],$Vb=[1,18],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[1,29],$Vm=[5,11,12,13,15,16,17,18,19,20,21,22,30,31],$Vn=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,33],$Vo=[1,38],$Vp=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,35],$Vq=[5,12,13,15,16,17,18,19,30,31],$Vr=[5,12,15,16,17,18,30,31],$Vs=[5,12,13,15,16,17,18,19,20,21,30,31],$Vt=[15,30,31],$Vu=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,32,36],parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,"&":11,"=":12,"+":13,"(":14,")":15,"<":16,">":17,NOT:18,"-":19,"*":20,"/":21,"^":22,FUNCTION:23,expseq:24,cell:25,FIXEDCELL:26,":":27,CELL:28,ARRAY:29,";":30,",":31,VARIABLE:32,DECIMAL:33,NUMBER:34,"%":35,"#":36,"!":37,$accept:0,$end:1},terminals_:{5:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"&",12:"=",13:"+",14:"(",15:")",16:"<",17:">",18:"NOT",19:"-",20:"*",21:"/",22:"^",23:"FUNCTION",26:"FIXEDCELL",27:":",28:"CELL",29:"ARRAY",30:";",31:",",32:"VARIABLE",33:"DECIMAL",34:"NUMBER",35:"%",36:"#",37:"!"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[25,1],[25,3],[25,1],[25,3],[24,1],[24,1],[24,3],[24,3],[6,1],[6,3],[9,1],[9,3],[9,2],[2,3],[2,4]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.handler.helper.callVariable.call(this,$$[$0]);break;case 3:this.$=yy.handler.time.call(yy.obj,$$[$0],!0);break;case 4:this.$=yy.handler.time.call(yy.obj,$$[$0]);break;case 5:this.$=yy.handler.helper.number($$[$0]);break;case 6:this.$=yy.handler.helper.string($$[$0]);break;case 7:this.$=yy.handler.helper.specialMatch("&",$$[$0-2],$$[$0]);break;case 8:this.$=yy.handler.helper.logicMatch("=",$$[$0-2],$$[$0]);break;case 9:this.$=yy.handler.helper.mathMatch("+",$$[$0-2],$$[$0]);break;case 10:this.$=yy.handler.helper.number($$[$0-1]);break;case 11:this.$=yy.handler.helper.logicMatch("<=",$$[$0-3],$$[$0]);break;case 12:this.$=yy.handler.helper.logicMatch(">=",$$[$0-3],$$[$0]);break;case 13:this.$=yy.handler.helper.logicMatch("<>",$$[$0-3],$$[$0]);break;case 14:this.$=yy.handler.helper.logicMatch("NOT",$$[$0-2],$$[$0]);break;case 15:this.$=yy.handler.helper.logicMatch(">",$$[$0-2],$$[$0]);break;case 16:this.$=yy.handler.helper.logicMatch("<",$$[$0-2],$$[$0]);break;case 17:this.$=yy.handler.helper.mathMatch("-",$$[$0-2],$$[$0]);break;case 18:this.$=yy.handler.helper.mathMatch("*",$$[$0-2],$$[$0]);break;case 19:this.$=yy.handler.helper.mathMatch("/",$$[$0-2],$$[$0]);break;case 20:this.$=yy.handler.helper.mathMatch("^",$$[$0-2],$$[$0]);break;case 21:var n1=yy.handler.helper.numberInverted($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 22:var n1=yy.handler.helper.number($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 23:this.$=yy.handler.helper.callFunction.call(this,$$[$0-2],"");break;case 24:this.$=yy.handler.helper.callFunction.call(this,$$[$0-3],$$[$0-1]);break;case 28:this.$=yy.handler.helper.fixedCellValue.call(yy.obj,$$[$0]);break;case 29:this.$=yy.handler.helper.fixedCellRangeValue.call(yy.obj,$$[$0-2],$$[$0]);break;case 30:this.$=yy.handler.helper.cellValue.call(yy.obj,$$[$0]);break;case 31:this.$=yy.handler.helper.cellRangeValue.call(yy.obj,$$[$0-2],$$[$0]);break;case 32:yy.handler.utils.isArray($$[$0])?this.$=$$[$0]:this.$=[$$[$0]];break;case 33:var result=[],arr=eval("["+yytext+"]");arr.forEach(function(t){result.push(t)}),this.$=result;break;case 34:case 35:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 36:this.$=[$$[$0]];break;case 37:this.$=yy.handler.utils.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]],this.$.push($$[$0]);break;case 38:this.$=$$[$0];break;case 39:this.$=1*($$[$0-2]+"."+$$[$0]);break;case 40:this.$=.01*$$[$0-1];break;case 41:case 42:this.$=$$[$0-2]+$$[$0-1]+$$[$0]}},table:[{2:13,3:1,4:2,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{1:[3]},{5:[1,19],11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl},o($Vm,[2,2],{33:[1,30]}),o($Vm,[2,3]),o($Vm,[2,4]),o($Vm,[2,5],{35:[1,31]}),o($Vm,[2,6]),{2:13,4:32,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:33,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:34,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{14:[1,35]},o($Vm,[2,25]),o($Vm,[2,26],{2:36,32:[1,37],36:$Vb}),o($Vn,[2,36],{36:$Vo}),o($Vp,[2,38],{33:[1,39]}),o($Vm,[2,28],{27:[1,40]}),o($Vm,[2,30],{27:[1,41]}),{32:[1,42]},{1:[2,1]},{2:13,4:43,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:44,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:45,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:48,6:3,7:$V0,8:$V1,9:6,10:$V2,12:[1,46],13:$V3,14:$V4,17:[1,47],19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:50,6:3,7:$V0,8:$V1,9:6,10:$V2,12:[1,49],13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:51,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:52,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:53,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:54,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:55,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{32:[1,56]},o($Vp,[2,40]),{11:$Vc,12:$Vd,13:$Ve,15:[1,57],16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl},o($Vq,[2,21],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),o($Vq,[2,22],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),{2:13,4:60,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,15:[1,58],19:$V5,23:$V6,24:59,25:12,26:$V7,28:$V8,29:[1,61],32:$V9,34:$Va,36:$Vb},o($Vm,[2,27]),{36:$Vo},{32:[1,62]},{34:[1,63]},{26:[1,64]},{28:[1,65]},{37:[1,66]},o($Vm,[2,7]),o([5,12,15,30,31],[2,8],{11:$Vc,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vq,[2,9],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),{2:13,4:67,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:68,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},o($Vr,[2,16],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),{2:13,4:69,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},o($Vr,[2,15],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o([5,12,15,18,30,31],[2,14],{11:$Vc,13:$Ve,16:$Vf,17:$Vg,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vq,[2,17],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),o($Vs,[2,18],{11:$Vc,22:$Vl}),o($Vs,[2,19],{11:$Vc,22:$Vl}),o([5,12,13,15,16,17,18,19,20,21,22,30,31],[2,20],{11:$Vc}),o($Vn,[2,37]),o($Vm,[2,10]),o($Vm,[2,23]),{15:[1,70],30:[1,71],31:[1,72]},o($Vt,[2,32],{11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vt,[2,33]),{37:[1,73]},o($Vp,[2,39]),o($Vm,[2,29]),o($Vm,[2,31]),o($Vu,[2,41]),o($Vr,[2,11],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vr,[2,13],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vr,[2,12],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vm,[2,24]),{2:13,4:74,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:75,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},o($Vu,[2,42]),o($Vt,[2,34],{11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vt,[2,35],{11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl})],defaultActions:{19:[2,1]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e=this,r=[0],n=[null],i=[],a=this.table,s="",l=0,o=0,$=0,c=2,u=1,h=i.slice.call(arguments,1),V=Object.create(this.lexer),y={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(y.yy[f]=this.yy[f]);V.setInput(t,y.yy),y.yy.lexer=V,y.yy.parser=this,void 0===V.yylloc&&(V.yylloc={});var p=V.yylloc;i.push(p);var m=V.options&&V.options.ranges;function d(){var t;return"number"!=typeof(t=V.lex()||u)&&(t=e.symbols_[t]||t),t}"function"==typeof y.yy.parseError?this.parseError=y.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var g,E,b,I,A,N,v,x,k,C,O={};;){if(b=r[r.length-1],this.defaultActions[b]?I=this.defaultActions[b]:(null!==g&&void 0!==g||(g=d()),I=a[b]&&a[b][g]),void 0===I||!I.length||!I[0]){var _,S="";function R(t){for(var e=r.length-1,n=0;;){if(c.toString()in a[t])return n;if(0===t||e<2)return!1;t=r[e-=2],++n}}if($)E!==u&&(_=R(b));else{_=R(b),k=[];for(N in a[b])this.terminals_[N]&&N>c&&k.push("'"+this.terminals_[N]+"'");S=V.showPosition?"Parse error on line "+(l+1)+":\n"+V.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(l+1)+": Unexpected "+(g==u?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(S,{text:V.match,token:this.terminals_[g]||g,line:V.yylineno,loc:p,expected:k,recoverable:!1!==_})}if(3==$){if(g===u||E===u)throw new Error(S||"Parsing halted while starting to recover from another error.");o=V.yyleng,s=V.yytext,l=V.yylineno,p=V.yylloc,g=d()}if(!1===_)throw new Error(S||"Parsing halted. No suitable error recovery rule available.");C=_,r.length=r.length-2*C,n.length=n.length-C,i.length=i.length-C,E=g==c?null:g,g=c,b=r[r.length-1],I=a[b]&&a[b][c],$=3}if(I[0]instanceof Array&&I.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(I[0]){case 1:r.push(g),n.push(V.yytext),i.push(V.yylloc),r.push(I[1]),g=null,E?(g=E,E=null):(o=V.yyleng,s=V.yytext,l=V.yylineno,p=V.yylloc,$>0&&$--);break;case 2:if(v=this.productions_[I[1]][1],O.$=n[n.length-v],O._$={first_line:i[i.length-(v||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(v||1)].first_column,last_column:i[i.length-1].last_column},m&&(O._$.range=[i[i.length-(v||1)].range[0],i[i.length-1].range[1]]),void 0!==(A=this.performAction.apply(O,[s,o,l,y.yy,I[1],n,i].concat(h))))return A;v&&(r=r.slice(0,-1*v*2),n=n.slice(0,-1*v),i=i.slice(0,-1*v)),r.push(this.productions_[I[1]][0]),n.push(O.$),i.push(O._$),x=a[r[r.length-2]][r[r.length-1]],r.push(x);break;case 3:return!0}}return!0}},lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],r=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),a=0;a<i.length;a++)if((r=this._input.match(this.rules[i[a]]))&&(!e||r[0].length>e[0].length)){if(e=r,n=a,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,i[a])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[n]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,r,n){switch(r){case 0:break;case 1:case 2:return 10;case 3:return 23;case 4:return 7;case 5:return 8;case 6:case 7:case 8:return 26;case 9:return 28;case 10:return 23;case 11:case 12:return 32;case 13:return 34;case 14:return 29;case 15:break;case 16:return 11;case 17:return" ";case 18:return 33;case 19:return 27;case 20:return 30;case 21:return 31;case 22:return 20;case 23:return 21;case 24:return 19;case 25:return 13;case 26:return 22;case 27:return 14;case 28:return 15;case 29:return 17;case 30:return 16;case 31:return 18;case 32:return'"';case 33:return"'";case 34:return"!";case 35:return 12;case 36:return 35;case 37:return 36;case 38:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!0}}};function Parser(){this.yy={}}return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}(),ruleJS=function(t){"use strict";var e=this,r=document.getElementById(t)||null,n={},i={errors:[{type:"NULL",output:"#NULL"},{type:"DIV_ZERO",output:"#DIV/0!"},{type:"VALUE",output:"#VALUE!"},{type:"REF",output:"#REF!"},{type:"NAME",output:"#NAME?"},{type:"NUM",output:"#NUM!"},{type:"NOT_AVAILABLE",output:"#N/A!"},{type:"ERROR",output:"#ERROR"},{type:"NEED_UPDATE",output:"#NEED_UPDATE"}],get:function(t){var e=i.errors.filter(function(e){return e.type===t||e.output===t})[0];return e?e.output:null}},a=function(){this.data=[];var t=["input[type=text]","[data-formula]"];this.getItem=function(t){return e.matrix.data.filter(function(e){return e.id===t})[0]},this.removeItem=function(t){e.matrix.data=e.matrix.data.filter(function(e){return e.id!==t})},this.removeItemsInCol=function(t){e.matrix.data=e.matrix.data.filter(function(e){return e.col!==t})},this.removeItemsInRow=function(t){e.matrix.data=e.matrix.data.filter(function(e){return e.row!==t})},this.removeItemsBelowCol=function(t){e.matrix.data=e.matrix.data.filter(function(e){return e.col<t})},this.removeItemsBelowRow=function(t){e.matrix.data=e.matrix.data.filter(function(e){return e.row<t})},this.updateItem=function(t,r){if(e.utils.isString(t)&&(t=e.matrix.getItem(t)),t&&r)for(var n in r)t[n]&&e.utils.isArray(t[n])?e.utils.isArray(r[n])?r[n].forEach(function(e){-1===t[n].indexOf(e)&&t[n].push(e)}):-1===t[n].indexOf(r[n])&&t[n].push(r[n]):t[n]=r[n]},this.addItem=function(t){var r=t.id,n=e.utils.cellCoords(r);t.row=n.row,t.col=n.col;var i=e.matrix.data.filter(function(t){return t.id===r})[0];return i?e.matrix.updateItem(i,t):e.matrix.data.push(t),e.matrix.getItem(r)},this.getRefItemsToColumn=function(t){var r=[];return e.matrix.data.length?(e.matrix.data.forEach(function(n){n.deps&&(n.deps.filter(function(r){var n=e.utils.getCellAlphaNum(r).alpha;return e.utils.toNum(n)>=t}).length>0&&-1===r.indexOf(n.id)&&r.push(n.id))}),r):r},this.getRefItemsToRow=function(t){var r=[];return e.matrix.data.length?(e.matrix.data.forEach(function(n){n.deps&&(n.deps.filter(function(r){return e.utils.getCellAlphaNum(r).num>t}).length>0&&-1===r.indexOf(n.id)&&r.push(n.id))}),r):r},this.updateElementItem=function(t,r){var n=t.getAttribute("id"),i=e.matrix.getItem(n);e.matrix.updateItem(i,r)},this.getDependencies=function(t){var r=[],n=function(t){var i,a,s=(i=t,a=[],e.matrix.data.filter(function(t){if(t.deps)return t.deps.indexOf(i)>-1}).forEach(function(t){-1===a.indexOf(t.id)&&a.push(t.id)}),a);s.length&&s.forEach(function(t){-1===r.indexOf(t)&&(r.push(t),e.matrix.getItem(t).deps.length&&n(t))})};return n(t),r},this.getElementDependencies=function(t){return e.matrix.getDependencies(t.getAttribute("id"))};var n=function(t,r){var n=l(t,r),i=n.result,a=n.error,s=r.nodeName.toUpperCase();return e.matrix.updateElementItem(r,{value:i,error:a}),-1===["INPUT"].indexOf(s)&&(r.innerText=i||a),r.value=i||a,n},i=function(t){var r=t.getAttribute("id"),i=t.getAttribute("data-formula");i&&(e.matrix.addItem({id:r,formula:i}),n(i,t))},a=function(t){var r=t.getAttribute("id");t.addEventListener("dblclick",function(){var n=e.matrix.getItem(r);n&&n.formula&&(n.formulaEdit=!0,t.value="="+n.formula)}),t.addEventListener("blur",function(){var n=e.matrix.getItem(r);n&&(n.formulaEdit&&(t.value=n.value||n.error),n.formulaEdit=!1)}),t.addEventListener("keyup",function(t){switch(t.keyCode){case 13:case 27:document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()}}),t.addEventListener("change",function(){e.matrix.removeItem(r);var a=t.value;"="===a[0]&&(t.setAttribute("data-formula",a.substr(1)),i(t)),function(t){var r=e.matrix.getElementDependencies(t);t.getAttribute("id");r.forEach(function(t){var r=e.matrix.getItem(t);if(r&&r.formula){var i=document.getElementById(t);n(r.formula,i)}})}(t)})};this.depsInFormula=function(t){var e=t.formula,r=t.deps;return!!r&&(r=r.filter(function(t){return-1!==e.indexOf(t)})).length>0},this.scan=function(){var e=r.querySelectorAll(t);[].slice.call(e).forEach(function(t){i(t),a(t)})}},s={SUPPORTED_FORMULAS:["ABS","ACCRINT","ACOS","ACOSH","ACOTH","AND","ARABIC","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOMDIST","BINOMDISTRANGE","BINOMINV","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQDIST","CHISQINV","CODE","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCENORM","CONFIDENCET","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCEP","COVARIANCES","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","ERF","ERFC","EVEN","EXACT","EXPONDIST","FALSE","FDIST","FINV","FISHER","FISHERINV","IF","INT","ISEVEN","ISODD","LN","LOG","LOG10","MAX","MAXA","MEDIAN","MIN","MINA","MOD","NOT","ODD","OR","PI","POWER","ROUND","ROUNDDOWN","ROUNDUP","SIN","SINH","SPLIT","SQRT","SQRTPI","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","TAN","TANH","TRUE","TRUNC","XOR"],number:function(t){switch(typeof t){case"number":return t;case"string":if(!isNaN(t))return t.indexOf(".")>-1?parseFloat(t):parseInt(t,10)}return t},string:function(t){return t.substring(1,t.length-1)},numberInverted:function(t){return-1*this.number(t)},specialMatch:function(t,e,r){var n;switch(t){case"&":n=e.toString()+r.toString()}return n},logicMatch:function(t,e,r){var n;switch(t){case"=":n=e===r;break;case">":n=e>r;break;case"<":n=e<r;break;case">=":n=e>=r;break;case"<=":n=e===r;break;case"<>":case"NOT":n=e!=r}return n},mathMatch:function(t,e,r){var n;if(e=s.number(e),r=s.number(r),isNaN(e)||isNaN(r)){if("="===e[0]||"="===r[0])throw Error("NEED_UPDATE");throw Error("VALUE")}switch(t){case"+":n=e+r;break;case"-":n=e-r;break;case"/":if((n=e/r)==1/0)throw Error("DIV_ZERO");if(isNaN(n))throw Error("VALUE");break;case"*":n=e*r;break;case"^":n=Math.pow(e,r)}return n},callFunction:function(t,r){if(t=t.toUpperCase(),r=r||[],e.helper.SUPPORTED_FORMULAS.indexOf(t)>-1&&e.formulas[t])return e.formulas[t].apply(this,r);throw Error("NAME")},callVariable:function(t){var r=(t=t||[])[0];if(r&&(r=r.toUpperCase(),e.formulas[r]))return"function"==typeof e.formulas[r]?e.formulas[r].apply(this,t):e.formulas[r];throw Error("NAME")},cellValue:function(t){var r,n=e.custom.cellValue,i=e.matrix.getItem(t);if(e.utils.isFunction(n)){var a=e.utils.cellCoords(t),s=e.utils.translateCellCoords({row:this.row,col:this.col});r=i?i.value:n(a.row,a.col),e.utils.isNull(r)&&(r=0),s&&e.matrix.updateItem(s,{deps:[t]})}else r=i?i.value:document.getElementById(t).value,e.matrix.updateElementItem(this,{deps:[t]});if(i&&i.deps&&-1!==i.deps.indexOf(s))throw Error("REF");if(i&&i.error)throw Error(i.error);if(e.utils.isSet(r)){var l=e.helper.number(r);return isNaN(l)?r:l}throw Error("NOT_AVAILABLE")},cellRangeValue:function(t,r){var n=e.custom.cellValue,i=e.utils.cellCoords(t),a=e.utils.cellCoords(r),s=e.utils.iterateCells.call(this,i,a),l=[];if(e.utils.isFunction(n)){var o=e.utils.translateCellCoords({row:this.row,col:this.col});e.matrix.updateItem(o,{deps:s.index})}else e.matrix.updateElementItem(this,{deps:s.index});return l.push(s.value),l},fixedCellValue:function(t){return t=t.replace(/\$/g,""),e.helper.cellValue.call(this,t)},fixedCellRangeValue:function(t,r){return t=t.replace(/\$/g,""),r=r.replace(/\$/g,""),e.helper.cellRangeValue.call(this,t,r)}},l=function(t,r){var a=null,s=null;try{var l;n.setObj(r),a=n.parse(t),r instanceof HTMLElement?l=r.getAttribute("id"):r&&r.id&&(l=r.id);var o=e.matrix.getDependencies(l);if(-1!==o.indexOf(l))throw a=null,o.forEach(function(t){e.matrix.updateItem(t,{value:null,error:i.get("REF")})}),Error("REF")}catch(t){var $=i.get(t.message);s=$||i.get("ERROR")}return{error:s,result:a}};return{init:function(){n=new function(t){var e=function(){};e.prototype=Parser.lexer;var r=function(){this.lexer=new e,this.yy={}};r.prototype=Parser;var n=new r;return n.setObj=function(t){n.yy.obj=t},n.yy.parseError=function(t,e){throw{name:"Parser error",message:t,prop:e}},n.yy.handler=t,n}(e=this),e.formulas=Formula,e.matrix=new a,e.custom={},r&&e.matrix.scan()},version:"0.0.3",utils:{isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isUndefined:function(t){return"[object Undefined]"===Object.prototype.toString.call(t)},isNull:function(t){return"[object Null]"===Object.prototype.toString.call(t)},isSet:function(t){return!e.utils.isUndefined(t)&&!e.utils.isNull(t)},isCell:function(t){return!!t.match(/^[A-Za-z]+[0-9]+/)},getCellAlphaNum:function(t){var e=t.match(/\d+$/);return{alpha:t.replace(e,""),num:parseInt(e[0],10)}},changeRowIndex:function(t,r){var n=e.utils.getCellAlphaNum(t),i=n.alpha,a=parseInt(n.num+r,10);return a<1&&(a=1),i+""+a},changeColIndex:function(t,r){var n=e.utils.getCellAlphaNum(t),i=n.alpha,a=e.utils.toChar(parseInt(e.utils.toNum(i)+r,10)),s=n.num;a&&0!==a.length||(a="A");var l="$"===i[0]||!1,o="$"===i[i.length-1]||!1;return(a=(l?"$":"")+a)+""+(s=(o?"$":"")+s)},changeFormula:function(t,r,n){return r||(r=1),t.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(t){var i=e.utils.getCellAlphaNum(t),a=i.alpha,s=i.num;return e.utils.isNumber(n.col)&&(s=e.utils.toNum(a),n.col<=s)?e.utils.changeColIndex(t,r):e.utils.isNumber(n.row)&&n.row<s?e.utils.changeRowIndex(t,r):t})},updateFormula:function(t,r,n){var i,a;return-1!==["left","right"].indexOf(r)?i="col":-1!==["up","down"].indexOf(r)&&(i="row"),-1!==["down","right"].indexOf(r)?a=1*n:-1!==["up","left"].indexOf(r)&&(a=-1*n),i&&a?t.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(t){var r=e.utils.getCellAlphaNum(t).alpha,n="$"===r[0]||!1,s="$"===r[r.length-1]||!1;return"row"===i&&s?t:"col"===i&&n?t:"row"===i?e.utils.changeRowIndex(t,a):e.utils.changeColIndex(t,a)}):t},toNum:function(t){var r,n,i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=0;for(r=0,n=(t=e.utils.clearFormula(t)).length-1;r<t.length;r+=1,n-=1)a+=Math.pow(i.length,n)*(i.indexOf(t[r])+1);return a&&--a,a},toChar:function(t){for(var e="";t>=0;)e=String.fromCharCode(t%26+97)+e,t=Math.floor(t/26)-1;return e.toUpperCase()},cellCoords:function(t){var r=t.match(/\d+$/),n=t.replace(r,"");return{row:parseInt(r[0],10)-1,col:e.utils.toNum(n)}},clearFormula:function(t){return t.replace(/\$/g,"")},translateCellCoords:function(t){return e.utils.toChar(t.col)+""+parseInt(t.row+1,10)},iterateCells:function(t,r,n){var i={index:[],value:[]},a={start:0,end:0};a=r.col>=t.col?{start:t.col,end:r.col}:{start:r.col,end:t.col};var s={start:0,end:0};s=r.row>=t.row?{start:t.row,end:r.row}:{start:r.row,end:t.row};for(var l=a.start;l<=a.end;l++)for(var o=s.start;o<=s.end;o++){var $=e.utils.toChar(l)+(o+1),c=e.helper.cellValue.call(this,$);i.index.push($),i.value.push(c)}return e.utils.isFunction(n)?n.apply(n,[i]):i},sort:function(t){return function(e,r){return(e<r?-1:e>r?1:0)*(t?-1:1)}}},helper:s,parse:l}};